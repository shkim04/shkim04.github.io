{"componentChunkName":"component---src-templates-blog-post-js","path":"/docker-compose로-postgresql과-redis-어플리케이션에-연결하기/","result":{"data":{"site":{"siteMetadata":{"title":"Seunghyun's Blog"}},"markdownRemark":{"id":"8794490e-5781-5d47-935a-f3778b6b5d9a","excerpt":"Docker를 이용하여 어플리케이션을 배포하려고 하기 때문에 Docker 컨테이너로 구동하는 다른 서비스들과 연결하는 것이 필요합니다. 이전 글을 읽지 않고 이 글을 읽으신 분들은 여기에서 백엔드의 전체 코드를 확인하실 수 있습니다. Docker…","html":"<p><strong>Docker</strong>를 이용하여 어플리케이션을 배포하려고 하기 때문에 Docker 컨테이너로 구동하는 다른 서비스들과 연결하는 것이 필요합니다.</p>\n<blockquote>\n<p>이전 글을 읽지 않고 이 글을 읽으신 분들은 <a href=\"https://github.com/shkim04/find-your-wc\">여기</a>에서 백엔드의 전체 코드를 확인하실 수 있습니다.</p>\n</blockquote>\n<h2>Docker 서비스 연결</h2>\n<p><span\n      class=\"gatsby-resp-image-wrapper\"\n      style=\"position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 630px; \"\n    >\n      <a\n    class=\"gatsby-resp-image-link\"\n    href=\"/static/43e26d79cf98ab4f92994137b48bfb84/b1ffc/docker-compose-script.png\"\n    style=\"display: block\"\n    target=\"_blank\"\n    rel=\"noopener\"\n  >\n    <span\n    class=\"gatsby-resp-image-background-image\"\n    style=\"padding-bottom: 31.0126582278481%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAGCAYAAADDl76dAAAACXBIWXMAABYlAAAWJQFJUiTwAAAAtUlEQVR42p2RwU7DMBBE/SO11+uNazvGAQRFHBD//1WvakqqFCEOPYxmZ95hD+Py0zvHcaL1Z2qeOJpiGgkhPCSXcqMtJ+ZSyEkRCQQJ+LCT/+X/yGkylrHQayFKQESIUdAY0ZtH0l0nd2zLUQSnqnyMxtdL5/tt8LnM1Mmo2ShTomVb85xtvYtduwurP1293JORTXFpKozeV7B98t5z8P7mh13+i/mdXEyJ194oplf44BjbKGcQQ6eSQ408iQAAAABJRU5ErkJggg=='); background-size: cover; display: block;\"\n  ></span>\n  <img\n        class=\"gatsby-resp-image-image\"\n        alt=\"docker-compose-script\"\n        title=\"\"\n        src=\"/static/43e26d79cf98ab4f92994137b48bfb84/f058b/docker-compose-script.png\"\n        srcset=\"/static/43e26d79cf98ab4f92994137b48bfb84/c26ae/docker-compose-script.png 158w,\n/static/43e26d79cf98ab4f92994137b48bfb84/6bdcf/docker-compose-script.png 315w,\n/static/43e26d79cf98ab4f92994137b48bfb84/f058b/docker-compose-script.png 630w,\n/static/43e26d79cf98ab4f92994137b48bfb84/40601/docker-compose-script.png 945w,\n/static/43e26d79cf98ab4f92994137b48bfb84/78612/docker-compose-script.png 1260w,\n/static/43e26d79cf98ab4f92994137b48bfb84/b1ffc/docker-compose-script.png 1492w\"\n        sizes=\"(max-width: 630px) 100vw, 630px\"\n        style=\"width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;\"\n        loading=\"lazy\"\n        decoding=\"async\"\n      />\n  </a>\n    </span></p>\n<p>하나의 컨테이너는 개별적인 환경을 갖추고 있는데 네트워크 환경 역시 개별적으로 갖추고 있기 때문에 <strong>find_your_wc</strong>, <strong>postgres</strong>와 <strong>redis</strong> 서비스들은 기본적으로 서로에게 연결이 되어 있지 않습니다.</p>\n<p><strong>find_your_wc</strong> 어플리케이션은 다른 두 개의 서비스를 사용하고 있는데 그 서비스들과 연결이 되어야 한다는 의미입니다. 이를 위해서 <code class=\"language-text\">docker-compose.yml</code>에 <code class=\"language-text\">find_your_wc</code> 서비스 아래 <code class=\"language-text\">links</code> 플래그를 이용하면 됩니다.</p>\n<p>이제 <strong>postgres</strong>와 <strong>redis</strong> 서비스들은 어플리케이션에서 이름으로 접근이 가능합니다. 예를 들면 개발 환경에서 호스트 이름을 <code class=\"language-text\">localhost</code>를 사용하여 <code class=\"language-text\">.env</code> 파일에 데이터베이스 url을 저장했습니다. 이를 도커 컨테이너에서 구동되는 어플리케이션에 연결하기 위해 <code class=\"language-text\">docker-compose.yml</code>에 정의한 서비스의 이름인 <strong>postgres</strong>로 바꾸어주면 됩니다 - <em>이는 위 스크립트에서 <strong>environment</strong> 부분에서 확인할 수 있습니다</em>. 같은 방식으로 캐쉬 모듈에 필요한 redis 호스트 이름은 <strong>redis</strong>로 넣어주면 됩니다.</p>\n<blockquote>\n<p>경우에 따라 데이터베이스 서비스가 구동될 때 <code class=\"language-text\">[package-manger] prisma migrate dev [proper-migration-name]</code>을 입력하여 <strong>Prisma</strong>를 데이터베이스에 마이그레이션을 해야할 수도 있습니다. 이는 도커 컨테이너 쉘에서 할 필요는 없습니다. 프로젝트가 저장되어 있는 개인 컴퓨터에서 진행해도 상관없습니다.</p>\n</blockquote>\n<p><em><strong>읽어 주셔서 감사합니다. To be continued!</strong></em></p>\n<h3>참조</h3>\n<ul>\n<li><a href=\"https://docs.docker.com/compose/networking/\">https://docs.docker.com/compose/networking/</a></li>\n<li><a href=\"https://www.tomray.dev/nestjs-docker-compose-postgres\">https://www.tomray.dev/nestjs-docker-compose-postgres</a></li>\n</ul>","frontmatter":{"title":"#16 docker-compose로 PostgresQL과 redis 어플리케이션에 연결하기","date":"2023년 11월 15일","description":"","tag":["Project"]},"fields":{"locale":"ko"}},"previous":{"fields":{"slug":"/pnpm으로-dockerfile에서-multi-stage-빌드하기"},"frontmatter":{"title":"#15 pnpm으로 Dockefile에서 multi-stage 빌드하기"}},"next":null},"pageContext":{"locale":"ko","isDefaultLang":true,"slug":"/docker-compose로-postgresql과-redis-어플리케이션에-연결하기","titleByLang":{"ko":"docker-compose로-postgresql과-redis-어플리케이션에-연결하기","en":"link-postgresql-redis-application-in-docker-compose"},"dateFormat":"YYYY년 MM월 DD일","id":"8794490e-5781-5d47-935a-f3778b6b5d9a","previousPostId":"af72a085-a5b0-5c13-9dd0-016f5c136636","nextPostId":null}},"staticQueryHashes":[],"slicesMap":{}}