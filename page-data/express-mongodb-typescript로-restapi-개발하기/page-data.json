{"componentChunkName":"component---src-templates-blog-post-js","path":"/express-mongodb-typescript로-restapi-개발하기/","result":{"data":{"site":{"siteMetadata":{"title":"Seunghyun's Blog"}},"markdownRemark":{"id":"4c7b94c3-2071-54b0-a030-da9ce6b56f8e","excerpt":"REST API는 마치 음식점의 메뉴와 같다. 손님이 메뉴를 보면 그 음식점이 어떤 음식들을 요리하는지 알 수 있는 것처럼 개발자가 한 소프트웨어 상품의 API 문서를 보면 무슨 기능을 제공하는지 알 수 있다. API 문서에는 흔히 요청 url이 적혀 있고 각 url…","html":"<p>REST API는 마치 음식점의 메뉴와 같다. 손님이 메뉴를 보면 그 음식점이 어떤 음식들을 요리하는지 알 수 있는 것처럼 개발자가 한 소프트웨어 상품의 API 문서를 보면 무슨 기능을 제공하는지 알 수 있다. API 문서에는 흔히 요청 url이 적혀 있고 각 url에 대한 설명을 찾아볼 수 있다. 이 중 한 url에 요청을 보내면 그에 대한 응답을 받는 것이다. 개발자는 이 응답을 받아 가공 후 자신의 앱에 사용하면 된다. 이제 API를 만들어 보자.</p>\n<h2>필수</h2>\n<ul>\n<li>Node.js + Typescript</li>\n<li>MongoDB</li>\n<li>Insomnia</li>\n</ul>\n<h2>MongoDB 데이터베이스</h2>\n<p>먼저 MongoDB 설정부터 시작하겠다. MongoDB는 NoSQL 데이터베이스로 아주 많이 사용되는 데이터베이스 중 하나이다. 흔히 CRUD라고 말하는 create, retrieve, update, delete 요청을 적용하는 것이 아주 용이하다.</p>\n<p>MongoDB 사용을 위해서 계정을 만들어야 한다. google이나 github 계정과 연동해서 쉽게 만들 수 있다. 계정을 생성해도 먼저 돈을 지불하지 않으며 추후에 큰 규모의 데이터를 처리할 때 처리량에 따라 지불하면 된다.</p>\n<p>계정을 생성하고 로그인을 하면 다음과 같은 대시보드가 나온다:</p>\n<p><span\n      class=\"gatsby-resp-image-wrapper\"\n      style=\"position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 630px; \"\n    >\n      <a\n    class=\"gatsby-resp-image-link\"\n    href=\"/static/3a8ad2fc6c44825ba1ca050587fc4387/c0255/mongodb-1.png\"\n    style=\"display: block\"\n    target=\"_blank\"\n    rel=\"noopener\"\n  >\n    <span\n    class=\"gatsby-resp-image-background-image\"\n    style=\"padding-bottom: 55.69620253164557%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAALCAYAAAB/Ca1DAAAACXBIWXMAAAsTAAALEwEAmpwYAAAB10lEQVR42o2SS2/VMBCF8/93ICGxKPwF1A1IFwmx4LFgiVqJRUvb+8xN4kdix/ErH4p7W1EJASMdje3xnDmecXWnjtx0NZ3tSSR6F1kLz1p6tioUbKRnrzwuBP5l1bfDmu9tzdWo2AZLZ3qujztuugMbceSmPXC7rGXDWjbkOf+d8KAMG6H50eyojSKnTM6ZeV4wP+J/rdq1R3aiwUyOmFJRYELEBXDThLEj1jl6azHjyOgcxlrsOJZ4SqkQPRSuGikRuseniI+BPCfaMaAcjNNEbwx6GGiFKF71PY0QCKUKeUzxqcJWdmz2O7TWRWHMmVYKpJS0QiK1Lhe9c4Q/DCXnGR8i4+iwdqTaXl5wdXlBd31N6HsyM7KTiKOkq1usNiVR6AE9mBPN054uTx3s0oJA1azv2P68RdUHop8IKXH28S3PV2948f6c159XjMETE9gpMQWY4gnhHinD5HM5qzqtqIW4T8qJkCJnX1a8/PSOV19XPPtwzjC5kxIefS5DWPzvemeqwRqEVmhnC1mMkeQDOSWSv2/4MpwpeGSvS3/HyeH8hBr64peYNkPhqQrJoiyGQuhDoBYdcujZNw37tqHuupLQKcm+OZ72hkPb0qrll+hSrJGCX7jHTvpSF6ZFAAAAAElFTkSuQmCC'); background-size: cover; display: block;\"\n  ></span>\n  <img\n        class=\"gatsby-resp-image-image\"\n        alt=\"mongodb-1\"\n        title=\"\"\n        src=\"/static/3a8ad2fc6c44825ba1ca050587fc4387/f058b/mongodb-1.png\"\n        srcset=\"/static/3a8ad2fc6c44825ba1ca050587fc4387/c26ae/mongodb-1.png 158w,\n/static/3a8ad2fc6c44825ba1ca050587fc4387/6bdcf/mongodb-1.png 315w,\n/static/3a8ad2fc6c44825ba1ca050587fc4387/f058b/mongodb-1.png 630w,\n/static/3a8ad2fc6c44825ba1ca050587fc4387/c0255/mongodb-1.png 920w\"\n        sizes=\"(max-width: 630px) 100vw, 630px\"\n        style=\"width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;\"\n        loading=\"lazy\"\n        decoding=\"async\"\n      />\n  </a>\n    </span></p>\n<p>개발하려고 하는 앱이 데이터베이스에 접근하게 하려면 데이터베이스 사용자를 생성하고 역할을 주어야 한다.</p>\n<p>좌측 사이드바에 있는 <strong>Database Access</strong> 누르고 넘어간 페이지의 우측에 보이는 <strong>ADD NEW DATABASE USER</strong> 클릭한다.</p>\n<p><span\n      class=\"gatsby-resp-image-wrapper\"\n      style=\"position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 630px; \"\n    >\n      <a\n    class=\"gatsby-resp-image-link\"\n    href=\"/static/eb846077747d9323877832016910ecf5/c4b7c/mongodb-2.png\"\n    style=\"display: block\"\n    target=\"_blank\"\n    rel=\"noopener\"\n  >\n    <span\n    class=\"gatsby-resp-image-background-image\"\n    style=\"padding-bottom: 81.64556962025317%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAQCAYAAAAWGF8bAAAACXBIWXMAAAsTAAALEwEAmpwYAAACGElEQVR42pVTCY6jMBDk/0/cmYQcYHxiwNjgA2plT5jNRtmRtqVSt9pWufpwpXoNJiSE6iGkApc9hFJYlhXZ9n3/xrZtBenhn5Fz2SrGOTrK0Xa0+IZ0BZfbHbe2w6VhD9Byh3KBhtAiIscdZegYB6EMq/eo8qU76XBrCQjjUHoo6LMfDOQUoUyCniNiPJAKQkxIKSGmHMeitPoQDe6S40RbfHYNTFoL9Do/St3gnIP3Pjfgq7yUypkPAWa2SOlP6RVbRyQAg5tBtISNvoBaXV7O4EJiGCfs24YQQiHPpP0woOko3LIU5TlX2bDCeIc5BrgUSzx5Bx/Dt5rDngd04DVfDZPBMI6Q4wo5LnDWYnEO1lpY58rr27bjnT2THlax0xn0VEPWF/BzjRAiduxv1bxT92qVJR1m50ppW6+xxfi9cz+RPbfiL0JzrqHaFvLeYrk3QJ7WyyK/Ig8gT/gt4TxNkJxDCQElJZiU0OMILhXW1eN/rcoEeaEpl2Xb85fL5YTgsW3pnyU/t+RQXqZ8qmv8Otc4Xa7F3wjBtW1wowLXTuFGJBqqIJWClAqqz39eQghZcuoBLjiGYUTltIYhHSxjcILDcg7TUUxMwg4WZkmYl1gWPD1wLPERryFi8V/fsspk149PENbDug3OzFitxZ7/Zt/nZfuxZ/mUmQhmUhlU5bkAry/oqYDTE5zSWLVGGEd4xv97KL8BBnXZrWzmnc4AAAAASUVORK5CYII='); background-size: cover; display: block;\"\n  ></span>\n  <img\n        class=\"gatsby-resp-image-image\"\n        alt=\"mongodb-2\"\n        title=\"\"\n        src=\"/static/eb846077747d9323877832016910ecf5/f058b/mongodb-2.png\"\n        srcset=\"/static/eb846077747d9323877832016910ecf5/c26ae/mongodb-2.png 158w,\n/static/eb846077747d9323877832016910ecf5/6bdcf/mongodb-2.png 315w,\n/static/eb846077747d9323877832016910ecf5/f058b/mongodb-2.png 630w,\n/static/eb846077747d9323877832016910ecf5/c4b7c/mongodb-2.png 903w\"\n        sizes=\"(max-width: 630px) 100vw, 630px\"\n        style=\"width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;\"\n        loading=\"lazy\"\n        decoding=\"async\"\n      />\n  </a>\n    </span></p>\n<p>사용자 이름과 비밀번호를 입력한다. 데이터베이스에 연결할 때 이 두 정보가 필요하니 꼭 기억해두어야 한다.</p>\n<p>다음 해당 사용자에 <strong>Atlas admin</strong> 역할을 부여한다. 만약 단순히 읽기 역할만 주고 싶거나 읽기/쓰기 역할만 주고 싶을 때는 그에 맞게 권한을 부여하면 된다.</p>\n<p>다시 대시보드로 페이지를 이동하고 <em>connect</em> 를 클릭하면 개발할 API에 사용될 URI를 얻어야 한다.</p>\n<p><span\n      class=\"gatsby-resp-image-wrapper\"\n      style=\"position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 440px; \"\n    >\n      <a\n    class=\"gatsby-resp-image-link\"\n    href=\"/static/6e847138a836b8c5c19669a5a558fc2e/48c0e/mongodb-3.png\"\n    style=\"display: block\"\n    target=\"_blank\"\n    rel=\"noopener\"\n  >\n    <span\n    class=\"gatsby-resp-image-background-image\"\n    style=\"padding-bottom: 57.59493670886076%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAMCAYAAABiDJ37AAAACXBIWXMAAAsTAAALEwEAmpwYAAABuElEQVR42nWSi3LaMBBF/f+f1obJdBJCgQSwLckyD+MHhthofTqW2pKnZq6tXa2OtLuKbCVklaAKIS4caSHoo5DXQlo4kiKsZ6VgSiE5COoo9G5gGILejujQQnECU0JcQFZBXsOuCXNdgq2CvW1C3GiL8OWInswLD3rF8zZlbtcs8pTVXrPZG5Z5zDQbfQkzG6OOlvVOsbAJv61iqmOO7cmD/t0zWu0yHnUImGUps0wxNcGOD1t+qTU/1gtmVnvfy9YwiZ95MgmLXLE/1X+BARmd2jP99YqIwznH9XrFiTCI+LmIeP/4/6pmn1JuzxfOl1cP7fsrXd/T9V1Q13m773ucGw96D/b6CBw/MoQg8brV423wuPUd6BtF/kS/9SYPbxqoa2gapKqQvg/gNymHS8h/38jxwGVt2RSO1W5gcYB2X9M8PGCXz2TzJfvHJ6r5nCTPSbQm1oZYabLtjro9kZoMlVlMngdgdj6SlgEYl3Apasq7CfH9Peu7CfbnhGaxJM5zlDEok5Fog7KW07lFW8tGaW9H7psXOry+wqiuY7hcEOe+TPl95wei8UncGhJ0q8lNHwHfNeUP2xiejqS306wAAAAASUVORK5CYII='); background-size: cover; display: block;\"\n  ></span>\n  <img\n        class=\"gatsby-resp-image-image\"\n        alt=\"mongodb-3\"\n        title=\"\"\n        src=\"/static/6e847138a836b8c5c19669a5a558fc2e/48c0e/mongodb-3.png\"\n        srcset=\"/static/6e847138a836b8c5c19669a5a558fc2e/c26ae/mongodb-3.png 158w,\n/static/6e847138a836b8c5c19669a5a558fc2e/6bdcf/mongodb-3.png 315w,\n/static/6e847138a836b8c5c19669a5a558fc2e/48c0e/mongodb-3.png 440w\"\n        sizes=\"(max-width: 440px) 100vw, 440px\"\n        style=\"width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;\"\n        loading=\"lazy\"\n        decoding=\"async\"\n      />\n  </a>\n    </span></p>\n<p>다음과 같은 버튼을 클릭한다.</p>\n<p><span\n      class=\"gatsby-resp-image-wrapper\"\n      style=\"position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 630px; \"\n    >\n      <a\n    class=\"gatsby-resp-image-link\"\n    href=\"/static/0025ae2a27a14902400eb32cda23fdf0/13e20/mongodb-4.png\"\n    style=\"display: block\"\n    target=\"_blank\"\n    rel=\"noopener\"\n  >\n    <span\n    class=\"gatsby-resp-image-background-image\"\n    style=\"padding-bottom: 10.759493670886075%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAACCAYAAABYBvyLAAAACXBIWXMAAAsTAAALEwEAmpwYAAAAcElEQVR42m2MQQ7CMBAD+//n8AhuPIALggoKVdtsdrdIhCQa1BwQBw4j27LsbicH9nJExsDlNtBfB07nHvWVnDMpvRuvpunrS63UH7acS6F7PIV7XFA15hCYlsA4zUQzzFfUnGiORCWqoe6t28b/Dj8/rJm+WqR9bwAAAABJRU5ErkJggg=='); background-size: cover; display: block;\"\n  ></span>\n  <img\n        class=\"gatsby-resp-image-image\"\n        alt=\"mongodb-4\"\n        title=\"\"\n        src=\"/static/0025ae2a27a14902400eb32cda23fdf0/f058b/mongodb-4.png\"\n        srcset=\"/static/0025ae2a27a14902400eb32cda23fdf0/c26ae/mongodb-4.png 158w,\n/static/0025ae2a27a14902400eb32cda23fdf0/6bdcf/mongodb-4.png 315w,\n/static/0025ae2a27a14902400eb32cda23fdf0/f058b/mongodb-4.png 630w,\n/static/0025ae2a27a14902400eb32cda23fdf0/13e20/mongodb-4.png 741w\"\n        sizes=\"(max-width: 630px) 100vw, 630px\"\n        style=\"width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;\"\n        loading=\"lazy\"\n        decoding=\"async\"\n      />\n  </a>\n    </span></p>\n<p><span\n      class=\"gatsby-resp-image-wrapper\"\n      style=\"position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 630px; \"\n    >\n      <a\n    class=\"gatsby-resp-image-link\"\n    href=\"/static/7a7afdf2faffeb26bfe1b80c0e13a6f5/6c2f2/mongodb-5.png\"\n    style=\"display: block\"\n    target=\"_blank\"\n    rel=\"noopener\"\n  >\n    <span\n    class=\"gatsby-resp-image-background-image\"\n    style=\"padding-bottom: 70.25316455696203%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAOCAYAAAAvxDzwAAAACXBIWXMAAAsTAAALEwEAmpwYAAABxElEQVR42qWT627cIBCF/f5vF0VK21/ZKN5dXzH4AozBfBVYahIpjap0pMMYoxmGc2aqIx3YIB/ggxCOWL5d2HHFn2d7jIgX9n3nM6skBjo/0zlD62Y6bxj8gotCYzWdm4tvnea2TaziUGrCzMvnCZ8vF+r6ilKaYRgZR0U/jBwp8R2rcukv9ZVBTXgRnPeYZeH1dmfZNmKMhBA++Gx/u67Ky7ws6HnmiAch7IgI2piSOIb4559zrvgvK3y+vFDf7kza0PY97TDQjYpx0jRtx63t6EfFewZSQfq0zPJkrQ1q0idGRXdvUIMihsBxHAX/zGFe8nMv1ytt17E9PuJ//kIeHtBPP2iNoVeKpu+5ti3DNNGNI+0w0irFqHVpMSe+0HFyuK68Ng3GGOTeIE2D1DVuGHAh4ESw3rN5h9+lBGf43Ze9ZI7DXgSrMhfWOia7UruJSRxWhLUkcUXZTIu1tmCzlnXb2KxDb4lhBYlvZFbWudKkWelcaVF3DSz2QG8HxqYTLjHZxJ6DUyKlxJEoeC9YFfIoiZQeFNnxPo9eQgK4/Q0+78OZ4EtRzpvOG79rOTbmbkiJal7PqfCy8z+W+9esC78BoH5FHRop9Y4AAAAASUVORK5CYII='); background-size: cover; display: block;\"\n  ></span>\n  <img\n        class=\"gatsby-resp-image-image\"\n        alt=\"mongodb-5\"\n        title=\"\"\n        src=\"/static/7a7afdf2faffeb26bfe1b80c0e13a6f5/f058b/mongodb-5.png\"\n        srcset=\"/static/7a7afdf2faffeb26bfe1b80c0e13a6f5/c26ae/mongodb-5.png 158w,\n/static/7a7afdf2faffeb26bfe1b80c0e13a6f5/6bdcf/mongodb-5.png 315w,\n/static/7a7afdf2faffeb26bfe1b80c0e13a6f5/f058b/mongodb-5.png 630w,\n/static/7a7afdf2faffeb26bfe1b80c0e13a6f5/6c2f2/mongodb-5.png 767w\"\n        sizes=\"(max-width: 630px) 100vw, 630px\"\n        style=\"width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;\"\n        loading=\"lazy\"\n        decoding=\"async\"\n      />\n  </a>\n    </span></p>\n<p>위에 보이는 URI가 API에 사용될 예정이다 - <em>Node.js API를 개발하는 것이기 때문에 driver 옵션은 넘어가도 된다</em>. 이 전 단계에서 생성한 사용자 이름과 비밀번호를 위 사진 속 빨간색 빈 칸에 <em>[your username:your password]</em> 형태로 넣어야 한다. 필자와 함께 API를 개발하는 것이니 예시는 넘어가도 된다.</p>\n<h2>프로젝트 폴더 생성</h2>\n<p>새로운 프로젝트 폴더를 생성하고 터미널을 열어 아래와 같이 명령어를 입력한다. 해당 명령어를 입력하면 pacakge.json 파일이 생기는데 앱에 필요한 정보나 dependency들을 담고 있는 역할을 한다. 그리고 <code class=\"language-text\">app.ts</code> 파일을 만든다.</p>\n<div class=\"gatsby-highlight\" data-language=\"text\"><pre class=\"language-text\"><code class=\"language-text\">cd [project folder directory]\r\nnpm init -y</code></pre></div>\n<h2>Dependencies 설치</h2>\n<div class=\"gatsby-highlight\" data-language=\"js\"><pre class=\"language-js\"><code class=\"language-js\">npm install <span class=\"token operator\">-</span>g typescript\r\nnpm install express ts<span class=\"token operator\">-</span>node dotenv nodemon mongodb\r\nnpm install <span class=\"token operator\">--</span>save<span class=\"token operator\">-</span>dev cross<span class=\"token operator\">-</span>env @types<span class=\"token operator\">/</span>node @types<span class=\"token operator\">/</span>express</code></pre></div>\n<blockquote>\n<p><strong>Express</strong> <em>Node.js 웹 어플리케이션 프레임워크이며 가볍고 다양한 기능을 제공하며 특히 웹과 모바일 어플리케이션에 최적화되어 있다. Express가 API의 핵심 기능을 제공한다고 생각하면 된다.</em></p>\n<p><strong>Dotenv</strong> <em>.env 파일에 선언한 환경 변수들을 process.env라는 객체를 통해 접근할 수 있게 도와주는 라이브러리이다.</em></p>\n<p><strong>Nodemon</strong> <em>Node.js를 기반으로 하는 어플리케이션을 개발할 때 자주 쓰이며 코드를 수정할 시 자동으로 감지하여 어플리케이션을 재시작시켜준다. 배포에는 활용이 되지 않는다.</em></p>\n<p><strong>Typescript</strong> <em>Javascript에 추가적인 문법이 적용되어 에디터에서 재빠르게 에러를 찾아낼 수 있도록 도와준다.</em></p>\n<p><strong>Ts-node</strong> <em>Typescript가 적용된 스크립트가 실행되도록 Javascript로 변환해주는 역할을 한다.</em></p>\n<p><strong>MongoDB</strong> <em>Node.js 용 <a href=\"https://www.mongodb.com/\">MongoDB</a> 드라이버이다.</em></p>\n</blockquote>\n<h2>Typescript 설정</h2>\n<p>앞서 설명했듯이 Typescript는 타입 확인을 엄격하게 적용하여 에디터에서 쉽게 에러를 찾을 수 있도록 도와준다.</p>\n<p>프로젝트 폴더 하위에 tsconfig.json이라는 파일을 만들고 아래 코드를 입력한다.</p>\n<p>개발자의 원하는대로 <strong>compilerOptions</strong> 을 바꿔주면서 사용하면 된다. 이 설정에 관해서 자세한 설명은 생략하오니 더 많은 정보를 원한다면 <a href=\"https://www.typescriptlang.org/docs/handbook/tsconfig-json.html\">공식 웹사이트</a> 확인해주길 바란다.</p>\n<div class=\"gatsby-highlight\" data-language=\"js\"><pre class=\"language-js\"><code class=\"language-js\"><span class=\"token punctuation\">{</span>\r\n    <span class=\"token string-property property\">\"buildOnSave\"</span><span class=\"token operator\">:</span> <span class=\"token boolean\">false</span><span class=\"token punctuation\">,</span>\r\n    <span class=\"token string-property property\">\"compileOnSave\"</span><span class=\"token operator\">:</span> <span class=\"token boolean\">false</span><span class=\"token punctuation\">,</span>\r\n    <span class=\"token string-property property\">\"compilerOptions\"</span><span class=\"token operator\">:</span> <span class=\"token punctuation\">{</span>\r\n        <span class=\"token string-property property\">\"charset\"</span><span class=\"token operator\">:</span> <span class=\"token string\">\"utf8\"</span><span class=\"token punctuation\">,</span>\r\n        <span class=\"token string-property property\">\"module\"</span><span class=\"token operator\">:</span> <span class=\"token string\">\"commonjs\"</span><span class=\"token punctuation\">,</span>\r\n        <span class=\"token string-property property\">\"target\"</span><span class=\"token operator\">:</span> <span class=\"token string\">\"es2018\"</span><span class=\"token punctuation\">,</span>\r\n        <span class=\"token string-property property\">\"lib\"</span><span class=\"token operator\">:</span> <span class=\"token punctuation\">[</span>\r\n            <span class=\"token string\">\"es2018\"</span><span class=\"token punctuation\">,</span>\r\n            <span class=\"token string\">\"dom\"</span>\r\n        <span class=\"token punctuation\">]</span><span class=\"token punctuation\">,</span>\r\n        <span class=\"token string-property property\">\"noImplicitAny\"</span><span class=\"token operator\">:</span> <span class=\"token boolean\">true</span><span class=\"token punctuation\">,</span>\r\n        <span class=\"token string-property property\">\"removeComments\"</span><span class=\"token operator\">:</span> <span class=\"token boolean\">true</span><span class=\"token punctuation\">,</span>\r\n        <span class=\"token string-property property\">\"strictNullChecks\"</span><span class=\"token operator\">:</span> <span class=\"token boolean\">true</span><span class=\"token punctuation\">,</span>\r\n        <span class=\"token comment\">// \"noImplicitThis\": true,</span>\r\n        <span class=\"token string-property property\">\"noImplicitThis\"</span><span class=\"token operator\">:</span> <span class=\"token boolean\">false</span><span class=\"token punctuation\">,</span>\r\n        <span class=\"token string-property property\">\"alwaysStrict\"</span><span class=\"token operator\">:</span> <span class=\"token boolean\">true</span><span class=\"token punctuation\">,</span>\r\n        <span class=\"token string-property property\">\"preserveConstEnums\"</span><span class=\"token operator\">:</span> <span class=\"token boolean\">true</span><span class=\"token punctuation\">,</span>\r\n        <span class=\"token string-property property\">\"sourceMap\"</span><span class=\"token operator\">:</span> <span class=\"token boolean\">true</span><span class=\"token punctuation\">,</span>\r\n        <span class=\"token comment\">// \"esModuleInterop\": true,</span>\r\n        <span class=\"token string-property property\">\"esModuleInterop\"</span><span class=\"token operator\">:</span> <span class=\"token boolean\">true</span><span class=\"token punctuation\">,</span>\r\n        <span class=\"token string-property property\">\"noImplicitReturns\"</span><span class=\"token operator\">:</span> <span class=\"token boolean\">true</span><span class=\"token punctuation\">,</span>\r\n        <span class=\"token string-property property\">\"allowJs\"</span><span class=\"token operator\">:</span> <span class=\"token boolean\">true</span>\r\n    <span class=\"token punctuation\">}</span><span class=\"token punctuation\">,</span>\r\n    <span class=\"token string-property property\">\"include\"</span><span class=\"token operator\">:</span> <span class=\"token punctuation\">[</span>\r\n        <span class=\"token string\">\"src\"</span>\r\n    <span class=\"token punctuation\">]</span><span class=\"token punctuation\">,</span>\r\n    <span class=\"token string-property property\">\"exclude\"</span><span class=\"token operator\">:</span> <span class=\"token punctuation\">[</span><span class=\"token string\">\"node_modules\"</span><span class=\"token punctuation\">,</span> <span class=\"token string\">\"reference_deprecated\"</span><span class=\"token punctuation\">,</span> <span class=\"token string\">\"dist\"</span><span class=\"token punctuation\">,</span> <span class=\"token string\">\"scripts\"</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">,</span>\r\n    <span class=\"token string-property property\">\"typeRoots\"</span><span class=\"token operator\">:</span> <span class=\"token punctuation\">[</span>\r\n        <span class=\"token string\">\"node_modules/@types\"</span>\r\n    <span class=\"token punctuation\">]</span>\r\n<span class=\"token punctuation\">}</span></code></pre></div>\n<h2>package.json</h2>\n<p><span\n      class=\"gatsby-resp-image-wrapper\"\n      style=\"position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 587px; \"\n    >\n      <a\n    class=\"gatsby-resp-image-link\"\n    href=\"/static/f6a56c7b7eecf5b00c935aa498ef8b1f/d72eb/package-json.png\"\n    style=\"display: block\"\n    target=\"_blank\"\n    rel=\"noopener\"\n  >\n    <span\n    class=\"gatsby-resp-image-background-image\"\n    style=\"padding-bottom: 17.088607594936708%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAADCAYAAACTWi8uAAAACXBIWXMAAAsTAAALEwEAmpwYAAAAm0lEQVR42i2OSW4DMQwE5yWSrY2UKGXGS2Dn6P8/qowhcigQYBPs2vpYPN4fpi2O0ZGSmFLRkui10FthtMLSimnx7NzldCWEQIyRGAOXc4bAVkXZH3+oCDdT9iE8Z+e1m/O7Bu9jcp+D17G4m/LThWMoU5uXnQVTGjklNhuTsW7k0pCSMa1+ZNLcZmlzzBFMKlKzPy3p6oZu988XnIdX0VNZUiQAAAAASUVORK5CYII='); background-size: cover; display: block;\"\n  ></span>\n  <img\n        class=\"gatsby-resp-image-image\"\n        alt=\"package-json\"\n        title=\"\"\n        src=\"/static/f6a56c7b7eecf5b00c935aa498ef8b1f/d72eb/package-json.png\"\n        srcset=\"/static/f6a56c7b7eecf5b00c935aa498ef8b1f/c26ae/package-json.png 158w,\n/static/f6a56c7b7eecf5b00c935aa498ef8b1f/6bdcf/package-json.png 315w,\n/static/f6a56c7b7eecf5b00c935aa498ef8b1f/d72eb/package-json.png 587w\"\n        sizes=\"(max-width: 587px) 100vw, 587px\"\n        style=\"width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;\"\n        loading=\"lazy\"\n        decoding=\"async\"\n      />\n  </a>\n    </span></p>\n<p>package.json 안에 script 필드 하위에 명령어 두개를 추가해보자. 복잡한 명령어를 key 이름에 저장한 후 간단하게 <code class=\"language-text\">npm run [key name]</code> 입력하는 방식으로 해당 명령어를 실행할 수 있다.</p>\n<p><code class=\"language-text\">npm run dev</code>를 터미널에 입력하고 엔터를 누르면 실제로 <code class=\"language-text\">cross-env NODE-ENV=development nodemon --exec ts-node ./`app.ts</code> 가 실행된다. 개발모드로 실행되고 nodemon이 코드 수정이 있을 시 자동으로 재시작한다. <strong>start</strong>는 배포 시 사용된다.</p>\n<h2>Express 서버</h2>\n<div class=\"gatsby-highlight\" data-language=\"js\"><pre class=\"language-js\"><code class=\"language-js\"><span class=\"token keyword\">import</span> express<span class=\"token punctuation\">,</span> <span class=\"token punctuation\">{</span> Request<span class=\"token punctuation\">,</span> Response<span class=\"token punctuation\">,</span> NextFunction <span class=\"token punctuation\">}</span> <span class=\"token keyword\">from</span> <span class=\"token string\">\"express\"</span>\r\n\r\n<span class=\"token keyword\">const</span> app <span class=\"token operator\">=</span> <span class=\"token function\">express</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span>\r\n\r\napp<span class=\"token punctuation\">.</span><span class=\"token function\">use</span><span class=\"token punctuation\">(</span>express<span class=\"token punctuation\">.</span><span class=\"token function\">urlencoded</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">{</span> <span class=\"token literal-property property\">extended</span><span class=\"token operator\">:</span> <span class=\"token boolean\">true</span> <span class=\"token punctuation\">}</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span>\r\napp<span class=\"token punctuation\">.</span><span class=\"token function\">use</span><span class=\"token punctuation\">(</span>express<span class=\"token punctuation\">.</span><span class=\"token function\">json</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span>\r\n<span class=\"token comment\">// to parse json of body object</span>\r\n\r\n<span class=\"token comment\">// get route -> path '/'</span>\r\napp<span class=\"token punctuation\">.</span><span class=\"token function\">get</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"/\"</span><span class=\"token punctuation\">,</span> <span class=\"token punctuation\">(</span>req<span class=\"token operator\">:</span> Request<span class=\"token punctuation\">,</span> <span class=\"token literal-property property\">res</span><span class=\"token operator\">:</span> Response<span class=\"token punctuation\">)</span><span class=\"token operator\">:</span> <span class=\"token parameter\"><span class=\"token keyword\">void</span></span> <span class=\"token operator\">=></span> <span class=\"token punctuation\">{</span>\r\n  res<span class=\"token punctuation\">.</span><span class=\"token function\">send</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"Here is the response\"</span><span class=\"token punctuation\">)</span>\r\n<span class=\"token punctuation\">}</span><span class=\"token punctuation\">)</span>\r\n\r\napp<span class=\"token punctuation\">.</span><span class=\"token function\">listen</span><span class=\"token punctuation\">(</span><span class=\"token number\">4000</span><span class=\"token punctuation\">,</span> <span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token operator\">=></span> <span class=\"token punctuation\">{</span>\r\n  console<span class=\"token punctuation\">.</span><span class=\"token function\">log</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"Server is running on 4000\"</span><span class=\"token punctuation\">)</span>\r\n<span class=\"token punctuation\">}</span><span class=\"token punctuation\">)</span></code></pre></div>\n<p>위 코드를 <code class=\"language-text\">app.ts</code> 파일에 입력한 뒤 <code class=\"language-text\">npm run dev</code>를 터미널에 입력하여 서버를 시작한다. 터미널에 다음과 같이 로그가 뜬다:</p>\n<p><em>the server is listening to the port 4000</em>.</p>\n<p>각각의 라우트는 API를 사용하는 사람이 요청을 보낼 때 쓰이는 url이라고 보면 된다. 위의 코드에는 get 라우트 있는데 경로가 '/'이며 콜백 함수를 파라미터로 가지고 있다. 이 라우트에 요청을 보내게 되면 <em><strong>Here is the response</strong></em> 라는 응답을 받게 된다. 브라우저를 열고 주소 창에 <a href=\"http://localhost:4000%EB%A5%BC\">http://localhost:4000를</a> 입력해보자 - <em>로컬 환경에서 개발하기 때문에 localhost에 접근할 수 있다</em>.</p>\n<p>콜백함수는 주로 2가지 객체를 인자 값으로 받는데 Request와 Response 객체이다.</p>\n<p>Request 객체는 API 사용자가로부터 서버가 받는 정보들의 집합이라고 생각하면 된다. API 개발자는 이 Request 객체가 어떤 필드 값을 가지고 있어야 하는지 목적과 방향에 맞게 사용할 수 있다. 사용자로부터 API 키 값을 필수적으로 받아야 하는 상황이 예가 될 수 있다.</p>\n<p>Response 객체는 API 사용자가 해당 API 라우트로부터 받는 정보이다. API 서버의 목적과 개발 방향에 따라 그 정보가 달라질 것이다.</p>\n<h2>환경 변수</h2>\n<p>환경 변수는 보통 영어는 대문자로 쓰는 것이 일반적이다.</p>\n<p>프로젝트 폴더 하위에 <strong>development.env</strong>와 <strong>production.env</strong> 파일을 만들고 아래와 같이 변수 이름들을 적어 준다.</p>\n<p>MongoDB로부터 얻은 uri를 <strong>MONGODB_URI</strong>로 설정한다.</p>\n<div class=\"gatsby-highlight\" data-language=\"js\"><pre class=\"language-js\"><code class=\"language-js\"><span class=\"token constant\">PORT</span><span class=\"token operator\">=</span><span class=\"token number\">4000</span>\r\n\r\n<span class=\"token constant\">MONGO_URI</span><span class=\"token operator\">=</span><span class=\"token punctuation\">[</span>your mongodb uri<span class=\"token punctuation\">]</span>\r\n<span class=\"token constant\">MONGO_DB</span><span class=\"token operator\">=</span>test<span class=\"token operator\">-</span>db <span class=\"token comment\">// just name whatever you want for development</span>\r\n<span class=\"token constant\">MONGO_COLLECTION</span><span class=\"token operator\">=</span>test<span class=\"token operator\">-</span>collection <span class=\"token comment\">// just name whatever you want for development</span></code></pre></div>\n<h2>환경 변수 지정</h2>\n<div class=\"gatsby-highlight\" data-language=\"js\"><pre class=\"language-js\"><code class=\"language-js\"><span class=\"token keyword\">const</span> dotenv <span class=\"token operator\">=</span> <span class=\"token function\">require</span><span class=\"token punctuation\">(</span><span class=\"token string\">'dotenv'</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\r\n<span class=\"token keyword\">let</span> envFound <span class=\"token operator\">=</span> dotenv<span class=\"token punctuation\">.</span><span class=\"token function\">config</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">{</span> <span class=\"token literal-property property\">path</span><span class=\"token operator\">:</span> <span class=\"token template-string\"><span class=\"token template-punctuation string\">`</span><span class=\"token interpolation\"><span class=\"token interpolation-punctuation punctuation\">${</span>process<span class=\"token punctuation\">.</span>env<span class=\"token punctuation\">.</span><span class=\"token constant\">NODE_ENV</span><span class=\"token interpolation-punctuation punctuation\">}</span></span><span class=\"token string\">.env</span><span class=\"token template-punctuation string\">`</span></span> <span class=\"token punctuation\">}</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\r\n\r\n<span class=\"token keyword\">if</span><span class=\"token punctuation\">(</span><span class=\"token operator\">!</span>envFound<span class=\"token punctuation\">)</span> <span class=\"token keyword\">throw</span> <span class=\"token keyword\">new</span> <span class=\"token class-name\">Error</span><span class=\"token punctuation\">(</span><span class=\"token string\">'Could not find any .env file.'</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\r\n\r\n<span class=\"token keyword\">let</span> config <span class=\"token operator\">=</span> <span class=\"token punctuation\">{</span>\r\n  <span class=\"token literal-property property\">port</span><span class=\"token operator\">:</span> <span class=\"token function\">parseInt</span><span class=\"token punctuation\">(</span>process<span class=\"token punctuation\">.</span>env<span class=\"token punctuation\">.</span><span class=\"token constant\">PORT</span><span class=\"token operator\">!</span><span class=\"token punctuation\">,</span> <span class=\"token number\">10</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">,</span>\r\n  <span class=\"token literal-property property\">mongodb</span><span class=\"token operator\">:</span> <span class=\"token punctuation\">{</span>\r\n    <span class=\"token literal-property property\">uri</span><span class=\"token operator\">:</span> process<span class=\"token punctuation\">.</span>env<span class=\"token punctuation\">.</span><span class=\"token constant\">MONGO_URI</span><span class=\"token punctuation\">,</span>\r\n    <span class=\"token literal-property property\">db</span><span class=\"token operator\">:</span> process<span class=\"token punctuation\">.</span>env<span class=\"token punctuation\">.</span><span class=\"token constant\">MONGO_DB</span><span class=\"token punctuation\">,</span>\r\n    <span class=\"token literal-property property\">collection</span><span class=\"token operator\">:</span> process<span class=\"token punctuation\">.</span>env<span class=\"token punctuation\">.</span><span class=\"token constant\">MONGO_COLLECTION</span><span class=\"token punctuation\">,</span>\r\n  <span class=\"token punctuation\">}</span>\r\n<span class=\"token punctuation\">}</span><span class=\"token punctuation\">;</span>\r\n\r\n<span class=\"token keyword\">export</span> <span class=\"token keyword\">default</span> config<span class=\"token punctuation\">;</span></code></pre></div>\n<p>어플리케이션을 개발할 때 배포 전에 무수히 많은 테스트를 거치는 것이 일반적이다. 이 때문에 개발 설정과 배포 설정을 나누는 것은 굉장히 중요하다.</p>\n<p>cross-env는 환경에 따른 설정을 다르게 적용할 수 있게 도와주는 라이브러리인데 <code class=\"language-text\">cross-env NODE_ENV=production</code> 처럼 입력할 명령어 앞에 두어 어떤 환경인지 명시해 준다. 이 덕분에 다른 .env 파일을 환경에 맞게 설정해주기 때문에 같은 코드를 두번 작성할 필요가 없다.</p>\n<p><code class=\"language-text\">config.ts</code> 하위에 파일을 만든 뒤 dotenv를 import한다. 이 dotenv가 <strong>[process.env.NODE_ENV].env</strong> 파일에 담긴 정보를 읽어 오는 역할을 한다. 이 때 NODE_ENV는 명령어에서 명시해 줬던 development 혹은 production이 되겠다.</p>\n<p>위 코드 안에 모든 환경 변수 앞에 process.env가 붙어 있다. Node.js에 전역에서 접근할 수 있는 객체이기 때문에 어플리케이션 전체에서 사용될 수 있다.</p>\n<h2>어플리케이션에 MongoDB 연결</h2>\n<div class=\"gatsby-highlight\" data-language=\"js\"><pre class=\"language-js\"><code class=\"language-js\"><span class=\"token keyword\">import</span> config <span class=\"token keyword\">from</span> <span class=\"token string\">\"./config\"</span>\r\n<span class=\"token keyword\">const</span> <span class=\"token punctuation\">{</span> MongoClient <span class=\"token punctuation\">}</span> <span class=\"token operator\">=</span> <span class=\"token function\">require</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"mongodb\"</span><span class=\"token punctuation\">)</span>\r\n\r\n<span class=\"token keyword\">const</span> <span class=\"token function-variable function\">connectMongoDB</span><span class=\"token operator\">:</span> <span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token operator\">=></span> Promise<span class=\"token operator\">&lt;</span>any<span class=\"token operator\">></span> <span class=\"token operator\">=</span> <span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token operator\">=></span> <span class=\"token punctuation\">{</span>\r\n  <span class=\"token keyword\">return</span> <span class=\"token keyword\">new</span> <span class=\"token class-name\">Promise</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">(</span><span class=\"token parameter\">resolve<span class=\"token punctuation\">,</span> reject</span><span class=\"token punctuation\">)</span> <span class=\"token operator\">=></span> <span class=\"token punctuation\">{</span>\r\n    MongoClient<span class=\"token punctuation\">.</span><span class=\"token function\">connect</span><span class=\"token punctuation\">(</span>\r\n      config<span class=\"token punctuation\">.</span>mongodb<span class=\"token punctuation\">.</span>uri<span class=\"token punctuation\">,</span>\r\n      <span class=\"token punctuation\">{</span>\r\n        <span class=\"token literal-property property\">useUnifiedTopology</span><span class=\"token operator\">:</span> <span class=\"token boolean\">true</span><span class=\"token punctuation\">,</span>\r\n        <span class=\"token literal-property property\">useNewUrlParser</span><span class=\"token operator\">:</span> <span class=\"token boolean\">true</span><span class=\"token punctuation\">,</span>\r\n      <span class=\"token punctuation\">}</span><span class=\"token punctuation\">,</span>\r\n      <span class=\"token punctuation\">(</span><span class=\"token parameter\"><span class=\"token literal-property property\">err</span><span class=\"token operator\">:</span> Error<span class=\"token punctuation\">,</span> <span class=\"token literal-property property\">client</span><span class=\"token operator\">:</span> object</span><span class=\"token punctuation\">)</span> <span class=\"token operator\">=></span> <span class=\"token punctuation\">{</span>\r\n        <span class=\"token keyword\">if</span> <span class=\"token punctuation\">(</span>err<span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\r\n          <span class=\"token function\">reject</span><span class=\"token punctuation\">(</span>err<span class=\"token punctuation\">)</span>\r\n          <span class=\"token keyword\">return</span>\r\n        <span class=\"token punctuation\">}</span>\r\n\r\n        <span class=\"token function\">resolve</span><span class=\"token punctuation\">(</span>client<span class=\"token punctuation\">)</span>\r\n      <span class=\"token punctuation\">}</span>\r\n    <span class=\"token punctuation\">)</span>\r\n  <span class=\"token punctuation\">}</span><span class=\"token punctuation\">)</span>\r\n<span class=\"token punctuation\">}</span>\r\n\r\n<span class=\"token keyword\">export</span> <span class=\"token keyword\">default</span> connectMongoDB</code></pre></div>\n<p>프로젝트 폴더 하위에 파일 <code class=\"language-text\">db.ts</code>를 만든 뒤, MongoClient를 import한다. 그리고 파일 <code class=\"language-text\">config.ts</code> 만든 뒤 <em>config.mongodb.uri</em> 을 인자 값으로 입력한다. 이 uri는 MongoDB 설정할 때 얻은 uri이다.</p>\n<p>마지막으로 MongoDB를 비동기적으로 연결하도록 promise를 반환 값으로 받게 한다. 이제 API에 테스트 요청을 위해 코드를 수정해보자.</p>\n<h2>테스트 사용자 DB 등록</h2>\n<div class=\"gatsby-highlight\" data-language=\"js\"><pre class=\"language-js\"><code class=\"language-js\"><span class=\"token keyword\">import</span> express<span class=\"token punctuation\">,</span> <span class=\"token punctuation\">{</span> Request<span class=\"token punctuation\">,</span> Response<span class=\"token punctuation\">,</span> NextFunction <span class=\"token punctuation\">}</span> <span class=\"token keyword\">from</span> <span class=\"token string\">\"express\"</span>\r\n<span class=\"token keyword\">import</span> config <span class=\"token keyword\">from</span> <span class=\"token string\">\"./config\"</span>\r\n<span class=\"token keyword\">import</span> connectMongoDB <span class=\"token keyword\">from</span> <span class=\"token string\">\"./db\"</span>\r\n\r\n<span class=\"token keyword\">const</span> app <span class=\"token operator\">=</span> <span class=\"token function\">express</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span>\r\n\r\napp<span class=\"token punctuation\">.</span><span class=\"token function\">use</span><span class=\"token punctuation\">(</span>express<span class=\"token punctuation\">.</span><span class=\"token function\">urlencoded</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">{</span> <span class=\"token literal-property property\">extended</span><span class=\"token operator\">:</span> <span class=\"token boolean\">true</span> <span class=\"token punctuation\">}</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span>\r\napp<span class=\"token punctuation\">.</span><span class=\"token function\">use</span><span class=\"token punctuation\">(</span>express<span class=\"token punctuation\">.</span><span class=\"token function\">json</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span>\r\n\r\napp<span class=\"token punctuation\">.</span><span class=\"token function\">get</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"/\"</span><span class=\"token punctuation\">,</span> <span class=\"token punctuation\">(</span>req<span class=\"token operator\">:</span> Request<span class=\"token punctuation\">,</span> <span class=\"token literal-property property\">res</span><span class=\"token operator\">:</span> Response<span class=\"token punctuation\">)</span><span class=\"token operator\">:</span> <span class=\"token parameter\"><span class=\"token keyword\">void</span></span> <span class=\"token operator\">=></span> <span class=\"token punctuation\">{</span>\r\n  res<span class=\"token punctuation\">.</span><span class=\"token function\">send</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"Here is the response\"</span><span class=\"token punctuation\">)</span>\r\n<span class=\"token punctuation\">}</span><span class=\"token punctuation\">)</span>\r\n\r\napp<span class=\"token punctuation\">.</span><span class=\"token function\">post</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"/\"</span><span class=\"token punctuation\">,</span> <span class=\"token keyword\">async</span> <span class=\"token punctuation\">(</span>req<span class=\"token operator\">:</span> Request<span class=\"token punctuation\">,</span> <span class=\"token literal-property property\">res</span><span class=\"token operator\">:</span> Response<span class=\"token punctuation\">)</span><span class=\"token operator\">:</span> Promise<span class=\"token operator\">&lt;</span><span class=\"token keyword\">void</span><span class=\"token operator\">></span> <span class=\"token operator\">=></span> <span class=\"token punctuation\">{</span>\r\n  <span class=\"token keyword\">try</span> <span class=\"token punctuation\">{</span>\r\n    <span class=\"token keyword\">const</span> firstName <span class=\"token operator\">=</span> req<span class=\"token punctuation\">.</span>body<span class=\"token punctuation\">.</span>firstName\r\n    <span class=\"token keyword\">const</span> lastName <span class=\"token operator\">=</span> req<span class=\"token punctuation\">.</span>body<span class=\"token punctuation\">.</span>lastName\r\n\r\n    <span class=\"token keyword\">const</span> client <span class=\"token operator\">=</span> <span class=\"token keyword\">await</span> <span class=\"token function\">connectMongoDB</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span>\r\n    <span class=\"token keyword\">const</span> db <span class=\"token operator\">=</span> <span class=\"token keyword\">await</span> client<span class=\"token punctuation\">.</span><span class=\"token function\">db</span><span class=\"token punctuation\">(</span>config<span class=\"token punctuation\">.</span>mongodb<span class=\"token punctuation\">.</span>db<span class=\"token punctuation\">)</span>\r\n    <span class=\"token keyword\">const</span> collection <span class=\"token operator\">=</span> <span class=\"token keyword\">await</span> db<span class=\"token punctuation\">.</span><span class=\"token function\">collection</span><span class=\"token punctuation\">(</span>config<span class=\"token punctuation\">.</span>mongodb<span class=\"token punctuation\">.</span>collection<span class=\"token punctuation\">)</span>\r\n\r\n    <span class=\"token keyword\">await</span> collection<span class=\"token punctuation\">.</span><span class=\"token function\">insertOne</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">{</span>\r\n      <span class=\"token literal-property property\">firstName</span><span class=\"token operator\">:</span> firstName<span class=\"token punctuation\">,</span>\r\n      <span class=\"token literal-property property\">lastName</span><span class=\"token operator\">:</span> lastName<span class=\"token punctuation\">,</span>\r\n    <span class=\"token punctuation\">}</span><span class=\"token punctuation\">)</span>\r\n\r\n    res<span class=\"token punctuation\">.</span><span class=\"token function\">status</span><span class=\"token punctuation\">(</span><span class=\"token number\">200</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">.</span><span class=\"token function\">send</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"Successfully Created in DB\"</span><span class=\"token punctuation\">)</span>\r\n  <span class=\"token punctuation\">}</span> <span class=\"token keyword\">catch</span> <span class=\"token punctuation\">(</span>err<span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\r\n    res<span class=\"token punctuation\">.</span><span class=\"token function\">status</span><span class=\"token punctuation\">(</span><span class=\"token number\">500</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">.</span><span class=\"token function\">send</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"Error Occured in Server\"</span><span class=\"token punctuation\">)</span>\r\n    console<span class=\"token punctuation\">.</span><span class=\"token function\">log</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"&lt;POST> '/' error occured\"</span><span class=\"token punctuation\">,</span> err<span class=\"token punctuation\">)</span>\r\n  <span class=\"token punctuation\">}</span>\r\n<span class=\"token punctuation\">}</span><span class=\"token punctuation\">)</span>\r\n\r\napp<span class=\"token punctuation\">.</span><span class=\"token function\">listen</span><span class=\"token punctuation\">(</span>config<span class=\"token punctuation\">.</span>port<span class=\"token punctuation\">,</span> <span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token operator\">=></span> <span class=\"token punctuation\">{</span>\r\n  console<span class=\"token punctuation\">.</span><span class=\"token function\">log</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"Server is running on\"</span><span class=\"token punctuation\">,</span> config<span class=\"token punctuation\">.</span>port<span class=\"token punctuation\">)</span>\r\n<span class=\"token punctuation\">}</span><span class=\"token punctuation\">)</span></code></pre></div>\n<p>post 라우트를 추가한다. 이 라우트는 API 사용자로부터 성과 이름을 받고 이를 데이터베이스에 넣는 기능이 목적이다. Request 객체의 body라는 필드에 사용자가 입력한 성과 이름이 저장이 된다.</p>\n<p>MongoDB promise가 resolve한 값을 connect라는 변수를 선언하여 저장한다 - <em><code class=\"language-text\">config.ts</code>에 저장한 데이터베이스와 콜렉션 이름이 여기 쓰인다</em> - 요청에서 받은 성과 이름을 <strong>insertOne</strong> 이라는 함수로 데이터베이스에 입력하게 된다.</p>\n<p>에러 없이 코드가 실행된다면 post 라우트가 status 코드 200과 함께 <em><strong>Successfully Created in DB</strong></em> 라는 정보를 사용자에게 보낸다.</p>\n<h2>Insomnia 요청 테스트</h2>\n<p><span\n      class=\"gatsby-resp-image-wrapper\"\n      style=\"position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 548px; \"\n    >\n      <a\n    class=\"gatsby-resp-image-link\"\n    href=\"/static/21f9724b06b007f1b24f728d04bfc897/a58fe/insomnia-1.png\"\n    style=\"display: block\"\n    target=\"_blank\"\n    rel=\"noopener\"\n  >\n    <span\n    class=\"gatsby-resp-image-background-image\"\n    style=\"padding-bottom: 77.21518987341771%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAPCAYAAADkmO9VAAAACXBIWXMAAAsTAAALEwEAmpwYAAACIElEQVR42p2TT4vaQBiH81EUk2hiNImbtLC2VdR7Dz16EUG8ePAD9IP4p67SQil4bys9qLDQHltaeulWlLouu9QkjRuRGvMrM6nWQmHdDjzMEGaemZf8XuZi9APG3IBz7cBZXMO2F9i4LjzP+80G3sbDoYN5cfISneZztFoN1Ot1NJtNNBsN1Go1tE/aaLWe0O/tdhudTudGmEf6Y6T1h4iIHMLhMCKCgFgsBlEQcUfTkVBVsCyLQCBwEMzxvbtIp1LIpDNIJo8hyzISiQRy2Sx0TYMkSeB5/mAYRVFAiMfjFCIgUoWgKIjF42B5DizHgeV5f2ZZCsf5Ve3DkMO+KEZLJUJVVSHLCrKZDFLJJDRVhZ5IQFNUaJoGXdcpZF8kEoEgCDsYKSqBIvkQKbkpdf8BTp8+w+feG3x61cPH1z187Q8xefsOX87OcDGbodvtIhgMIhqN7gmlP7J9IXnd9P0H/Ly8wvJ8huX0HOvLK3imBdd1aUQGgwH9EYcJsxl8m05hLRb4bpkwbBumbWOz2WC9Xt9emMvlMB6PYZomLNOEMZ9jtVrRsG9fOBwObyecTCawbRuWZdHZMAwsl0vaSf8lHI1GcByHSghkuO56t+73+zcLCWQDiUShUECpVEKxWNxRLpdRqVRQrVaRz+fp5X/H5h/CrXQbYBKNbWuFQiG/KziOCsSoeJhwWz4JvSiKFHJAjsu0JY+O/ICTPfvh/gVi9YxljNUHXAAAAABJRU5ErkJggg=='); background-size: cover; display: block;\"\n  ></span>\n  <img\n        class=\"gatsby-resp-image-image\"\n        alt=\"insomnia-1\"\n        title=\"\"\n        src=\"/static/21f9724b06b007f1b24f728d04bfc897/a58fe/insomnia-1.png\"\n        srcset=\"/static/21f9724b06b007f1b24f728d04bfc897/c26ae/insomnia-1.png 158w,\n/static/21f9724b06b007f1b24f728d04bfc897/6bdcf/insomnia-1.png 315w,\n/static/21f9724b06b007f1b24f728d04bfc897/a58fe/insomnia-1.png 548w\"\n        sizes=\"(max-width: 548px) 100vw, 548px\"\n        style=\"width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;\"\n        loading=\"lazy\"\n        decoding=\"async\"\n      />\n  </a>\n    </span></p>\n<p>Insomnia는 오픈 소스 API 클라이언트인데 쉽게 말해서 API를 개발할 때 기능을 확인하는 데 유용한 도구이다. Insomnia를 통해 지금까지 개발한 API의 post 라우트에 요청을 해보자. Insomnia를 다운로드 받았다면 실행한 뒤 위 그림처럼 HTTP Request를 누른다.</p>\n<p><span\n      class=\"gatsby-resp-image-wrapper\"\n      style=\"position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 475px; \"\n    >\n      <a\n    class=\"gatsby-resp-image-link\"\n    href=\"/static/d0c4c2e2644da1b0f59ab116f99b73ec/466da/insomnia-2.png\"\n    style=\"display: block\"\n    target=\"_blank\"\n    rel=\"noopener\"\n  >\n    <span\n    class=\"gatsby-resp-image-background-image\"\n    style=\"padding-bottom: 46.202531645569614%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAJCAYAAAAywQxIAAAACXBIWXMAAAsTAAALEwEAmpwYAAABVUlEQVR42p1RO07DQBTcW1AQYTsmeP9re9chIQqxQyJEg0RBR0WJFA5ATcEBuAAFh+Ea9Jxh0K6yxBKfgmL09nnezs4bE6YzUJmjNCUm4zGqqkJdVTg5nsLWFgdJgjRNkSTJF3yfZUPsD/Zwf/OKl6cPPD+843HzBsIFg5ACnHEIIaCUCtX3UkpwzlAUBZTSMMZASQlKKTjnOCpGWM6ucXW+weXqDhfdLYgxJZqmCQOMMThrYYwGpQx1XaNxDThjmE1n6NoOjXPhQWvrsNXhKMUwHyDLB8hHCYgnozOtdTh74fhAPEcIznszDFJIKKmhlQmVlGUJax26tsXpfI52sQgX6FbIr+dn1qs1losOq+UZppNJ+O5FffVGnHMhEuIbn4vsoe+I8122Sqof+biNd0x8TkE0rGxC/SbIeZiJkfwkFkH8H/S2++gP7BC53/it4F/kf/AJ+BMV5RMbOdIAAAAASUVORK5CYII='); background-size: cover; display: block;\"\n  ></span>\n  <img\n        class=\"gatsby-resp-image-image\"\n        alt=\"insomnia-1\"\n        title=\"\"\n        src=\"/static/d0c4c2e2644da1b0f59ab116f99b73ec/466da/insomnia-2.png\"\n        srcset=\"/static/d0c4c2e2644da1b0f59ab116f99b73ec/c26ae/insomnia-2.png 158w,\n/static/d0c4c2e2644da1b0f59ab116f99b73ec/6bdcf/insomnia-2.png 315w,\n/static/d0c4c2e2644da1b0f59ab116f99b73ec/466da/insomnia-2.png 475w\"\n        sizes=\"(max-width: 475px) 100vw, 475px\"\n        style=\"width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;\"\n        loading=\"lazy\"\n        decoding=\"async\"\n      />\n  </a>\n    </span></p>\n<p>헤더 안에 Content-Type을 application/json으로 설정하여 body 객체에 접근하게 한다.</p>\n<p><span\n      class=\"gatsby-resp-image-wrapper\"\n      style=\"position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 474px; \"\n    >\n      <a\n    class=\"gatsby-resp-image-link\"\n    href=\"/static/99d9d57ec0466b20709cd661b263fc9b/5595f/insomnia-3.png\"\n    style=\"display: block\"\n    target=\"_blank\"\n    rel=\"noopener\"\n  >\n    <span\n    class=\"gatsby-resp-image-background-image\"\n    style=\"padding-bottom: 32.911392405063296%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAHCAYAAAAIy204AAAACXBIWXMAAAsTAAALEwEAmpwYAAABL0lEQVR42pWPMU7DMBhGcw8koE1iO7aTOE6ahgKFgoSE2BhAgpEFMYI4ADsHKGycCXEBLvKQXVF1YWB40vf+4dP/JcoK6sbTTSY0TYP3nq7rmM1mCCEYjUaMx2PSNI2EvPKM7Z0t7q/feXv55vX5k9enL5JGpPSqoPceYy1VWVJVFc458jyPJVmWrYvCLXiW5eyOtrk8e+Lx7oOH2yX310uSq8UpN3XDXEqqrqX1DUopjDEMw0Bd1+scaNuWoijiCucapMzJRYoQGUJmJCe146Kq6YRGFRajLVJplNLx01Cm9SpvelmWWGujb5IorSlKg9/TDMeGyYFlmJbs71dIqeK3ASll5Nf/IgmTWu/ZO6qZnzumh46ThWc+d2ht4xf/IQkz+r7HmnKNMTYSZv2XHyms3Hz74jFVAAAAAElFTkSuQmCC'); background-size: cover; display: block;\"\n  ></span>\n  <img\n        class=\"gatsby-resp-image-image\"\n        alt=\"insomnia-1\"\n        title=\"\"\n        src=\"/static/99d9d57ec0466b20709cd661b263fc9b/5595f/insomnia-3.png\"\n        srcset=\"/static/99d9d57ec0466b20709cd661b263fc9b/c26ae/insomnia-3.png 158w,\n/static/99d9d57ec0466b20709cd661b263fc9b/6bdcf/insomnia-3.png 315w,\n/static/99d9d57ec0466b20709cd661b263fc9b/5595f/insomnia-3.png 474w\"\n        sizes=\"(max-width: 474px) 100vw, 474px\"\n        style=\"width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;\"\n        loading=\"lazy\"\n        decoding=\"async\"\n      />\n  </a>\n    </span></p>\n<p>타입을 JSON으로 두고 firstname, lastname이라는 필드를 가진 객체 형식으로 입력한 뒤 Send 버튼을 누른다.</p>\n<p><span\n      class=\"gatsby-resp-image-wrapper\"\n      style=\"position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 364px; \"\n    >\n      <a\n    class=\"gatsby-resp-image-link\"\n    href=\"/static/7297d056ce9e0ca2da867cc47b51918b/e45a9/insomnia-4.png\"\n    style=\"display: block\"\n    target=\"_blank\"\n    rel=\"noopener\"\n  >\n    <span\n    class=\"gatsby-resp-image-background-image\"\n    style=\"padding-bottom: 31.645569620253163%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAGCAYAAADDl76dAAAACXBIWXMAAAsTAAALEwEAmpwYAAABR0lEQVR42o2NvWrCYBSGcyuJ1p/EfDFfgpoY/2K1UKW30ql06NClc5cOhW4deiGCoCiOgpo7UFHEyekp+UrX0gMP5z0Ph3M0r57j+XPAy9cdjx9tvLBAGDTodmOEsJFS0u/1VTcMg0wm8yeaG1zx8HbD0/uQ+9cGslYgrEV02m3sUolyuUzvuocnJbquq6Mp2WxWHdB1A0P/eZQ6zTJtbNOlZDoUr2wKhSK5XA7TNBHCwXEElmWpZdu2ka6LIwT5fF5515VIV2JZpnJatVplMLhlOBzQidv4vofv+7RaLeI4JorqBEGA4zhUKhVazSZhECKEwPM8GlGDZtRUOXXafD5nMpkwnU4Zj8fMZjMWi4WaU9I8Go1YLpckScJqtWaz2aicJBvW67Xi12nn85nj8ajYbrccDgdOpxO73Y79fq9y6i+XC/+pb7FuE5zPWcNaAAAAAElFTkSuQmCC'); background-size: cover; display: block;\"\n  ></span>\n  <img\n        class=\"gatsby-resp-image-image\"\n        alt=\"insomnia-1\"\n        title=\"\"\n        src=\"/static/7297d056ce9e0ca2da867cc47b51918b/e45a9/insomnia-4.png\"\n        srcset=\"/static/7297d056ce9e0ca2da867cc47b51918b/c26ae/insomnia-4.png 158w,\n/static/7297d056ce9e0ca2da867cc47b51918b/6bdcf/insomnia-4.png 315w,\n/static/7297d056ce9e0ca2da867cc47b51918b/e45a9/insomnia-4.png 364w\"\n        sizes=\"(max-width: 364px) 100vw, 364px\"\n        style=\"width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;\"\n        loading=\"lazy\"\n        decoding=\"async\"\n      />\n  </a>\n    </span></p>\n<p>MongoDB에 정보가 입력되었다면 다음과 같이 나타난다:</p>\n<p><span\n      class=\"gatsby-resp-image-wrapper\"\n      style=\"position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 630px; \"\n    >\n      <a\n    class=\"gatsby-resp-image-link\"\n    href=\"/static/2e3f18a7711812153d456cc8711d9d52/d67fd/result.png\"\n    style=\"display: block\"\n    target=\"_blank\"\n    rel=\"noopener\"\n  >\n    <span\n    class=\"gatsby-resp-image-background-image\"\n    style=\"padding-bottom: 56.9620253164557%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAALCAYAAAB/Ca1DAAAACXBIWXMAAAsTAAALEwEAmpwYAAABVklEQVR42p2S627bMAxG9f6PN7RFkQYF2nlpsmSxrfuF8hkkJ7382AKUwLFEmqQ/U1LGOh6fnnnYbHl42vL8OnC/2XK32fJrf2BZFkoRci7ElBCR7qecVy6xq6kiwtmbnmyMIcbYi63zTFqjjWHWKz4EvPeM09zjISbO44S1lpgzuQoqlMwpmq7EOocLgbpUjLUY5/qqrcV6f8nxjPNMiJGFpee39+3jLqdVYWsQcyJL6bR9uuyvJMnvOaUWUln9tn6OqT/jmd3brs8jpNR/PZevzXpBRz758sVfEdTh94FhGLDOYoxGN+nOEUL4FuoqOaS4KswJH8O3UdoaZqMxznKcJl7e9rSDSrWSqnwg0md0C9VmI3W9W1UyEh1LCtToqcFR44UWq+sB/g/VHs2Gw5HHux+Mu5/48wnmE0zHD8wItXLLVLtbzSZteNntmX0ilNuF/2r4F+iJWVtcQJFyAAAAAElFTkSuQmCC'); background-size: cover; display: block;\"\n  ></span>\n  <img\n        class=\"gatsby-resp-image-image\"\n        alt=\"result\"\n        title=\"\"\n        src=\"/static/2e3f18a7711812153d456cc8711d9d52/f058b/result.png\"\n        srcset=\"/static/2e3f18a7711812153d456cc8711d9d52/c26ae/result.png 158w,\n/static/2e3f18a7711812153d456cc8711d9d52/6bdcf/result.png 315w,\n/static/2e3f18a7711812153d456cc8711d9d52/f058b/result.png 630w,\n/static/2e3f18a7711812153d456cc8711d9d52/d67fd/result.png 670w\"\n        sizes=\"(max-width: 630px) 100vw, 630px\"\n        style=\"width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;\"\n        loading=\"lazy\"\n        decoding=\"async\"\n      />\n  </a>\n    </span></p>\n<h2>결론</h2>\n<p>API 서버는 보통 개발자 자신 혹은 회사의 목적에 따라 더욱 커지거나 복잡해진다. 크고 복잡한 API 서버를 개발하는 실력을 키우려면 직접 더 많은 크고 작은 프로젝트들을 개발해보는 방법이 가장 도움이 될 가능성이 높다. 예를 들면, 더 많은 라우트를 추가하거나 더 많은 타입 정의들을 써보거나 다른 데이터베이스를 써보는 것이라고 생각한다. 이 간단한 API로부터 더 멋진 API를 개발하기를 바라면서 마무리하겠다.</p>\n<p>해당 글에서 사용된 코드는 개인 github <a href=\"https://github.com/shkim04/express_typescript_simple_api\">레파지토리</a>에 있으니 필요하시면 확인해 주세요!</p>\n<p><em><strong>읽어 주셔서 감사합니다. To be continued!</strong></em></p>\n<p><em>이 글은 <a href=\"https://medium.com/@shkim04/node-js-how-to-create-a-simple-rest-api-with-express-mongodb-and-typescript-54b1d801d073\">Medium</a>에도 업로드 되었습니다.</em>\r\n<em>놀러 오세요!</em></p>","frontmatter":{"title":"Express, MongoDB, Typescript로 REST API 개발하기","date":"2022년 12월 01일","description":"","tag":["NodeJS","Database"]},"fields":{"locale":"ko"}},"previous":{"fields":{"slug":"/react-native-modal-구현하기"},"frontmatter":{"title":"React Native Modal Expo로 구현하기"}},"next":{"fields":{"slug":"/aws-ec2-인스턴트-시작-node-설치"},"frontmatter":{"title":"AWS EC2 인스턴스 생성 후 Node 설치하기"}}},"pageContext":{"locale":"ko","isDefaultLang":true,"slug":"/express-mongodb-typescript로-restapi-개발하기","titleByLang":{"ko":"express-mongodb-typescript로-restapi-개발하기","en":"restapi-with-express-mongodb-typescript"},"dateFormat":"YYYY년 MM월 DD일","id":"4c7b94c3-2071-54b0-a030-da9ce6b56f8e","previousPostId":"f210ba89-b721-539b-9c57-bf503e62f89e","nextPostId":"283d5c4d-98bc-5b1b-b62e-e732ab174515"}},"staticQueryHashes":[],"slicesMap":{}}