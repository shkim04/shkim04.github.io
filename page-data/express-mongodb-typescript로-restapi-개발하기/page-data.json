{"componentChunkName":"component---src-templates-blog-post-js","path":"/express-mongodb-typescript로-restapi-개발하기/","result":{"data":{"site":{"siteMetadata":{"title":"Seunghyun's Blog"}},"markdownRemark":{"id":"f93df7fa-d3c1-58f1-9e15-32aa9e6bc021","excerpt":"REST API는 마치 음식점의 메뉴와 같다. 손님이 메뉴를 보면 그 음식점이 어떤 음식들을 요리하는지 알 수 있는 것처럼 개발자가 한 소프트웨어 상품의 API 문서를 보면 무슨 기능을 제공하는지 알 수 있다. API 문서에는 흔히 요청 url이 적혀 있고 각 url…","html":"<p>REST API는 마치 음식점의 메뉴와 같다. 손님이 메뉴를 보면 그 음식점이 어떤 음식들을 요리하는지 알 수 있는 것처럼 개발자가 한 소프트웨어 상품의 API 문서를 보면 무슨 기능을 제공하는지 알 수 있다. API 문서에는 흔히 요청 url이 적혀 있고 각 url에 대한 설명을 찾아볼 수 있다. 이 중 한 url에 요청을 보내면 그에 대한 응답을 받는 것이다. 개발자는 이 응답을 받아 가공 후 자신의 앱에 사용하면 된다. 이제 API를 만들어 보자.</p>\n<h2>필수</h2>\n<ul>\n<li>Node.js + Typescript</li>\n<li>MongoDB</li>\n<li>Insomnia</li>\n</ul>\n<h2>MongoDB 데이터베이스</h2>\n<p>먼저 MongoDB 설정부터 시작하겠다. MongoDB는 NoSQL 데이터베이스로 아주 많이 사용되는 데이터베이스 중 하나이다. 흔히 CRUD라고 말하는 create, retrieve, update, delete 요청을 적용하는 것이 아주 용이하다.</p>\n<p>MongoDB 사용을 위해서 계정을 만들어야 한다. google이나 github 계정과 연동해서 쉽게 만들 수 있다. 계정을 생성해도 먼저 돈을 지불하지 않으며 추후에 큰 규모의 데이터를 처리할 때 처리량에 따라 지불하면 된다.</p>\n<p>계정을 생성하고 로그인을 하면 다음과 같은 대시보드가 나온다:</p>\n<p><span\n      class=\"gatsby-resp-image-wrapper\"\n      style=\"position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 630px; \"\n    >\n      <a\n    class=\"gatsby-resp-image-link\"\n    href=\"/static/3a8ad2fc6c44825ba1ca050587fc4387/c0255/mongodb-1.png\"\n    style=\"display: block\"\n    target=\"_blank\"\n    rel=\"noopener\"\n  >\n    <span\n    class=\"gatsby-resp-image-background-image\"\n    style=\"padding-bottom: 55.69620253164557%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAALCAYAAAB/Ca1DAAAACXBIWXMAAAsTAAALEwEAmpwYAAAB2UlEQVR42m2SSW/UQBSE/f+vIA5IkL+AcgERJDiAcuBKQELARJklHi+9eOl2rx+yHSImSUmlbr/nKlW/7uJGVmzaknroCCnS2cBWTGylY68ce+nYScdBOaz35JyZMa9Psfha3vCtLvk9KvZupB00f6oD182RnajY1CXXTclO1mxFTUzpkeH/KG5Vz1ZoftYHjr0ixQR55fLzA8FTOEm4r48c2oreGkIIpJwYXMC4jJ0mhnFkNIZuGBjMuu/HcanP/VlzYlgJQas0U/A474kp0BiPtCyC2Uj3PY0Q6K5HdR21EAilMNYuhidHrmXL9naP0ooQAyFG5pqQLXW7Cmf4uzQPkVLCOY8xhnEcKXbfr/j144pms8F1HTFnZCMRlaAtG0Y9LEKh+yXp3dDuZrtyNu0Hg5kcRX2zZb+5RpUlYbK4EHj16S3PL97w4sM5Z1/eY/ycLjNMEevzI4aYsS4y+UzRaE0pWkbv8DHgguf15QUvP7/j7PKCZx/P6Se7Hi+vmVLOxJSXkCmdPp1iHnqrFNqOSzofPNn5tevjspjJYt2E1Gq5nNGapSY7fd/Tfbf4FLPBv2TzfvKOsm0QneZQ1wuPbYseehopua2q+++yaWiURGiN1JpaCv4CMGROJxLpjUIAAAAASUVORK5CYII='); background-size: cover; display: block;\"\n  ></span>\n  <img\n        class=\"gatsby-resp-image-image\"\n        alt=\"mongodb-1\"\n        title=\"\"\n        src=\"/static/3a8ad2fc6c44825ba1ca050587fc4387/f058b/mongodb-1.png\"\n        srcset=\"/static/3a8ad2fc6c44825ba1ca050587fc4387/c26ae/mongodb-1.png 158w,\n/static/3a8ad2fc6c44825ba1ca050587fc4387/6bdcf/mongodb-1.png 315w,\n/static/3a8ad2fc6c44825ba1ca050587fc4387/f058b/mongodb-1.png 630w,\n/static/3a8ad2fc6c44825ba1ca050587fc4387/c0255/mongodb-1.png 920w\"\n        sizes=\"(max-width: 630px) 100vw, 630px\"\n        style=\"width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;\"\n        loading=\"lazy\"\n        decoding=\"async\"\n      />\n  </a>\n    </span></p>\n<p>개발하려고 하는 앱이 데이터베이스에 접근하게 하려면 데이터베이스 사용자를 생성하고 역할을 주어야 한다. 좌측 사이드바에 있는 <em><strong>Database Access</strong></em> 누르고 넘어간 페이지의 우측에 보이는 <strong>ADD NEW DATABASE USER</strong> 클릭한다.</p>\n<p><span\n      class=\"gatsby-resp-image-wrapper\"\n      style=\"position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 630px; \"\n    >\n      <a\n    class=\"gatsby-resp-image-link\"\n    href=\"/static/eb846077747d9323877832016910ecf5/c4b7c/mongodb-2.png\"\n    style=\"display: block\"\n    target=\"_blank\"\n    rel=\"noopener\"\n  >\n    <span\n    class=\"gatsby-resp-image-background-image\"\n    style=\"padding-bottom: 81.64556962025317%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAQCAYAAAAWGF8bAAAACXBIWXMAAAsTAAALEwEAmpwYAAACK0lEQVR42o1TiW7sIAzM/39i270TIFy5OEIgmSfYTbvbVtWzNMKYeDLGppJKo+UCQirwB7Lv5xnFtq1g21as6x1p3f3tZZ+tYpyDMo6aMBDWoia0+OfrDdeG4ly3ONesoKEMjAvUlKEVsvg5h7a8rH4OqAhluBKCS9OUoOq6At31UN0EOUaoKaEzEcuyYIkR8QlZWV5zPKUV1TuvcZMtDrTGO7lhjB5T8uiCwfYo1TqLOcxln1JCTKkQzSFgNKbE9uuo2DwgYoN2ExotYOIMG2dQ05XEGBNaodANY0nIKkMIhUT3PW6EwTn/UJxQ2WXGFBxMDHApFn+YLea4lKSM3dai+Au7PceqfpzQ9wPEMEMOHtYYeOdgrYV1Ds65ouyZ4DeifV+1HwfQjyPE6Yz2cMSy5At4VfIX7kxfP6ksoTDWldK2rseWO7dtn5f8A4+z8v2Tss+Sx+MJqm6gbjXcrQYeSdsfpLkBISw/yAqhGUcIziGFKMgD2w0DWinhQ/hM+l+rMkEe6Dz1DWvhvL+PRwhYS4e3gu9K9kY9V1IUHk4nvB1P+Dhf8HY44toQXOsaVypwoQoXIlEzCakkhJRQWpdV5IqkglQKSilwztH1PSrXdRgbAtMyeM5hOcdEGUYmYHuLaU4w/v7M9rnc/fiAD7EgxytDKM5v7yBMw9gEOxl4a+/d1vp1Jn6xfNpOsSC/oCpwDp47nRXpEU5peK0R+gGBtb928mUOvzXsH7Q82LeDGspyAAAAAElFTkSuQmCC'); background-size: cover; display: block;\"\n  ></span>\n  <img\n        class=\"gatsby-resp-image-image\"\n        alt=\"mongodb-2\"\n        title=\"\"\n        src=\"/static/eb846077747d9323877832016910ecf5/f058b/mongodb-2.png\"\n        srcset=\"/static/eb846077747d9323877832016910ecf5/c26ae/mongodb-2.png 158w,\n/static/eb846077747d9323877832016910ecf5/6bdcf/mongodb-2.png 315w,\n/static/eb846077747d9323877832016910ecf5/f058b/mongodb-2.png 630w,\n/static/eb846077747d9323877832016910ecf5/c4b7c/mongodb-2.png 903w\"\n        sizes=\"(max-width: 630px) 100vw, 630px\"\n        style=\"width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;\"\n        loading=\"lazy\"\n        decoding=\"async\"\n      />\n  </a>\n    </span></p>\n<p>사용자 이름과 비밀번호를 입력한다. 데이터베이스에 연결할 때 이 두 정보가 필요하니 꼭 기억해두어야 한다. 그리고 해당 사용자에 <em>Atlas admin</em> 역할을 부여한다. 만약 단순히 읽기 역할만 주고 싶거나 읽기/쓰기 역할만 주고 싶을 때는 그에 맞게 권한을 부여하면 된다.</p>\n<p>다시 대시보드로 페이지를 이동하고 <em>connect</em> 를 클릭하면 개발할 API에 사용될 URI를 얻어야 한다.</p>\n<p><span\n      class=\"gatsby-resp-image-wrapper\"\n      style=\"position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 440px; \"\n    >\n      <a\n    class=\"gatsby-resp-image-link\"\n    href=\"/static/6e847138a836b8c5c19669a5a558fc2e/48c0e/mongodb-3.png\"\n    style=\"display: block\"\n    target=\"_blank\"\n    rel=\"noopener\"\n  >\n    <span\n    class=\"gatsby-resp-image-background-image\"\n    style=\"padding-bottom: 57.59493670886076%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAMCAYAAABiDJ37AAAACXBIWXMAAAsTAAALEwEAmpwYAAABuUlEQVR42n2RC4+iMBSF/f+/bLPj7iQzo6syKljKwzegKMjl27QNLGM20+Rwem7paXvPKMkEg/AkbI6O9VnY5kJ4FNTRrceZEJ2dDs9C3bS0rYMZHY+OVzhcQJ8gOEKSOewKiM6u3uk0dzXDw9GZWcOpXvKhVyy3ikWyxtsq1ntNsI/4TAOm8Rov3TBLAsJTwnqn8NKAeRIy0T6n6+XrDZfbiHftM40V02hj8a4D/sQKf5/yqlb8WM2YxMrWPlPN2PeYRMZUsS/yr4ZleaNtxFRAHFpxWprGstXfjGEfR5eypLzfqR81dV1TVRWV4bpyc6srHk1D0zSISB/GMJS+h+Yj5jYG4tj+aE58gjF7Rmv3/dOjpn/OYGsrSF5AnkNR0GYZUtf/fa48tWMk0uDlCf7xwWrXsjjAdZ9RvL2RLDzi+YLdx4RsNidIUzZhSKA1QRgSb7fklwsqilBxjE4SYyhE5Ql1aljtBP8Mt0PO+WVM8PuV1csv4p9j8vkCP0lQWluDINSEcUxxvVpeq9DyyDR6kFcPud3A4H6nLW8u8W8S7p9sk+sCkUEwXRDdEV3zbYDSz9s+UKf/AoR4niIIHTLYAAAAAElFTkSuQmCC'); background-size: cover; display: block;\"\n  ></span>\n  <img\n        class=\"gatsby-resp-image-image\"\n        alt=\"mongodb-3\"\n        title=\"\"\n        src=\"/static/6e847138a836b8c5c19669a5a558fc2e/48c0e/mongodb-3.png\"\n        srcset=\"/static/6e847138a836b8c5c19669a5a558fc2e/c26ae/mongodb-3.png 158w,\n/static/6e847138a836b8c5c19669a5a558fc2e/6bdcf/mongodb-3.png 315w,\n/static/6e847138a836b8c5c19669a5a558fc2e/48c0e/mongodb-3.png 440w\"\n        sizes=\"(max-width: 440px) 100vw, 440px\"\n        style=\"width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;\"\n        loading=\"lazy\"\n        decoding=\"async\"\n      />\n  </a>\n    </span></p>\n<p>다음과 같은 버튼을 클릭한다.</p>\n<p><span\n      class=\"gatsby-resp-image-wrapper\"\n      style=\"position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 630px; \"\n    >\n      <a\n    class=\"gatsby-resp-image-link\"\n    href=\"/static/0025ae2a27a14902400eb32cda23fdf0/13e20/mongodb-4.png\"\n    style=\"display: block\"\n    target=\"_blank\"\n    rel=\"noopener\"\n  >\n    <span\n    class=\"gatsby-resp-image-background-image\"\n    style=\"padding-bottom: 10.759493670886075%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAACCAYAAABYBvyLAAAACXBIWXMAAAsTAAALEwEAmpwYAAAAcUlEQVR42k2NMQ4CIRQF9/7H8RB29jYmrhHNBvbDBwtZPhkjamLxMq+amXZyYC9HZBFm57hcHafzjObC1hrPWqm1Dn7+Nmhm9N6x38xorTHdH8ItBVJS/Cr4sLL4QNJMLmXwvZiUqDpCUfOI9a/oX/gCLeaZgnQ6wsYAAAAASUVORK5CYII='); background-size: cover; display: block;\"\n  ></span>\n  <img\n        class=\"gatsby-resp-image-image\"\n        alt=\"mongodb-4\"\n        title=\"\"\n        src=\"/static/0025ae2a27a14902400eb32cda23fdf0/f058b/mongodb-4.png\"\n        srcset=\"/static/0025ae2a27a14902400eb32cda23fdf0/c26ae/mongodb-4.png 158w,\n/static/0025ae2a27a14902400eb32cda23fdf0/6bdcf/mongodb-4.png 315w,\n/static/0025ae2a27a14902400eb32cda23fdf0/f058b/mongodb-4.png 630w,\n/static/0025ae2a27a14902400eb32cda23fdf0/13e20/mongodb-4.png 741w\"\n        sizes=\"(max-width: 630px) 100vw, 630px\"\n        style=\"width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;\"\n        loading=\"lazy\"\n        decoding=\"async\"\n      />\n  </a>\n    </span></p>\n<p><span\n      class=\"gatsby-resp-image-wrapper\"\n      style=\"position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 630px; \"\n    >\n      <a\n    class=\"gatsby-resp-image-link\"\n    href=\"/static/7a7afdf2faffeb26bfe1b80c0e13a6f5/6c2f2/mongodb-5.png\"\n    style=\"display: block\"\n    target=\"_blank\"\n    rel=\"noopener\"\n  >\n    <span\n    class=\"gatsby-resp-image-background-image\"\n    style=\"padding-bottom: 70.25316455696203%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAOCAYAAAAvxDzwAAAACXBIWXMAAAsTAAALEwEAmpwYAAAB1UlEQVR42o2TbY+bMBCE8///XNVWuvbb3elCAgGDDfgd+6nsXCIu7bW1NCy28Ozs7nDYUsIEh4keXWJw2OiJaatn5d28Q0dH2CLOOXwI5Jx/wyGkSO9mLjsIv1Si1kguVtXYGclJTyzeIsYJNS+UVUj26/D88krTnBhHyTCMjGJiGAQP3/1x3cg+KgyB12NTs3rvaznzvPDWnFi0Zts2YozE91j2t8t7srvC8lhWjVQzKSViDATvkUrVsm6Et2QlPqr6oPD55YXmdGaSiq7vuQyCixgRk6TtLpzbC70YP6h4JNmfHUrGaZKM01RJSunduWUcRFVXXFCU/08v7yXLeea5aei6Dv3tO+7HT/yXr8inJzqp6IWg7XuObUdfEoqBdhjohEBIWftrncN5fyWc15W3tkWpGd+2VxyP2L7HxoD1rsI4iwv+vneh+NHhY6i+LBVVQmMsk1k42pEpWIwPrN6jnWOLkeIEY0yF1oZVa1ZtkSYzrBkfdyUba1HzjFoW1Lpcp7sGZpOY1q1ekiahyl4nfEzkXPqaK7b0MOViCed8RRlQ7UXIuAg25B2o+Md8OJQJppzI7H+N/Dk+8V/pX+E6zMvC2/lcJ/Q3w36G251uGGrbfgEhukQ89N/sUgAAAABJRU5ErkJggg=='); background-size: cover; display: block;\"\n  ></span>\n  <img\n        class=\"gatsby-resp-image-image\"\n        alt=\"mongodb-5\"\n        title=\"\"\n        src=\"/static/7a7afdf2faffeb26bfe1b80c0e13a6f5/f058b/mongodb-5.png\"\n        srcset=\"/static/7a7afdf2faffeb26bfe1b80c0e13a6f5/c26ae/mongodb-5.png 158w,\n/static/7a7afdf2faffeb26bfe1b80c0e13a6f5/6bdcf/mongodb-5.png 315w,\n/static/7a7afdf2faffeb26bfe1b80c0e13a6f5/f058b/mongodb-5.png 630w,\n/static/7a7afdf2faffeb26bfe1b80c0e13a6f5/6c2f2/mongodb-5.png 767w\"\n        sizes=\"(max-width: 630px) 100vw, 630px\"\n        style=\"width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;\"\n        loading=\"lazy\"\n        decoding=\"async\"\n      />\n  </a>\n    </span></p>\n<p>위에 보이는 URI가 API에 사용될 예정이다 - <em>Node.js API를 개발하는 것이기 때문에 driver 옵션은 넘어가도 된다</em>. 이 전 단계에서 생성한 사용자 이름과 비밀번호를 위 사진 속 빨간색 빈 칸에 <em>[your username:your password]</em> 형태로 넣어야 한다. 필자와 함께 API를 개발하는 것이니 예시는 넘어가도 된다.</p>\n<h2>프로젝트 폴더 생성</h2>\n<p>새로운 프로젝트 폴더를 생성하고 터미널을 열어 아래와 같이 명령어를 입력한다. 해당 명령어를 입력하면 pacakge.json 파일이 생기는데 앱에 필요한 정보나 dependency들을 담고 있는 역할을 한다. 그리고 app.ts 파일을 만든다.</p>\n<div class=\"gatsby-highlight\" data-language=\"text\"><pre class=\"language-text\"><code class=\"language-text\">cd [project folder directory]\r\nnpm init -y</code></pre></div>\n<h2>Dependencies 설치</h2>\n<div class=\"gatsby-highlight\" data-language=\"js\"><pre class=\"language-js\"><code class=\"language-js\">npm install <span class=\"token operator\">-</span>g typescript\r\nnpm install express ts<span class=\"token operator\">-</span>node dotenv nodemon mongodb\r\nnpm install <span class=\"token operator\">--</span>save<span class=\"token operator\">-</span>dev cross<span class=\"token operator\">-</span>env @types<span class=\"token operator\">/</span>node @types<span class=\"token operator\">/</span>express</code></pre></div>\n<blockquote>\n<p><strong>Express</strong> <em>Node.js 웹 어플리케이션 프레임워크이며 가볍고 다양한 기능을 제공하며 특히 웹과 모바일 어플리케이션에 최적화되어 있다. Express가 API의 핵심 기능을 제공한다고 생각하면 된다.</em></p>\n<p><strong>Dotenv</strong> <em>.env 파일에 선언한 환경 변수들을 process.env라는 객체를 통해 접근할 수 있게 도와주는 라이브러리이다.</em></p>\n<p><strong>Nodemon</strong> <em>Node.js를 기반으로 하는 어플리케이션을 개발할 때 자주 쓰이며 코드를 수정할 시 자동으로 감지하여 어플리케이션을 재시작시켜준다. 배포에는 활용이 되지 않는다.</em></p>\n<p><strong>Typescript</strong> <em>Javascript에 추가적인 문법이 적용되어 에디터에서 재빠르게 에러를 찾아낼 수 있도록 도와준다.</em></p>\n<p><strong>Ts-node</strong> <em>Typescript가 적용된 스크립트가 실행되도록 Javascript로 변환해주는 역할을 한다.</em></p>\n<p><strong>MongoDB</strong> <em>Node.js 용 <a href=\"https://www.mongodb.com/\">MongoDB</a> 드라이버이다.</em></p>\n</blockquote>\n<h2>Typescript 설정</h2>\n<p>앞서 설명했듯이 Typescript는 타입 확인을 엄격하게 적용하여 에디터에서 쉽게 에러를 찾을 수 있도록 도와준다. 프로젝트 폴더 하위에 tsconfig.json이라는 파일을 만들고 아래 코드를 입력한다. 개발자의 원하는대로 <em>compilerOptions</em> 을 바꿔주면서 사용하면 된다. 이 설정에 관해서 자세한 설명은 생략하오니 더 많은 정보를 원한다면 <a href=\"https://www.typescriptlang.org/docs/handbook/tsconfig-json.html\">공식 웹사이트</a> 확인해주길 바란다.</p>\n<div class=\"gatsby-highlight\" data-language=\"js\"><pre class=\"language-js\"><code class=\"language-js\"><span class=\"token punctuation\">{</span>\r\n    <span class=\"token string-property property\">\"buildOnSave\"</span><span class=\"token operator\">:</span> <span class=\"token boolean\">false</span><span class=\"token punctuation\">,</span>\r\n    <span class=\"token string-property property\">\"compileOnSave\"</span><span class=\"token operator\">:</span> <span class=\"token boolean\">false</span><span class=\"token punctuation\">,</span>\r\n    <span class=\"token string-property property\">\"compilerOptions\"</span><span class=\"token operator\">:</span> <span class=\"token punctuation\">{</span>\r\n        <span class=\"token string-property property\">\"charset\"</span><span class=\"token operator\">:</span> <span class=\"token string\">\"utf8\"</span><span class=\"token punctuation\">,</span>\r\n        <span class=\"token string-property property\">\"module\"</span><span class=\"token operator\">:</span> <span class=\"token string\">\"commonjs\"</span><span class=\"token punctuation\">,</span>\r\n        <span class=\"token string-property property\">\"target\"</span><span class=\"token operator\">:</span> <span class=\"token string\">\"es2018\"</span><span class=\"token punctuation\">,</span>\r\n        <span class=\"token string-property property\">\"lib\"</span><span class=\"token operator\">:</span> <span class=\"token punctuation\">[</span>\r\n            <span class=\"token string\">\"es2018\"</span><span class=\"token punctuation\">,</span>\r\n            <span class=\"token string\">\"dom\"</span>\r\n        <span class=\"token punctuation\">]</span><span class=\"token punctuation\">,</span>\r\n        <span class=\"token string-property property\">\"noImplicitAny\"</span><span class=\"token operator\">:</span> <span class=\"token boolean\">true</span><span class=\"token punctuation\">,</span>\r\n        <span class=\"token string-property property\">\"removeComments\"</span><span class=\"token operator\">:</span> <span class=\"token boolean\">true</span><span class=\"token punctuation\">,</span>\r\n        <span class=\"token string-property property\">\"strictNullChecks\"</span><span class=\"token operator\">:</span> <span class=\"token boolean\">true</span><span class=\"token punctuation\">,</span>\r\n        <span class=\"token comment\">// \"noImplicitThis\": true,</span>\r\n        <span class=\"token string-property property\">\"noImplicitThis\"</span><span class=\"token operator\">:</span> <span class=\"token boolean\">false</span><span class=\"token punctuation\">,</span>\r\n        <span class=\"token string-property property\">\"alwaysStrict\"</span><span class=\"token operator\">:</span> <span class=\"token boolean\">true</span><span class=\"token punctuation\">,</span>\r\n        <span class=\"token string-property property\">\"preserveConstEnums\"</span><span class=\"token operator\">:</span> <span class=\"token boolean\">true</span><span class=\"token punctuation\">,</span>\r\n        <span class=\"token string-property property\">\"sourceMap\"</span><span class=\"token operator\">:</span> <span class=\"token boolean\">true</span><span class=\"token punctuation\">,</span>\r\n        <span class=\"token comment\">// \"esModuleInterop\": true,</span>\r\n        <span class=\"token string-property property\">\"esModuleInterop\"</span><span class=\"token operator\">:</span> <span class=\"token boolean\">true</span><span class=\"token punctuation\">,</span>\r\n        <span class=\"token string-property property\">\"noImplicitReturns\"</span><span class=\"token operator\">:</span> <span class=\"token boolean\">true</span><span class=\"token punctuation\">,</span>\r\n        <span class=\"token string-property property\">\"allowJs\"</span><span class=\"token operator\">:</span> <span class=\"token boolean\">true</span>\r\n    <span class=\"token punctuation\">}</span><span class=\"token punctuation\">,</span>\r\n    <span class=\"token string-property property\">\"include\"</span><span class=\"token operator\">:</span> <span class=\"token punctuation\">[</span>\r\n        <span class=\"token string\">\"src\"</span>\r\n    <span class=\"token punctuation\">]</span><span class=\"token punctuation\">,</span>\r\n    <span class=\"token string-property property\">\"exclude\"</span><span class=\"token operator\">:</span> <span class=\"token punctuation\">[</span><span class=\"token string\">\"node_modules\"</span><span class=\"token punctuation\">,</span> <span class=\"token string\">\"reference_deprecated\"</span><span class=\"token punctuation\">,</span> <span class=\"token string\">\"dist\"</span><span class=\"token punctuation\">,</span> <span class=\"token string\">\"scripts\"</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">,</span>\r\n    <span class=\"token string-property property\">\"typeRoots\"</span><span class=\"token operator\">:</span> <span class=\"token punctuation\">[</span>\r\n        <span class=\"token string\">\"node_modules/@types\"</span>\r\n    <span class=\"token punctuation\">]</span>\r\n<span class=\"token punctuation\">}</span></code></pre></div>\n<h2>package.json</h2>\n<p><span\n      class=\"gatsby-resp-image-wrapper\"\n      style=\"position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 587px; \"\n    >\n      <a\n    class=\"gatsby-resp-image-link\"\n    href=\"/static/f6a56c7b7eecf5b00c935aa498ef8b1f/d72eb/package-json.png\"\n    style=\"display: block\"\n    target=\"_blank\"\n    rel=\"noopener\"\n  >\n    <span\n    class=\"gatsby-resp-image-background-image\"\n    style=\"padding-bottom: 17.088607594936708%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAADCAYAAACTWi8uAAAACXBIWXMAAAsTAAALEwEAmpwYAAAAmUlEQVR42lWOSw7DIAxEcxLcBLDBQNOf1C57/0u9KmTVxWjk55HHS/HB8/2leWf3iqaVZhmLGzVHSo7UnOiWcUs0S5PHdSWEgITw50tW4/r4YKrc3bhW49kr771NvYbz2TuPg90691YYVdm9zJKqaRYeT8RtZWm14+NGTBlL21y4noFDoyi96DkXo2nCUpz8OCASuIggIgQRfm/hV3/PLoNZAAAAAElFTkSuQmCC'); background-size: cover; display: block;\"\n  ></span>\n  <img\n        class=\"gatsby-resp-image-image\"\n        alt=\"package-json\"\n        title=\"\"\n        src=\"/static/f6a56c7b7eecf5b00c935aa498ef8b1f/d72eb/package-json.png\"\n        srcset=\"/static/f6a56c7b7eecf5b00c935aa498ef8b1f/c26ae/package-json.png 158w,\n/static/f6a56c7b7eecf5b00c935aa498ef8b1f/6bdcf/package-json.png 315w,\n/static/f6a56c7b7eecf5b00c935aa498ef8b1f/d72eb/package-json.png 587w\"\n        sizes=\"(max-width: 587px) 100vw, 587px\"\n        style=\"width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;\"\n        loading=\"lazy\"\n        decoding=\"async\"\n      />\n  </a>\n    </span></p>\n<p>package.json 안에 script 필드 하위에 명령어 두개를 추가해보자. 복잡한 명령어를 key 이름에 저장한 후 간단하게 <em>npm run [key name]</em> 입력하는 방식으로 해당 명령어를 실행할 수 있다.</p>\n<p>“npm run dev”를 터미널에 입력하고 엔터를 누르면 실제로 <em>cross-env NODE-ENV=development nodemon --exec ts-node ./app.ts</em> 가 실행된다. 개발모드로 실행되고 nodemon이 코드 수정이 있을 시 자동으로 재시작한다. \"start\"는 배포 시 사용된다.</p>\n<h2>Express 서버</h2>\n<div class=\"gatsby-highlight\" data-language=\"js\"><pre class=\"language-js\"><code class=\"language-js\"><span class=\"token keyword\">import</span> express<span class=\"token punctuation\">,</span> <span class=\"token punctuation\">{</span> Request<span class=\"token punctuation\">,</span> Response<span class=\"token punctuation\">,</span> NextFunction <span class=\"token punctuation\">}</span> <span class=\"token keyword\">from</span> <span class=\"token string\">'express'</span><span class=\"token punctuation\">;</span>\r\n\r\n<span class=\"token keyword\">const</span> app <span class=\"token operator\">=</span> <span class=\"token function\">express</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\r\n\r\napp<span class=\"token punctuation\">.</span><span class=\"token function\">use</span><span class=\"token punctuation\">(</span>express<span class=\"token punctuation\">.</span><span class=\"token function\">urlencoded</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">{</span> <span class=\"token literal-property property\">extended</span><span class=\"token operator\">:</span> <span class=\"token boolean\">true</span> <span class=\"token punctuation\">}</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\r\napp<span class=\"token punctuation\">.</span><span class=\"token function\">use</span><span class=\"token punctuation\">(</span>express<span class=\"token punctuation\">.</span><span class=\"token function\">json</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\r\n<span class=\"token comment\">// to parse json of body object</span>\r\n\r\n<span class=\"token comment\">// get route -> path '/'</span>\r\napp<span class=\"token punctuation\">.</span><span class=\"token function\">get</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"/\"</span><span class=\"token punctuation\">,</span> <span class=\"token punctuation\">(</span>req<span class=\"token operator\">:</span> Request<span class=\"token punctuation\">,</span> <span class=\"token literal-property property\">res</span><span class=\"token operator\">:</span> Response<span class=\"token punctuation\">)</span><span class=\"token operator\">:</span> <span class=\"token parameter\"><span class=\"token keyword\">void</span></span> <span class=\"token operator\">=></span> <span class=\"token punctuation\">{</span>\r\n    res<span class=\"token punctuation\">.</span><span class=\"token function\">send</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"Here is the response\"</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\r\n<span class=\"token punctuation\">}</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\r\n\r\napp<span class=\"token punctuation\">.</span><span class=\"token function\">listen</span><span class=\"token punctuation\">(</span><span class=\"token number\">4000</span><span class=\"token punctuation\">,</span> <span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token operator\">=></span> <span class=\"token punctuation\">{</span>\r\n    console<span class=\"token punctuation\">.</span><span class=\"token function\">log</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"Server is running on 4000\"</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\r\n<span class=\"token punctuation\">}</span><span class=\"token punctuation\">)</span></code></pre></div>\n<p>위 코드를 app.ts 파일에 입력한 뒤 npm run dev를 터미널에 입력하여 서버를 시작한다. 터미널에 다음과 같이 로그가 뜬다:</p>\n<p><em>the server is listening to the port 4000</em>.</p>\n<p>각각의 라우트는 API를 사용하는 사람이 요청을 보낼 때 쓰이는 url이라고 보면 된다. 위의 코드에는 get 라우트 있는데 경로가 '/'이며 콜백 함수를 파라미터로 가지고 있다. 이 라우트에 요청을 보내게 되면 \"Here is the response\"라는 응답을 받게 된다. 브라우저를 열고 주소 창에 <a href=\"http://localhost:4000%EB%A5%BC\">http://localhost:4000를</a> 입력해보자 - <em>로컬 환경에서 개발하기 때문에 localhost에 접근할 수 있다</em>.</p>\n<p>콜백함수는 주로 2가지 객체를 인자 값으로 받는데 Request와 Response 객체이다.</p>\n<p>Request 객체는 API 사용자가로부터 서버가 받는 정보들의 집합이라고 생각하면 된다. API 개발자는 이 Request 객체가 어떤 필드 값을 가지고 있어야 하는지 목적과 방향에 맞게 사용할 수 있다. 사용자로부터 API 키 값을 필수적으로 받아야 하는 상황이 예가 될 수 있다.</p>\n<p>Response 객체는 API 사용자가 해당 API 라우트로부터 받는 정보이다. API 서버의 목적과 개발 방향에 따라 그 정보가 달라질 것이다.</p>\n<h2>환경 변수</h2>\n<p>환경 변수는 보통 영어는 대문자로 쓰는 것이 일반적이다.</p>\n<p>프로젝트 폴더 하위에 development.env와 production.env 파일을 만들고 아래와 같이 변수 이름들을 적어 준다.</p>\n<p>MongoDB로부터 얻은 uri를 <strong>MONGODB_URI</strong>로 설정한다.</p>\n<div class=\"gatsby-highlight\" data-language=\"js\"><pre class=\"language-js\"><code class=\"language-js\"><span class=\"token constant\">PORT</span><span class=\"token operator\">=</span><span class=\"token number\">4000</span>\r\n\r\n<span class=\"token constant\">MONGO_URI</span><span class=\"token operator\">=</span><span class=\"token punctuation\">[</span>your mongodb uri<span class=\"token punctuation\">]</span>\r\n<span class=\"token constant\">MONGO_DB</span><span class=\"token operator\">=</span>test<span class=\"token operator\">-</span>db <span class=\"token comment\">// just name whatever you want for development</span>\r\n<span class=\"token constant\">MONGO_COLLECTION</span><span class=\"token operator\">=</span>test<span class=\"token operator\">-</span>collection <span class=\"token comment\">// just name whatever you want for development</span></code></pre></div>\n<h2>환경 변수 지정</h2>\n<div class=\"gatsby-highlight\" data-language=\"js\"><pre class=\"language-js\"><code class=\"language-js\"><span class=\"token keyword\">const</span> dotenv <span class=\"token operator\">=</span> <span class=\"token function\">require</span><span class=\"token punctuation\">(</span><span class=\"token string\">'dotenv'</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\r\n<span class=\"token keyword\">let</span> envFound <span class=\"token operator\">=</span> dotenv<span class=\"token punctuation\">.</span><span class=\"token function\">config</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">{</span> <span class=\"token literal-property property\">path</span><span class=\"token operator\">:</span> <span class=\"token template-string\"><span class=\"token template-punctuation string\">`</span><span class=\"token interpolation\"><span class=\"token interpolation-punctuation punctuation\">${</span>process<span class=\"token punctuation\">.</span>env<span class=\"token punctuation\">.</span><span class=\"token constant\">NODE_ENV</span><span class=\"token interpolation-punctuation punctuation\">}</span></span><span class=\"token string\">.env</span><span class=\"token template-punctuation string\">`</span></span> <span class=\"token punctuation\">}</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\r\n\r\n<span class=\"token keyword\">if</span><span class=\"token punctuation\">(</span><span class=\"token operator\">!</span>envFound<span class=\"token punctuation\">)</span> <span class=\"token keyword\">throw</span> <span class=\"token keyword\">new</span> <span class=\"token class-name\">Error</span><span class=\"token punctuation\">(</span><span class=\"token string\">'Could not find any .env file.'</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\r\n\r\n<span class=\"token keyword\">let</span> config <span class=\"token operator\">=</span> <span class=\"token punctuation\">{</span>\r\n  <span class=\"token literal-property property\">port</span><span class=\"token operator\">:</span> <span class=\"token function\">parseInt</span><span class=\"token punctuation\">(</span>process<span class=\"token punctuation\">.</span>env<span class=\"token punctuation\">.</span><span class=\"token constant\">PORT</span><span class=\"token operator\">!</span><span class=\"token punctuation\">,</span> <span class=\"token number\">10</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">,</span>\r\n  <span class=\"token literal-property property\">mongodb</span><span class=\"token operator\">:</span> <span class=\"token punctuation\">{</span>\r\n    <span class=\"token literal-property property\">uri</span><span class=\"token operator\">:</span> process<span class=\"token punctuation\">.</span>env<span class=\"token punctuation\">.</span><span class=\"token constant\">MONGO_URI</span><span class=\"token punctuation\">,</span>\r\n    <span class=\"token literal-property property\">db</span><span class=\"token operator\">:</span> process<span class=\"token punctuation\">.</span>env<span class=\"token punctuation\">.</span><span class=\"token constant\">MONGO_DB</span><span class=\"token punctuation\">,</span>\r\n    <span class=\"token literal-property property\">collection</span><span class=\"token operator\">:</span> process<span class=\"token punctuation\">.</span>env<span class=\"token punctuation\">.</span><span class=\"token constant\">MONGO_COLLECTION</span><span class=\"token punctuation\">,</span>\r\n  <span class=\"token punctuation\">}</span>\r\n<span class=\"token punctuation\">}</span><span class=\"token punctuation\">;</span>\r\n\r\n<span class=\"token keyword\">export</span> <span class=\"token keyword\">default</span> config<span class=\"token punctuation\">;</span></code></pre></div>\n<p>어플리케이션을 개발할 때 배포 전에 무수히 많은 테스트를 거치는 것이 일반적이다. 이 때문에 개발 설정과 배포 설정을 나누는 것은 굉장히 중요하다.</p>\n<p>cross-env는 환경에 따른 설정을 다르게 적용할 수 있게 도와주는 라이브러리인데 “cross-env NODE_ENV=production” 처럼 입력할 명령어 앞에 두어 어떤 환경인지 명시해 준다. 이 덕분에 다른 .env 파일을 환경에 맞게 설정해주기 때문에 같은 코드를 두번 작성할 필요가 없다.</p>\n<p>config.ts 하위에 파일을 만든 뒤 dotenv를 import한다. 이 dotenv가 <strong>[process.env.NODE_ENV].env</strong> 파일에 담긴 정보를 읽어 오는 역할을 한다. 이 때 NODE_ENV는 명령어에서 명시해 줬던 development 혹은 production이 되겠다.</p>\n<p>위 코드 안에 모든 환경 변수 앞에 process.env가 붙어 있다. Node.js에 전역에서 접근할 수 있는 객체이기 때문에 어플리케이션 전체에서 사용될 수 있다.</p>\n<h2>어플리케이션에 MongoDB 연결</h2>\n<div class=\"gatsby-highlight\" data-language=\"js\"><pre class=\"language-js\"><code class=\"language-js\"><span class=\"token keyword\">import</span> config <span class=\"token keyword\">from</span> <span class=\"token string\">'./config'</span><span class=\"token punctuation\">;</span>\r\n<span class=\"token keyword\">const</span> <span class=\"token punctuation\">{</span> MongoClient <span class=\"token punctuation\">}</span> <span class=\"token operator\">=</span> <span class=\"token function\">require</span><span class=\"token punctuation\">(</span><span class=\"token string\">'mongodb'</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\r\n\r\n<span class=\"token keyword\">const</span> <span class=\"token function-variable function\">connectMongoDB</span><span class=\"token operator\">:</span> <span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token operator\">=></span> Promise<span class=\"token operator\">&lt;</span>any<span class=\"token operator\">></span> <span class=\"token operator\">=</span> <span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token operator\">=></span> <span class=\"token punctuation\">{</span>\r\n  <span class=\"token keyword\">return</span> <span class=\"token keyword\">new</span> <span class=\"token class-name\">Promise</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">(</span><span class=\"token parameter\">resolve<span class=\"token punctuation\">,</span> reject</span><span class=\"token punctuation\">)</span> <span class=\"token operator\">=></span> <span class=\"token punctuation\">{</span>\r\n    MongoClient<span class=\"token punctuation\">.</span><span class=\"token function\">connect</span><span class=\"token punctuation\">(</span>\r\n      config<span class=\"token punctuation\">.</span>mongodb<span class=\"token punctuation\">.</span>uri<span class=\"token punctuation\">,</span>\r\n      <span class=\"token punctuation\">{</span>\r\n        <span class=\"token literal-property property\">useUnifiedTopology</span><span class=\"token operator\">:</span> <span class=\"token boolean\">true</span><span class=\"token punctuation\">,</span>\r\n        <span class=\"token literal-property property\">useNewUrlParser</span><span class=\"token operator\">:</span> <span class=\"token boolean\">true</span><span class=\"token punctuation\">,</span>\r\n      <span class=\"token punctuation\">}</span><span class=\"token punctuation\">,</span>\r\n      <span class=\"token punctuation\">(</span><span class=\"token parameter\"><span class=\"token literal-property property\">err</span><span class=\"token operator\">:</span> Error<span class=\"token punctuation\">,</span> <span class=\"token literal-property property\">client</span><span class=\"token operator\">:</span> object</span><span class=\"token punctuation\">)</span> <span class=\"token operator\">=></span> <span class=\"token punctuation\">{</span>\r\n        <span class=\"token keyword\">if</span><span class=\"token punctuation\">(</span>err<span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\r\n          <span class=\"token function\">reject</span><span class=\"token punctuation\">(</span>err<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\r\n          <span class=\"token keyword\">return</span><span class=\"token punctuation\">;</span>\r\n        <span class=\"token punctuation\">}</span>\r\n    \r\n        <span class=\"token function\">resolve</span><span class=\"token punctuation\">(</span>client<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\r\n      <span class=\"token punctuation\">}</span>\r\n    <span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\r\n  <span class=\"token punctuation\">}</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\r\n<span class=\"token punctuation\">}</span><span class=\"token punctuation\">;</span>\r\n\r\n<span class=\"token keyword\">export</span> <span class=\"token keyword\">default</span> connectMongoDB<span class=\"token punctuation\">;</span></code></pre></div>\n<p>프로젝트 폴더 하위에 파일 db.ts를 만든 뒤, MongoClient를 import한다. 그리고 파일 config.ts 만든 뒤 <em>config.mongodb.uri</em> 을 인자 값으로 입력한다. 이 uri는 MongoDB 설정 시 얻었던 uri이다.</p>\n<p>마지막으로 MongoDB를 비동기적으로 연결하도록 promise를 반환 값으로 받게 한다. 이제 API에 테스트 요청을 위해 코드를 수정해보자.</p>\n<h2>테스트 사용자 DB 등록</h2>\n<div class=\"gatsby-highlight\" data-language=\"js\"><pre class=\"language-js\"><code class=\"language-js\"><span class=\"token keyword\">import</span> express<span class=\"token punctuation\">,</span> <span class=\"token punctuation\">{</span> Request<span class=\"token punctuation\">,</span> Response<span class=\"token punctuation\">,</span> NextFunction <span class=\"token punctuation\">}</span> <span class=\"token keyword\">from</span> <span class=\"token string\">\"express\"</span><span class=\"token punctuation\">;</span>\r\n<span class=\"token keyword\">import</span> config <span class=\"token keyword\">from</span> <span class=\"token string\">\"./config\"</span><span class=\"token punctuation\">;</span>\r\n<span class=\"token keyword\">import</span> connectMongoDB <span class=\"token keyword\">from</span> <span class=\"token string\">\"./db\"</span><span class=\"token punctuation\">;</span>\r\n\r\n<span class=\"token keyword\">const</span> app <span class=\"token operator\">=</span> <span class=\"token function\">express</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\r\n\r\napp<span class=\"token punctuation\">.</span><span class=\"token function\">use</span><span class=\"token punctuation\">(</span>express<span class=\"token punctuation\">.</span><span class=\"token function\">urlencoded</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">{</span> <span class=\"token literal-property property\">extended</span><span class=\"token operator\">:</span> <span class=\"token boolean\">true</span> <span class=\"token punctuation\">}</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\r\napp<span class=\"token punctuation\">.</span><span class=\"token function\">use</span><span class=\"token punctuation\">(</span>express<span class=\"token punctuation\">.</span><span class=\"token function\">json</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\r\n\r\napp<span class=\"token punctuation\">.</span><span class=\"token function\">get</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"/\"</span><span class=\"token punctuation\">,</span> <span class=\"token punctuation\">(</span>req<span class=\"token operator\">:</span> Request<span class=\"token punctuation\">,</span> <span class=\"token literal-property property\">res</span><span class=\"token operator\">:</span> Response<span class=\"token punctuation\">)</span><span class=\"token operator\">:</span> <span class=\"token parameter\"><span class=\"token keyword\">void</span></span> <span class=\"token operator\">=></span> <span class=\"token punctuation\">{</span>\r\n    res<span class=\"token punctuation\">.</span><span class=\"token function\">send</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"Here is the response\"</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\r\n<span class=\"token punctuation\">}</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\r\n\r\napp<span class=\"token punctuation\">.</span><span class=\"token function\">post</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"/\"</span><span class=\"token punctuation\">,</span> <span class=\"token keyword\">async</span> <span class=\"token punctuation\">(</span>req<span class=\"token operator\">:</span> Request<span class=\"token punctuation\">,</span> <span class=\"token literal-property property\">res</span><span class=\"token operator\">:</span> Response<span class=\"token punctuation\">)</span><span class=\"token operator\">:</span> Promise<span class=\"token operator\">&lt;</span><span class=\"token keyword\">void</span><span class=\"token operator\">></span> <span class=\"token operator\">=></span> <span class=\"token punctuation\">{</span>\r\n  <span class=\"token keyword\">try</span> <span class=\"token punctuation\">{</span>\r\n    <span class=\"token keyword\">const</span> firstName <span class=\"token operator\">=</span> req<span class=\"token punctuation\">.</span>body<span class=\"token punctuation\">.</span>firstName<span class=\"token punctuation\">;</span>\r\n    <span class=\"token keyword\">const</span> lastName <span class=\"token operator\">=</span> req<span class=\"token punctuation\">.</span>body<span class=\"token punctuation\">.</span>lastName<span class=\"token punctuation\">;</span>\r\n\r\n    <span class=\"token keyword\">const</span> client <span class=\"token operator\">=</span> <span class=\"token keyword\">await</span> <span class=\"token function\">connectMongoDB</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\r\n    <span class=\"token keyword\">const</span> db <span class=\"token operator\">=</span> <span class=\"token keyword\">await</span> client<span class=\"token punctuation\">.</span><span class=\"token function\">db</span><span class=\"token punctuation\">(</span>config<span class=\"token punctuation\">.</span>mongodb<span class=\"token punctuation\">.</span>db<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\r\n    <span class=\"token keyword\">const</span> collection <span class=\"token operator\">=</span> <span class=\"token keyword\">await</span> db<span class=\"token punctuation\">.</span><span class=\"token function\">collection</span><span class=\"token punctuation\">(</span>config<span class=\"token punctuation\">.</span>mongodb<span class=\"token punctuation\">.</span>collection<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\r\n\r\n    <span class=\"token keyword\">await</span> collection<span class=\"token punctuation\">.</span><span class=\"token function\">insertOne</span><span class=\"token punctuation\">(</span>\r\n       <span class=\"token punctuation\">{</span>\r\n        <span class=\"token literal-property property\">firstName</span><span class=\"token operator\">:</span> firstName<span class=\"token punctuation\">,</span>\r\n        <span class=\"token literal-property property\">lastName</span><span class=\"token operator\">:</span> lastName\r\n       <span class=\"token punctuation\">}</span>\r\n    <span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\r\n  \r\n    res<span class=\"token punctuation\">.</span><span class=\"token function\">status</span><span class=\"token punctuation\">(</span><span class=\"token number\">200</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">.</span><span class=\"token function\">send</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"Successfully Created in DB\"</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\r\n  <span class=\"token punctuation\">}</span>\r\n  <span class=\"token keyword\">catch</span><span class=\"token punctuation\">(</span>err<span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\r\n    res<span class=\"token punctuation\">.</span><span class=\"token function\">status</span><span class=\"token punctuation\">(</span><span class=\"token number\">500</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">.</span><span class=\"token function\">send</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"Error Occured in Server\"</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\r\n    console<span class=\"token punctuation\">.</span><span class=\"token function\">log</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"&lt;POST> '/' error occured\"</span><span class=\"token punctuation\">,</span> err<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\r\n  <span class=\"token punctuation\">}</span>\r\n<span class=\"token punctuation\">}</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\r\n\r\napp<span class=\"token punctuation\">.</span><span class=\"token function\">listen</span><span class=\"token punctuation\">(</span>config<span class=\"token punctuation\">.</span>port<span class=\"token punctuation\">,</span> <span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token operator\">=></span> <span class=\"token punctuation\">{</span>\r\n  console<span class=\"token punctuation\">.</span><span class=\"token function\">log</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"Server is running on\"</span><span class=\"token punctuation\">,</span> config<span class=\"token punctuation\">.</span>port<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\r\n<span class=\"token punctuation\">}</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></code></pre></div>\n<p>post 라우트를 추가한다. 이 라우트는 API 사용자로부터 성과 이름을 받고 이를 데이터베이스에 넣는 기능이 목적이다. Request 객체의 body라는 필드에 사용자가 입력한 성과 이름이 저장이 된다.</p>\n<p>MongoDB promise가 resolve한 값을 connect라는 변수를 선언하여 저장한다 - <em>config.ts에 저장한 데이터베이스와 콜렉션 이름이 여기 쓰인다</em> - 요청에서 받은 성과 이름을 <em>insertOne</em> 이라는 함수로 데이터베이스에 입력하게 된다.</p>\n<p>에러 없이 코드가 실행된다면 post 라우트가 status 코드 200과 함께 \"Successfully Created in DB\"라는 정보를 사용자에게 보낸다.</p>\n<h2>Insomnia 요청 테스트</h2>\n<p><span\n      class=\"gatsby-resp-image-wrapper\"\n      style=\"position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 548px; \"\n    >\n      <a\n    class=\"gatsby-resp-image-link\"\n    href=\"/static/21f9724b06b007f1b24f728d04bfc897/a58fe/insomnia-1.png\"\n    style=\"display: block\"\n    target=\"_blank\"\n    rel=\"noopener\"\n  >\n    <span\n    class=\"gatsby-resp-image-background-image\"\n    style=\"padding-bottom: 77.21518987341771%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAPCAYAAADkmO9VAAAACXBIWXMAAAsTAAALEwEAmpwYAAACN0lEQVR42qWTS28SURiG55dwkctwmYEZnGlSmoIF9i5csQIS2LDgD/g/5FYgmhjDD2jVhUIMuse4kQVgpCQ2dEbKNYH6mu/UIWBtrHGSJ9/M4nvOd855hzv/MoV2oWG5WGIxm2M2neF/Hu5F5QS10nOUy0UU8gWUSiUUi0Xkn+RRrVRxfFxGoVBApVJFrVZDtXpdb4N7pD7GA/UhXB4HeN4Ft9sNURThdnuwp6gIyDLsdjvMZjMsFstf4faDewiHQjgKHyEY3IfPJ0KSJEQjESjKfQiCAKfDAcct0GLbcJJfAuHz+Rgk8Pv9DBILogg7NRpsNZOQ5/kdOGo0RLRVqrIkMyFNGT44gCLLUAMBKJIERVGgqCpUVYUsy3C5ro/JgPN6vSBIRFUURDh5HqHDQ7x7+gyfXr1G++QU7dOX6Lx5i977D/jc6WAwGKBer8NqtcLj8TAZyTkSGTJjSho9Fo1i2P6I1bdzLM6GmA/O2Dsmk01EWq0WuyzqvTGhgSGMRCL4Ohzi+2SCka5DG4+hX15iDWC1WjFho9G4KTQmNCCh0+lENBpFv9eDpmnQNQ0XoxGWiwV+XF1thM1m8x+F/T7GNJmus0ry+XyO9Xq9EVL27iSMxWLodruYTqcMEuHXdun7zlsm6NYoEolEAul0GslkkpFKpZDJZJDNZpHL5RCPx9l578Tmd9l2hGw2G4O2RZOYTCZYrfc2f4iLd7HFt7P4xwm3I0ShNxJAzRR4CjUFnKooCDvCn6yHiyWjnxLUAAAAAElFTkSuQmCC'); background-size: cover; display: block;\"\n  ></span>\n  <img\n        class=\"gatsby-resp-image-image\"\n        alt=\"insomnia-1\"\n        title=\"\"\n        src=\"/static/21f9724b06b007f1b24f728d04bfc897/a58fe/insomnia-1.png\"\n        srcset=\"/static/21f9724b06b007f1b24f728d04bfc897/c26ae/insomnia-1.png 158w,\n/static/21f9724b06b007f1b24f728d04bfc897/6bdcf/insomnia-1.png 315w,\n/static/21f9724b06b007f1b24f728d04bfc897/a58fe/insomnia-1.png 548w\"\n        sizes=\"(max-width: 548px) 100vw, 548px\"\n        style=\"width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;\"\n        loading=\"lazy\"\n        decoding=\"async\"\n      />\n  </a>\n    </span></p>\n<p>Insomnia는 오픈 소스 API 클라이언트인데 쉽게 말해서 API를 개발할 때 기능을 확인하는 데 유용한 도구이다. Insomnia를 통해 지금까지 개발한 API의 post 라우트에 요청을 해보자. Insomnia를 다운로드 받았다면 실행한 뒤 위 그림처럼 HTTP Request를 누른다.</p>\n<p><span\n      class=\"gatsby-resp-image-wrapper\"\n      style=\"position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 475px; \"\n    >\n      <a\n    class=\"gatsby-resp-image-link\"\n    href=\"/static/d0c4c2e2644da1b0f59ab116f99b73ec/466da/insomnia-2.png\"\n    style=\"display: block\"\n    target=\"_blank\"\n    rel=\"noopener\"\n  >\n    <span\n    class=\"gatsby-resp-image-background-image\"\n    style=\"padding-bottom: 46.202531645569614%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAJCAYAAAAywQxIAAAACXBIWXMAAAsTAAALEwEAmpwYAAABTUlEQVR42pVRO04DMRDdU1AA2mwIydoe25v9KGxC2E+IhGgQDR0VJVI4ADUFB+ACNNyFa1Bzh4fGK0OCQiSKp5nxjN/4PQfS9iH0EcZ2jHIyQZqmyMYppuUUeZYjDENEUeQio9fruTqK+tg/2MPD7Rtenz/x8viBp9U7AqkkiBSklCBFMFqDVFdrIhfjOIbRBtZaaK0hhICUCqPREO3pDa4vVrha3uOyvUNgbYKiKKCUhBASeZ67i3wpTTPXY9JZOUNTNyjyHESELMuQJAmOhxH6g0OHwTBEoJQCQ2sDY4wbZoLf8HMdaO2coMnAaOtiwFvYq6aucTafo64qJ7mTJSHi2L1keb5EWzVYtAuUJ+VPXwiniJUl1rLkzhf2i0i7fP1FPncz7C/RxrnP/YKAf9WT+rhNLtuxy5JvQv5BLtaxbXhXf4Pwr+Z/F3jCL3hSFNfCwZshAAAAAElFTkSuQmCC'); background-size: cover; display: block;\"\n  ></span>\n  <img\n        class=\"gatsby-resp-image-image\"\n        alt=\"insomnia-1\"\n        title=\"\"\n        src=\"/static/d0c4c2e2644da1b0f59ab116f99b73ec/466da/insomnia-2.png\"\n        srcset=\"/static/d0c4c2e2644da1b0f59ab116f99b73ec/c26ae/insomnia-2.png 158w,\n/static/d0c4c2e2644da1b0f59ab116f99b73ec/6bdcf/insomnia-2.png 315w,\n/static/d0c4c2e2644da1b0f59ab116f99b73ec/466da/insomnia-2.png 475w\"\n        sizes=\"(max-width: 475px) 100vw, 475px\"\n        style=\"width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;\"\n        loading=\"lazy\"\n        decoding=\"async\"\n      />\n  </a>\n    </span></p>\n<p>헤더 안에 Content-Type을 application/json으로 설정하여 body 객체에 접근하게 한다.</p>\n<p><span\n      class=\"gatsby-resp-image-wrapper\"\n      style=\"position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 474px; \"\n    >\n      <a\n    class=\"gatsby-resp-image-link\"\n    href=\"/static/99d9d57ec0466b20709cd661b263fc9b/5595f/insomnia-3.png\"\n    style=\"display: block\"\n    target=\"_blank\"\n    rel=\"noopener\"\n  >\n    <span\n    class=\"gatsby-resp-image-background-image\"\n    style=\"padding-bottom: 32.911392405063296%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAHCAYAAAAIy204AAAACXBIWXMAAAsTAAALEwEAmpwYAAABMklEQVR42pWQPU4DMRCF9xxIRGR/bK/t9f5ls2RJooQmEiUFKVLSRJSEA3CAHCASHVdCHICTfMiLEgpoUnya5xnpzRsH0ibkZcVoNKIoCsqypK5ruq4jSRKGwyFhGP4himIuBxds128cXr/Yv3yw330SFCKiUSnjqsJYS5ZlOOd64ziOiaKor0cjv+SnH3M1HHC/2vH8+M7T5sB2fSB4WN6yyQvmQuJGNVVZopREa03btr35UXt8eqXU6SIhY+IkJBERQkQES5dz53JqkaJSi0ktUqYopXEuwxjTG/rkHq/TNMVae5r5arTXhkBqjbKGcqK5XhiaqaVtLTddhhCyT+sTSSl7vP7vfSTInaOqSibznPmqYDwtWC4qZrMCrW2f5BwC/0dN02CNxWh/xi9Zdr7hN3Ol28m4u97JAAAAAElFTkSuQmCC'); background-size: cover; display: block;\"\n  ></span>\n  <img\n        class=\"gatsby-resp-image-image\"\n        alt=\"insomnia-1\"\n        title=\"\"\n        src=\"/static/99d9d57ec0466b20709cd661b263fc9b/5595f/insomnia-3.png\"\n        srcset=\"/static/99d9d57ec0466b20709cd661b263fc9b/c26ae/insomnia-3.png 158w,\n/static/99d9d57ec0466b20709cd661b263fc9b/6bdcf/insomnia-3.png 315w,\n/static/99d9d57ec0466b20709cd661b263fc9b/5595f/insomnia-3.png 474w\"\n        sizes=\"(max-width: 474px) 100vw, 474px\"\n        style=\"width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;\"\n        loading=\"lazy\"\n        decoding=\"async\"\n      />\n  </a>\n    </span></p>\n<p>타입을 JSON으로 두고 firstname, lastname이라는 필드를 가진 객체 형식으로 입력한 뒤 Send 버튼을 누른다.</p>\n<p><span\n      class=\"gatsby-resp-image-wrapper\"\n      style=\"position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 364px; \"\n    >\n      <a\n    class=\"gatsby-resp-image-link\"\n    href=\"/static/7297d056ce9e0ca2da867cc47b51918b/e45a9/insomnia-4.png\"\n    style=\"display: block\"\n    target=\"_blank\"\n    rel=\"noopener\"\n  >\n    <span\n    class=\"gatsby-resp-image-background-image\"\n    style=\"padding-bottom: 31.645569620253163%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAGCAYAAADDl76dAAAACXBIWXMAAAsTAAALEwEAmpwYAAABQUlEQVR42o2Oy2rCUBRF8yk+UmPzvkZ8pCbRoBbUfktHjkon/YFOOnDUQX+kgoiiDgUfn2BABQcOV8kthU4KvbBh7c25+xyl5N/w/N7j5eOB4SiiVC/i1xrEcQvLshBC0O10KQlBNpsln8+Ty+X+lOLWVIZv9zyNBjy+BoiqJgubzSamaeA4Lu12RxZmMhlZ+rv4x6ecZoqum9imwDIcdM2iWLylULhB13Vs25YyDANVVTFNU15sWxaapqHrBsJ1Ea6Q82mmVKpV+r0eg36fVqtJuezheR5RFBHHMY3GHfVaHcdxqFSqRGGI7/tykeeVCYKAMAjlnzRTFosF0+mU2WzGZDJhPp+zXC6lT7Varfgcj1mv1+z3ezabDdvtVvJut5M+VcppplyvV06nE+fzmSRJJF8uF5LDgePx+M1Jwn/fF+z3ExSitnwvAAAAAElFTkSuQmCC'); background-size: cover; display: block;\"\n  ></span>\n  <img\n        class=\"gatsby-resp-image-image\"\n        alt=\"insomnia-1\"\n        title=\"\"\n        src=\"/static/7297d056ce9e0ca2da867cc47b51918b/e45a9/insomnia-4.png\"\n        srcset=\"/static/7297d056ce9e0ca2da867cc47b51918b/c26ae/insomnia-4.png 158w,\n/static/7297d056ce9e0ca2da867cc47b51918b/6bdcf/insomnia-4.png 315w,\n/static/7297d056ce9e0ca2da867cc47b51918b/e45a9/insomnia-4.png 364w\"\n        sizes=\"(max-width: 364px) 100vw, 364px\"\n        style=\"width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;\"\n        loading=\"lazy\"\n        decoding=\"async\"\n      />\n  </a>\n    </span></p>\n<p>MongoDB에 정보가 입력되었다면 다음과 같이 나타난다:</p>\n<p><span\n      class=\"gatsby-resp-image-wrapper\"\n      style=\"position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 630px; \"\n    >\n      <a\n    class=\"gatsby-resp-image-link\"\n    href=\"/static/2e3f18a7711812153d456cc8711d9d52/d67fd/result.png\"\n    style=\"display: block\"\n    target=\"_blank\"\n    rel=\"noopener\"\n  >\n    <span\n    class=\"gatsby-resp-image-background-image\"\n    style=\"padding-bottom: 56.9620253164557%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAALCAYAAAB/Ca1DAAAACXBIWXMAAAsTAAALEwEAmpwYAAABVUlEQVR42p2Sh26TMRCA/f6PB1RAA0ilWW3Tf3j7PD5kk1QRgiD1pE++Yd+wrYy1fN585+7+G3f3G378fOTT181gd3yitUbOGREhxkSplZwLKckgxkithYsoKZnJmRHUxowNkjPWOZZ1RWvNojWr1vgQcM4zzQurNoQYmeYZYywxJaQWVMiJU9DU1jDO4byntoq2dth97VjvaLRRaF7Xkax33/f3eC/qJKJyySMQJdG7TSUPPWUZSJHf/iwEiWffxU5v9sWnXqdXdvs9SRIxxUESGWP/Sf6P3VHHpyPb7RbbR9N60HXv/btQl9F8DIRzh113wePfgVqtYTEa7Qwvy8zD4UAQIdVCKtfkt3u9xXiUUgq5FFoWSnC0FMZar0mBWgq11puo/sJddsdnvnz8wLzf4qcTrCdYXs48g5nh6gP/S1TP2qX/o4f9gdUnwvlc+xut3eQXOORYZKHhD2oAAAAASUVORK5CYII='); background-size: cover; display: block;\"\n  ></span>\n  <img\n        class=\"gatsby-resp-image-image\"\n        alt=\"result\"\n        title=\"\"\n        src=\"/static/2e3f18a7711812153d456cc8711d9d52/f058b/result.png\"\n        srcset=\"/static/2e3f18a7711812153d456cc8711d9d52/c26ae/result.png 158w,\n/static/2e3f18a7711812153d456cc8711d9d52/6bdcf/result.png 315w,\n/static/2e3f18a7711812153d456cc8711d9d52/f058b/result.png 630w,\n/static/2e3f18a7711812153d456cc8711d9d52/d67fd/result.png 670w\"\n        sizes=\"(max-width: 630px) 100vw, 630px\"\n        style=\"width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;\"\n        loading=\"lazy\"\n        decoding=\"async\"\n      />\n  </a>\n    </span></p>\n<h2>결론</h2>\n<p>API 서버는 보통 개발자 자신 혹은 회사의 목적에 따라 더욱 커지거나 복잡해진다. 크고 복잡한 API 서버를 개발하는 실력을 키우려면 직접 더 많은 크고 작은 프로젝트들을 개발해보는 방법이 가장 도움이 될 가능성이 높다. 예를 들면, 더 많은 라우트를 추가하거나 더 많은 타입 정의들을 써보거나 다른 데이터베이스를 써보는 것이라고 생각한다. 이 간단한 API로부터 더 멋진 API를 개발하기를 바라면서 마친다.</p>\n<p><em><strong>읽어 주셔서 감사합니다. To be continued!</strong></em></p>\n<p><em>이 글은 <a href=\"https://medium.com/@shkim04/node-js-how-to-create-a-simple-rest-api-with-express-mongodb-and-typescript-54b1d801d073\">Medium</a>에도 업로드 되었습니다.</em>\r\n<em>놀러 오세요!</em></p>","frontmatter":{"title":"Express, MongoDB, Typescript로 REST API 개발하기","date":"2022년 12월 01일","description":"REST API - MongoDB 설정부터 간단한 CRUD 테스트까지 Node.js 프레임워크인 Express와 Typescript로 개발","tag":["NodeJS"]},"fields":{"locale":"ko"}},"previous":{"fields":{"slug":"/react-swiper-사용법"},"frontmatter":{"title":"React Swiper 사용법"}},"next":{"fields":{"slug":"/react-swiper-사용법"},"frontmatter":{"title":"React Swiper 사용법"}}},"pageContext":{"locale":"ko","isDefaultLang":true,"slug":"/express-mongodb-typescript로-restapi-개발하기","titleByLang":{"ko":"express-mongodb-typescript로-restapi-개발하기","en":"restapi-with-express-mongodb-typescript"},"dateFormat":"YYYY년 MM월 DD일","id":"f93df7fa-d3c1-58f1-9e15-32aa9e6bc021"}},"staticQueryHashes":[],"slicesMap":{}}