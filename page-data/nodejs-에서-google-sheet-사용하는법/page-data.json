{"componentChunkName":"component---src-templates-blog-post-js","path":"/nodejs-에서-google-sheet-사용하는법/","result":{"data":{"site":{"siteMetadata":{"title":"Seunghyun's Blog"}},"markdownRemark":{"id":"6ddf6df9-7b6a-55c3-88b5-726e9aaa6b29","excerpt":"Google Sheet는 브라우저에서 동작하기 때문에 어디서나 사용할 수 있고 기능이 다양해서 아주 유용한 소프트웨어 상품이다. 이 Google Sheet는 Google이 API를 제공하기 때문에 어느 어플리케이션이라도 쉽게 연결할 수 있다. Google Sheet API…","html":"<p><strong>Google Sheet</strong>는 브라우저에서 동작하기 때문에 어디서나 사용할 수 있고 기능이 다양해서 아주 유용한 소프트웨어 상품이다. 이 Google Sheet는 Google이 API를 제공하기 때문에 어느 어플리케이션이라도 쉽게 연결할 수 있다. <strong>Google Sheet API</strong>를 통해서 google sheet에서 입력한 정보를 읽고 가공하는 것이 가능하다.</p>\n<p>Google Sheet API를 사용하려면 먼저 가상의 사용자 계정을 만들어야 한다. 이 단계부터 시작해보자.</p>\n<h2>필수</h2>\n<ul>\n<li>google cloud 계정 — <em>검색하면 쉽게 나온다. 결제 정보를 입력해야 하니 참고바란다</em></li>\n<li>google sheet - <em>구글 계정이 있다면 누구나 만들 수 있다</em></li>\n<li>Node</li>\n</ul>\n<h2>Service 계정</h2>\n<p>google cloud에 로그인한 후 <strong>Google Cloud IAM and admin</strong>으로 이동한다. Service 계정이 글머리에서 언급한 가상의 사용자이다. 아래 빨간색으로 표시된 <strong>Service accounts</strong> 클릭한다.</p>\n<p><span\n      class=\"gatsby-resp-image-wrapper\"\n      style=\"position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 386px; \"\n    >\n      <a\n    class=\"gatsby-resp-image-link\"\n    href=\"/static/f95711c1640409667128513600121e18/7bc0b/iam-admin.png\"\n    style=\"display: block\"\n    target=\"_blank\"\n    rel=\"noopener\"\n  >\n    <span\n    class=\"gatsby-resp-image-background-image\"\n    style=\"padding-bottom: 108.86075949367088%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAWCAYAAADAQbwGAAAACXBIWXMAAAsTAAALEwEAmpwYAAAD30lEQVR42m2UWW/bRhSF+Q+bFkULFG0dNHGSBmiTOEizoA9t3vp7+pCHAk7s2FFcOV5kWbvERSS1kpYpbhKXr5iRmbixBzgYzfDOmTP33iNl/anF+m8WNx9bPPhjwIM/Bzx8OeDeC5u7L2x+emLx3S997v9us7Zhyr27zy3Wn4kzJj88NPnqjsGX6ysoa48Mbm70+fZ+l7vPDR6+FIcN1h7r3HlmsPZI45ufu9zcUPn+1x63n2isbaisP9X58ZHG1/e63LjV4YtbHW7c7qC8+qfG36+OOa667JT67JRMSvsDSmWL3T2TUtnm4MThoOJweOKwfzTloDKl9K/Nuz2To6rD8anLUdWV35T98nu2tzeJo5DKwT71kyN67Qanx4fUKh9oNxss4ohi5HlOlmU0ayc0Tqsf99M0p9X2UeI4Jo4j0jSTgWJOLpBm+WqdpBKLRYLvB6RpKmOz/ALyXCqhTNyEiZviBSljZ4nnZ8yDq/AjmLo+hmGQZaDpAc32nE7XR9VD4jiVShXNXNDTY5xZSkuNmM0zvCD/DBleCPZwRrVax3EWWFaAbvgYfZ++6TMchcRRghLFMVEUs0wyfN9n7of4QYTvryDW3jwgzcA9O6fZbF7kMiuyyqeRo0wmE6bTKSKXtVqNbrcrn9Xr9Wg2GqiqKkmSJMHzPFqtlszZm81N3m6/ZWd7l63Xr9l6/YbDg0MUESiSKaonfotgMRcovolxfv5J4XQyYTQcMR6PsS2b4WAg95TZbCYDC4WaptFut6nX63Q6LVS1I7vgc0Kr36fXVTF1HVM30XoqlmmiyPJnq3yIuegzkaMoThmNRY7TK4TkuYyVuOhPAeXs7Iz5fE4URVQqFamwVqvTap2yVx7x8q8u5Q8zyTGbXS4K1w7lkgUkCpUCUZRh2TFBcI1C+aJcOiQt5jRHEYoElknCaaNBV1S100EXOdJU+pbOcrm4QijI7GFMveWjGSFdNaDRnqMsl0tJlnoevm0TDIdEozHxeEI0HOFPHXn4c0LHjbEHHsORz3gSMnUiJtN4lcPJdMpot0Rlc5PO+z2aO7s03u7Q2H3HvHpKlqbXKMywLJN2vYFlWYRBgOs4F1XOc0LD4FzV8I0+nqbj6Tpz3WAxHH30wmVCUUTHcRFtJ8wh3BaG0Uqh67rEiwVdTUM3TfqWJWet36dvmrIvBZnohoJQnHmztYWh61QrJ9JFwrrKsnBEkhAEgfwgbvXOzzlzXQLfR1y6WCz+p1AYoVwuUwha/SemK6cIiKfruo7jOFd66zrrCRG2bUvVQlmRVyUMQ6lMLEzTlDdeJimcc10fXtfY/wEkIVZXZxL1EQAAAABJRU5ErkJggg=='); background-size: cover; display: block;\"\n  ></span>\n  <img\n        class=\"gatsby-resp-image-image\"\n        alt=\"iam-admin\"\n        title=\"\"\n        src=\"/static/f95711c1640409667128513600121e18/7bc0b/iam-admin.png\"\n        srcset=\"/static/f95711c1640409667128513600121e18/c26ae/iam-admin.png 158w,\n/static/f95711c1640409667128513600121e18/6bdcf/iam-admin.png 315w,\n/static/f95711c1640409667128513600121e18/7bc0b/iam-admin.png 386w\"\n        sizes=\"(max-width: 386px) 100vw, 386px\"\n        style=\"width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;\"\n        loading=\"lazy\"\n        decoding=\"async\"\n      />\n  </a>\n    </span></p>\n<p>다음, <strong>CREATE SERVICE ACCOUNT</strong>를 클릭한다.</p>\n<p><span\n      class=\"gatsby-resp-image-wrapper\"\n      style=\"position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 630px; \"\n    >\n      <a\n    class=\"gatsby-resp-image-link\"\n    href=\"/static/e012a21a5e0cf20e995633b9509e2b2c/d0cc0/create-service-account.png\"\n    style=\"display: block\"\n    target=\"_blank\"\n    rel=\"noopener\"\n  >\n    <span\n    class=\"gatsby-resp-image-background-image\"\n    style=\"padding-bottom: 53.79746835443038%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAALCAYAAAB/Ca1DAAAACXBIWXMAAAsTAAALEwEAmpwYAAACGklEQVR42nWQW2sUQRBG5xeGoE8+hJAYYx4UiRhB/VeKKCaSTUJQFCWEIGxM9jY7Ozuzc+uentm57pHujRdQGw5VdNdXXV9Z67s2Oy8ctp85bDwZc+fBkLVHA9Z3h6w/HnN7e8Dq1pDVrQErmz1WNq64tfmdtYfX7Dzts7nb497egLt7Nvefj7H2O9ccnw45PO5z0Lni81nIRVfx9Tzi/dE1hydD9js9Oqdjzi4ER6++cfCyS+d1l5O3lxy9ueTDuy6fPo74cu5h5XlKccM8kywWLW1b09QlVZlTVTlVoairAn0aJWlURqMUtSbVSOo8o21LLKUysiw3xYt2YWIUxQSzENeZMnU9Jo5rcJwJw5GN582wbYfRaGRqjXYBWm1JKfF93zCZuCRJQhzHBiESwjA0BMGMOIoI/BlRGBlm/szUJXFi3tI01ZZzIl0YaJFP2zamqf554iZImZIpRZZlKB3VMv6LVEqssixJhEQpwflFwmhcoVRCkgiqCpqmZbFYGJbWlvF/x5JS4E31rhx6/SmpqhEiNuNry+5kghASkQjjROdaUxQFdV1TVdWvvGkaLD/I8YIM188I44yqgakfGlEcJ3ieh+u6FGWBY9tLa6nEHtkIKZn5Pv1ezwygG1tRUhLGBX4wJ4jmpFnF1AtNQVkWpKlCCIFezU/LxvZN/HMVGquY58RRaIjCwNiMQj2h/Gtn/8pNI37f/wCgoS8QIpJrNQAAAABJRU5ErkJggg=='); background-size: cover; display: block;\"\n  ></span>\n  <img\n        class=\"gatsby-resp-image-image\"\n        alt=\"create-service-account\"\n        title=\"\"\n        src=\"/static/e012a21a5e0cf20e995633b9509e2b2c/f058b/create-service-account.png\"\n        srcset=\"/static/e012a21a5e0cf20e995633b9509e2b2c/c26ae/create-service-account.png 158w,\n/static/e012a21a5e0cf20e995633b9509e2b2c/6bdcf/create-service-account.png 315w,\n/static/e012a21a5e0cf20e995633b9509e2b2c/f058b/create-service-account.png 630w,\n/static/e012a21a5e0cf20e995633b9509e2b2c/d0cc0/create-service-account.png 732w\"\n        sizes=\"(max-width: 630px) 100vw, 630px\"\n        style=\"width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;\"\n        loading=\"lazy\"\n        decoding=\"async\"\n      />\n  </a>\n    </span></p>\n<p>추후에 잘 기억할 수 있도록 이름을 준다.</p>\n<p><span\n      class=\"gatsby-resp-image-wrapper\"\n      style=\"position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 556px; \"\n    >\n      <a\n    class=\"gatsby-resp-image-link\"\n    href=\"/static/b0c6a3a2eb85b184d4df83ddf7975eab/96638/service-account-detail.png\"\n    style=\"display: block\"\n    target=\"_blank\"\n    rel=\"noopener\"\n  >\n    <span\n    class=\"gatsby-resp-image-background-image\"\n    style=\"padding-bottom: 65.18987341772153%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAANCAYAAACpUE5eAAAACXBIWXMAAAsTAAALEwEAmpwYAAABjUlEQVR42pWS626jMBCF8/7PVq3abC+7CRBCWVGMHWyutgOcaibUmx+9WjrGlpjjz3O8yZ4t9rFGEu+QRAn+5TmOaYo4ihHt9tje3sEYAxrLsuCrsTHmjEr2eLz/je3tlg1+3dwgimJIKZHnOdquwzRN8P6M8/lj0YGbeVngnMNLUSA7ZkxHJlRMP5DmeWbDz0Qe9N+GJu896rpGVUkopdZ1xYRlWQbCj8imeWazC+FqmCYJdn/+4un+AfE+wjTNgTCQBuIl9NN7h7ZtoY25GNI0DAOHcYgTpIcUWXpkOiUVE7OkQn2qmZ50Op2gtYYQAln2DCnVf0K6/yE5cJp936OjE2sNvRbTmsyIpG0aNmqMgdEGjWnQdz3Tc8pkSH2gwu88i/fGW3BsSBtrLaRSKEXFYVAQRVGgLAWs83DewzrHcqvslWg/jiOHE0J5S1SUgo2EqCDWpKl/VPDV8wk9pCtf8a/fy3Sd8nfGSuigjUclR0hpUUmLl3JE1/kf9zOk3HUjjBmCtB7Q9/bHhq99q+/KcJGy5AAAAABJRU5ErkJggg=='); background-size: cover; display: block;\"\n  ></span>\n  <img\n        class=\"gatsby-resp-image-image\"\n        alt=\"service-account-detail\"\n        title=\"\"\n        src=\"/static/b0c6a3a2eb85b184d4df83ddf7975eab/96638/service-account-detail.png\"\n        srcset=\"/static/b0c6a3a2eb85b184d4df83ddf7975eab/c26ae/service-account-detail.png 158w,\n/static/b0c6a3a2eb85b184d4df83ddf7975eab/6bdcf/service-account-detail.png 315w,\n/static/b0c6a3a2eb85b184d4df83ddf7975eab/96638/service-account-detail.png 556w\"\n        sizes=\"(max-width: 556px) 100vw, 556px\"\n        style=\"width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;\"\n        loading=\"lazy\"\n        decoding=\"async\"\n      />\n  </a>\n    </span></p>\n<p>프로젝트나 팀 상황에 따라 이 계정에 부여하는 역할이 달라지지만 테스트이기 때문에 Service 계정에 <strong>Owner role</strong>을 준다.</p>\n<p><span\n      class=\"gatsby-resp-image-wrapper\"\n      style=\"position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 524px; \"\n    >\n      <a\n    class=\"gatsby-resp-image-link\"\n    href=\"/static/acb0db6dadc281f4ab780babf54fde92/664c8/select-role.png\"\n    style=\"display: block\"\n    target=\"_blank\"\n    rel=\"noopener\"\n  >\n    <span\n    class=\"gatsby-resp-image-background-image\"\n    style=\"padding-bottom: 90.50632911392405%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAASCAYAAABb0P4QAAAACXBIWXMAAAsTAAALEwEAmpwYAAACfklEQVR42o1UWZKbMBD16fOTC6Qqd8lHPlKVA4zZwYYZFiFAiH3zS3V7mBlP7FRU9RBC6tevu9UcpumCWrXwXA/h+QTbshCFEWzTwvl8xikIGIHvIwgCOLaD5+gZjmXD93w4tg3XcTGOE2gcDLvD0ZBwLIPJjKOBOE4ghICUElmaIk1SXvN7mqIsCuQiR5ZmiF9eeF6X9Up4uVwwzzNyISAyAZlLDP2AdV0wTzOWZcG6rnxmmmaeF36fME8TlnnCOI4M4jqQQd93sAwDtmnCtSy4tg3zeOTZMU0Oz3wyYDwZsEwTnuvCtX34fgbHjRE/k2qJbbvgwB6XFUXRoCyvUKpHVbVQqoOqemjdYhgGNLXmKLIkhZQVhNBIEoWq0hwuK9y2BbkcEEY14kQhTTXSrEWSaAjRIs06qHrAtq0opMQ5OOF8OiMKQ4SnAJ7nwvf9d0LKldYDykpBygxJEkPKHLlI0bYa5HB+zRNFQ/l8x8bo+x7btl2LQjmkg/SR5mEY+QrsBbiuRy7CR9DejqZpWN0NYdt2KMsSdV2jbdu3EOiaaK0Zjwbl90YheaSZPIVhiCiKUBQFHyAHtJdllI7kTck/CSlcUkUGcRyj6zoGV/Y1HNrblX8ed3NIhnmec3fsRERKJERI32l9b+yXmgmpzQI/4NAoh6SEjEkped7DoTXtfxw7CZ3fU3RoGoVCJhjHgRWQSiKlYuzpIMOqqv4qzE5YlgX3NxP++Fnhy1cPcULdIWGaFquhnwEZkJN7hXgY8q/fEt++28hEB60rWJb9lqv/JbwpCj2oG5Zl5gKQMuoCIiEopW7Wn3GXcJ4Xlr2r+gg6+IhsJ+y6nmRhHIA/SzhnXUxS3wYAAAAASUVORK5CYII='); background-size: cover; display: block;\"\n  ></span>\n  <img\n        class=\"gatsby-resp-image-image\"\n        alt=\"select-role\"\n        title=\"\"\n        src=\"/static/acb0db6dadc281f4ab780babf54fde92/664c8/select-role.png\"\n        srcset=\"/static/acb0db6dadc281f4ab780babf54fde92/c26ae/select-role.png 158w,\n/static/acb0db6dadc281f4ab780babf54fde92/6bdcf/select-role.png 315w,\n/static/acb0db6dadc281f4ab780babf54fde92/664c8/select-role.png 524w\"\n        sizes=\"(max-width: 524px) 100vw, 524px\"\n        style=\"width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;\"\n        loading=\"lazy\"\n        decoding=\"async\"\n      />\n  </a>\n    </span></p>\n<p>완료되면 아래와 같이 service 계정을 클릭한다.</p>\n<p><span\n      class=\"gatsby-resp-image-wrapper\"\n      style=\"position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 420px; \"\n    >\n      <a\n    class=\"gatsby-resp-image-link\"\n    href=\"/static/f2c12e1824fe836da24b521ee843c8b9/d10fb/service-account.png\"\n    style=\"display: block\"\n    target=\"_blank\"\n    rel=\"noopener\"\n  >\n    <span\n    class=\"gatsby-resp-image-background-image\"\n    style=\"padding-bottom: 66.45569620253164%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAANCAYAAACpUE5eAAAACXBIWXMAAAsTAAALEwEAmpwYAAAB70lEQVR42q1R226cMBDl/z+pah9SVU2Tqqn60BIu5r5cFrAxBrNrdjmVZzdRtUreaukwZ+7DjDOOEnmWoyor7JsGTd2grmrsigJNXaNrW9RlhSIv0LUd6qoiX8wilLsd8rzA4XDAy3OUGsEChjiKkKUpBUYhAwtCSkzjBP6zB/ePS02TKEaaJAj9EIHnwfd8LHrB+XzCuq5wVmOglMI0TZgmBTUq0uUgIcVA9mEQmJTCKCVGOUCpCVJKyOHqFwN430MIDsccD+j7DoJ34JwThBAYhoHA+ZULQQUE6ZKaXGI5BOfUwOY5Uh7w290jTXvM80wdrXyB1bXl1j5dda3/iZ3Ip2eNaZ7gnE4bjNmwnvBfnmM/62qgtZ1IwxiDozEwqyF+wfGV28Wfz+d3QQXt6PZy9rLLomlPvOfou4643dEoFdlsLL1te3/CLMvQNA3mRSPLC6h5pimX4xGHq7zlFnaXt6CCrusiSVO0jOHpw0fsPR9DFIGHDL0fkiQELzLEkOXQy/J2wYgxVE2D0fcR/PCwe9ojftghfSyRfi8R3xdIHkskDyWSbzsUP2uMbvD2L2/bhu182Qf/9Yz4zkd6HyH9yhB88pB8YYjuAsSfQ7JZ6KrFzBgo9wbOq2KvPSocuw6m70m+i7bFqhTl3Bb8C5HH3mnWUlDiAAAAAElFTkSuQmCC'); background-size: cover; display: block;\"\n  ></span>\n  <img\n        class=\"gatsby-resp-image-image\"\n        alt=\"service-account\"\n        title=\"\"\n        src=\"/static/f2c12e1824fe836da24b521ee843c8b9/d10fb/service-account.png\"\n        srcset=\"/static/f2c12e1824fe836da24b521ee843c8b9/c26ae/service-account.png 158w,\n/static/f2c12e1824fe836da24b521ee843c8b9/6bdcf/service-account.png 315w,\n/static/f2c12e1824fe836da24b521ee843c8b9/d10fb/service-account.png 420w\"\n        sizes=\"(max-width: 420px) 100vw, 420px\"\n        style=\"width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;\"\n        loading=\"lazy\"\n        decoding=\"async\"\n      />\n  </a>\n    </span></p>\n<p>어플리케이션에 API를 연결하기 위해 <em>key</em>를 생성해야 한다. key에 이름을 주고 다운로드를 누르면 <code class=\"language-text\">json</code> 포맷으로 된 파일이 드라이브로 저장된다.</p>\n<p><span\n      class=\"gatsby-resp-image-wrapper\"\n      style=\"position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 533px; \"\n    >\n      <a\n    class=\"gatsby-resp-image-link\"\n    href=\"/static/37867e6fe0db2357ba5962ff4395ed63/a1aa0/add-key.png\"\n    style=\"display: block\"\n    target=\"_blank\"\n    rel=\"noopener\"\n  >\n    <span\n    class=\"gatsby-resp-image-background-image\"\n    style=\"padding-bottom: 63.291139240506325%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAANCAYAAACpUE5eAAAACXBIWXMAAAsTAAALEwEAmpwYAAAB0UlEQVR42p1TDY+bMAzl//+6adfx0VvVUgJJgBBIIEBK+6aY7W7VnaZtlp7sZ0d2YjuR4ALWWAQZrUVVleCcQ6mOfM7doLqV7Hl2FNNaE1+WBW3T4n5/4PHYEXnvsa4rkWCPdoS1I+Z5hvd3KLVA1jOm6YZtu2Ec91g4f7t5TNP0nDC/XCgRyQMf5PGJ708SZWmGcXLYtg1+9fB+pRvv2PmvV/wNItNJ6JohSzJ8/fKCJM6QxjHSJMUxTREfviEUDTyNE2RJitfjd8SHA8XSJMMxO1Is6MhoBTtocF7idGJglaXmh94E7aYJzjnqW9CTc6Rd4D991lrqbdCR1j0ZZhhgjaFJd6oj3rUKw2Cguw6qVei1hhkM+r7/jQ9vA6GhtHUNrRSCVk2DXndomxqdaolr1e2+kLzv0eueCoRilLTXz0PJrwKsalBWLQomkV84ikLici5RXAOXOJ1n5NcVBVtwzme0ymPbHp8tBSJ+qtHkLcpXCcEGCLmCixlCLpByQd0sZDftjsBlvUBr//bMp4RN3kCeBEapMOf5hwP/KpHOOQIs41jr+r8X+v2GTQ0zGvqfFRe0LlJKWgMhBBhjBPKFv15WYKxAVZYwZl8x597xA0lr5hZ0NOyEAAAAAElFTkSuQmCC'); background-size: cover; display: block;\"\n  ></span>\n  <img\n        class=\"gatsby-resp-image-image\"\n        alt=\"add-key\"\n        title=\"\"\n        src=\"/static/37867e6fe0db2357ba5962ff4395ed63/a1aa0/add-key.png\"\n        srcset=\"/static/37867e6fe0db2357ba5962ff4395ed63/c26ae/add-key.png 158w,\n/static/37867e6fe0db2357ba5962ff4395ed63/6bdcf/add-key.png 315w,\n/static/37867e6fe0db2357ba5962ff4395ed63/a1aa0/add-key.png 533w\"\n        sizes=\"(max-width: 533px) 100vw, 533px\"\n        style=\"width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;\"\n        loading=\"lazy\"\n        decoding=\"async\"\n      />\n  </a>\n    </span></p>\n<p>파일은 아래와 같다:</p>\n<p><span\n      class=\"gatsby-resp-image-wrapper\"\n      style=\"position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 516px; \"\n    >\n      <a\n    class=\"gatsby-resp-image-link\"\n    href=\"/static/74757499d6b24a2750361802a556f514/75dcb/json-key.png\"\n    style=\"display: block\"\n    target=\"_blank\"\n    rel=\"noopener\"\n  >\n    <span\n    class=\"gatsby-resp-image-background-image\"\n    style=\"padding-bottom: 44.93670886075949%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAJCAYAAAAywQxIAAAACXBIWXMAAAsTAAALEwEAmpwYAAABhElEQVR42oWS647bIBSE8yq1ufuGAceA49jxbrarqu//OlNxHLXdH1V/jA5CYvhm4GIMhxACWrfgnEOwGkoKSMFPSYGaMVRVhbqu/6sLZxzadNiPn3BhRnATvB0wjT1m1yN6i67RMErSgW9Vhar+t/mFMYamHbCsT+TbG2I64KcMO1i4rsG1GHtLxn7o4PoG+mVezjKaXwgZjOmQb++Y04Zt/wHnZ4pr2wazO2lv04jkB7i+hRQCjVHQSkCIs7I/hpxDKkOEMe9Eae1IdH5oiarIds0Z+9Xn3/raIWfQusHt/sScHuitw9hqrFeHMLRYgkUOA5HmV+xSQ1H0A4Ltaa+AlX7JsERe90/EtMNPC0Y74lhXLHHGlhPuKWFLM77fIx55wjI57DHg4x6RwgijFfXaaHlGVtqQYV7esG6fWNYP5PWJ5f6EHQPyHOnlS497CjiWK5k98hVHnn7PoovWEkZLMC6oXCkVhJC05lygrioYKeh2LSXRtEbRVOX/lj0liVBJiV8sUhP4hq67UgAAAABJRU5ErkJggg=='); background-size: cover; display: block;\"\n  ></span>\n  <img\n        class=\"gatsby-resp-image-image\"\n        alt=\"json-key\"\n        title=\"\"\n        src=\"/static/74757499d6b24a2750361802a556f514/75dcb/json-key.png\"\n        srcset=\"/static/74757499d6b24a2750361802a556f514/c26ae/json-key.png 158w,\n/static/74757499d6b24a2750361802a556f514/6bdcf/json-key.png 315w,\n/static/74757499d6b24a2750361802a556f514/75dcb/json-key.png 516w\"\n        sizes=\"(max-width: 516px) 100vw, 516px\"\n        style=\"width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;\"\n        loading=\"lazy\"\n        decoding=\"async\"\n      />\n  </a>\n    </span></p>\n<p>이 <code class=\"language-text\">json</code> 파일 안에는 구글 상품들과 연결할 때 필수적인 두 값이 있는데 하나는 <strong>client email</strong>이고 다른 하나는 <strong>private key</strong>이다.</p>\n<h2>Google Sheet API 허용</h2>\n<p><span\n      class=\"gatsby-resp-image-wrapper\"\n      style=\"position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 630px; \"\n    >\n      <a\n    class=\"gatsby-resp-image-link\"\n    href=\"/static/5b602c08ad3acf7d5a39b6e0a28b8d7e/99072/enable-api.png\"\n    style=\"display: block\"\n    target=\"_blank\"\n    rel=\"noopener\"\n  >\n    <span\n    class=\"gatsby-resp-image-background-image\"\n    style=\"padding-bottom: 14.556962025316455%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAADCAYAAACTWi8uAAAACXBIWXMAAAsTAAALEwEAmpwYAAAA4UlEQVR42h2JTUsCQQBA9x8EdukaWJcygsD+VB90iZLIQP9HUWKGRpdYMpAVPQhd+gNBLbq7M9uYOTnjpsEL98G7vOesFSQ7pZh8+ZOtYkz2VJI9EWycRWxfSNYLkpUjwfJBRGY/ZGkvIHMYsnq8+IJ8SZI7F+yWJZtFiXPtBVS8PrVOSKUdcOMF1HuKx1dNoxen76rV57I1oNqNuX/55tZ9p+p+cNf0aTz71J586k2fB/cNJ7Ea+zNior+YjIeYsWL+O2XBLLEYPUqb0YpZYtL+pxRTqbBiiBUq1USKuRD8A1eOwUFtOHqAAAAAAElFTkSuQmCC'); background-size: cover; display: block;\"\n  ></span>\n  <img\n        class=\"gatsby-resp-image-image\"\n        alt=\"enable-api\"\n        title=\"\"\n        src=\"/static/5b602c08ad3acf7d5a39b6e0a28b8d7e/f058b/enable-api.png\"\n        srcset=\"/static/5b602c08ad3acf7d5a39b6e0a28b8d7e/c26ae/enable-api.png 158w,\n/static/5b602c08ad3acf7d5a39b6e0a28b8d7e/6bdcf/enable-api.png 315w,\n/static/5b602c08ad3acf7d5a39b6e0a28b8d7e/f058b/enable-api.png 630w,\n/static/5b602c08ad3acf7d5a39b6e0a28b8d7e/99072/enable-api.png 842w\"\n        sizes=\"(max-width: 630px) 100vw, 630px\"\n        style=\"width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;\"\n        loading=\"lazy\"\n        decoding=\"async\"\n      />\n  </a>\n    </span></p>\n<p>Google Sheet API를 대시보드에서 허용해 주어야 사용할 수 있다. 프로젝트 하위에 <strong>Go to API and services</strong>로 이동하여 <strong>ENABLE APIS AND SERVICES</strong>를 클릭한다. 검색창에 <em>google sheet api</em> 를 입력한 후 API를 허용해 준다.</p>\n<h2>테스트 Google Sheet</h2>\n<p><em>google sheets</em> 에서 빈 sheet를 생성한다. 어플리케이션을 google sheet에 연결하기 위해서는 꼭 필요한 절차가 있다. 가상의 사용자인 Service 계정에 sheet를 접근할 권한을 주어야 한다. 우측에 보이는 <strong>Share</strong>를 통해 가능하다. <strong>Share</strong> 버튼을 클릭한다.</p>\n<p><span\n      class=\"gatsby-resp-image-wrapper\"\n      style=\"position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 331px; \"\n    >\n      <a\n    class=\"gatsby-resp-image-link\"\n    href=\"/static/ee3dbceb7c282c0d163b7cfafa426a96/62452/share-1.png\"\n    style=\"display: block\"\n    target=\"_blank\"\n    rel=\"noopener\"\n  >\n    <span\n    class=\"gatsby-resp-image-background-image\"\n    style=\"padding-bottom: 51.89873417721519%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAKCAYAAAC0VX7mAAAACXBIWXMAAAsTAAALEwEAmpwYAAABF0lEQVR42pWSQUvDQBCF92f5A8SLJ721Zy+CF9FeioogFEUolpJWLILgRTx4k4LoL6pmI0l2N8nOPpmkSYNYSQaGt7yd/XjLrkCLSpIUX74EMouXhytcjg8wmh5jODnE4GYf86cxRBOQcy7XxeIT87d32DBG73wX24MtdK93sDfqYPN0A2cX3WbAFZigjQFSi9fHIbxpD7O7Pu5nJ/C8I3w830JYS2jTnLbQv2/SKmG9iCzIUaXWZpBSQhA5NG9a63PqNM0YSPjdHL2NX98XWhsopRHHCsYkuUr5Dfa5oyhGOSNlAG2Sar6Y0fB9mXtKqRWQD5bAMIzWAs0SWPoMDIIiAJ8T9WvwOv9zSy1e1FZr94/PxY/yA+DZ+tB6oK2lAAAAAElFTkSuQmCC'); background-size: cover; display: block;\"\n  ></span>\n  <img\n        class=\"gatsby-resp-image-image\"\n        alt=\"share-1\"\n        title=\"\"\n        src=\"/static/ee3dbceb7c282c0d163b7cfafa426a96/62452/share-1.png\"\n        srcset=\"/static/ee3dbceb7c282c0d163b7cfafa426a96/c26ae/share-1.png 158w,\n/static/ee3dbceb7c282c0d163b7cfafa426a96/6bdcf/share-1.png 315w,\n/static/ee3dbceb7c282c0d163b7cfafa426a96/62452/share-1.png 331w\"\n        sizes=\"(max-width: 331px) 100vw, 331px\"\n        style=\"width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;\"\n        loading=\"lazy\"\n        decoding=\"async\"\n      />\n  </a>\n    </span></p>\n<p>팝업 창이 아래 사진처럼 나오게 되면 <code class=\"language-text\">json</code> key 파일에 있는 <strong>client email</strong>을 입력한다.</p>\n<p><span\n      class=\"gatsby-resp-image-wrapper\"\n      style=\"position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 602px; \"\n    >\n      <a\n    class=\"gatsby-resp-image-link\"\n    href=\"/static/ae86f727bbbf4abca8a40bdd1fc1144b/32056/share-2.png\"\n    style=\"display: block\"\n    target=\"_blank\"\n    rel=\"noopener\"\n  >\n    <span\n    class=\"gatsby-resp-image-background-image\"\n    style=\"padding-bottom: 34.177215189873415%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAHCAYAAAAIy204AAAACXBIWXMAAAsTAAALEwEAmpwYAAABA0lEQVR42o2Q3W6CQBBGeU+9M/HWn7fQFHhBuWnaosK6PyzsQpXT7LaYXlTTSU6+TGZyMplkuVyyXq/ZbDZ3Qr/dbmOuVquHhPlE8CwWC5L9fo+1lroWCHFBSonWmqqqMcbgnKPruj8Jc6VUzN1ux3w+J8nzPAqLoqAsyx+OHA5FXAw1jiO/a+qNaRBCRGmWZcxmM5I0faEfQKoe0/Ro06O0xzQDtr0+pe2uNPbKMEDw3IWtg9PZcq4UVa2phaE8CrR2eD/i3O0hjf3EtiNpmn4Lw6neD7x9nKPkeLrElKrF9yPO354SrgwPuAvzPKNre95fTxijUFoh5QXvPf+p6Z+T8AtzeuS4RwND7wAAAABJRU5ErkJggg=='); background-size: cover; display: block;\"\n  ></span>\n  <img\n        class=\"gatsby-resp-image-image\"\n        alt=\"share-2\"\n        title=\"\"\n        src=\"/static/ae86f727bbbf4abca8a40bdd1fc1144b/32056/share-2.png\"\n        srcset=\"/static/ae86f727bbbf4abca8a40bdd1fc1144b/c26ae/share-2.png 158w,\n/static/ae86f727bbbf4abca8a40bdd1fc1144b/6bdcf/share-2.png 315w,\n/static/ae86f727bbbf4abca8a40bdd1fc1144b/32056/share-2.png 602w\"\n        sizes=\"(max-width: 602px) 100vw, 602px\"\n        style=\"width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;\"\n        loading=\"lazy\"\n        decoding=\"async\"\n      />\n  </a>\n    </span></p>\n<p>Google Sheet API를 연결하기 위해서 연결할 sheet의 id도 필요하게 된다. 이 id는 해당 sheet의 url에서 확인할 수 있으며 다음과 같다:</p>\n<div class=\"gatsby-highlight\" data-language=\"text\"><pre class=\"language-text\"><code class=\"language-text\">https://docs.google.com/spreadsheets/d/[your-sheet-id]/edit#gid=0</code></pre></div>\n<p>아래와 같이 간단한 데이터셋을 입력하고 다음 단계로 넘어가자.</p>\n<p><span\n      class=\"gatsby-resp-image-wrapper\"\n      style=\"position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 560px; \"\n    >\n      <a\n    class=\"gatsby-resp-image-link\"\n    href=\"/static/85ddd65bbec309cedebf91cb37c143fa/b06ae/test-sheet.png\"\n    style=\"display: block\"\n    target=\"_blank\"\n    rel=\"noopener\"\n  >\n    <span\n    class=\"gatsby-resp-image-background-image\"\n    style=\"padding-bottom: 63.291139240506325%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAANCAYAAACpUE5eAAAACXBIWXMAAAsTAAALEwEAmpwYAAACSklEQVR42l1T13LcMAzUx+Yv8mt59ZPHdlxubF9Ro+5OPHU2VWoTwDXBDEaihlgsVougsDXu8g1W71GUJZRSKMsSTdNgmiYorTmNtXym8KvHuq5f6T0+IriWj/jx6yfMYBGFEbLsiDAMkWUZjDUMXBQlmrZF27aYp4mB+2HAPM/o+/7zSRmUrsFVfodxnlDXNRe1bYeu61DVNTqlcJES1jrkUqKqKr4jLwWstTifchhtcM4l8lwiIJrLsGAYJ9RNC5EdIWXBXVXXwboeq18xDAPGccIwjAxODSnHcWTGbdNwo2CaZ1jnuEAbi7Kq4ZzDsixcQAD0Tg0oedx+YHaO60Z477m51hpB1ynM81sBdXOuhzEWvetxuRRYFo/Fe75D796v7+k/z/Skn0PfgqqqkYoM4nSBOEqkmYQ4l6iaN3ZV3XADx6wclNKsMZ3pO0nStApaGyYTiOyMRJxwdf2EU9WjsR6n1uP2+YjN42/c3NwijlMee7fb4eH+HtvtjhlrrfD4cI+nzYblIZYB6dZ2Cq+7EGdZYpgW2GGBGxbWK89zJEmMOE6QpinbCOvKniPAl5dn1pL9SSMT1U5ppEmM8HDA68szW+UjCIB8SYAiE3yHtKYwxiCKI/6h3wDfGIZRiEN4gBCCx/Hv7u+6FmmaII5jiFQgCkOM7xtjjEYUhf8CKm143fbhAfv9HtM0A1g/Aeu6QpLGzDJJEmxft2wzCq477P9jaCyPLGXOepH4HxYgO9D2FGUBebmgKkteTZKJgrTLZf61438B/wC24+AgUm+9TwAAAABJRU5ErkJggg=='); background-size: cover; display: block;\"\n  ></span>\n  <img\n        class=\"gatsby-resp-image-image\"\n        alt=\"test-sheet\"\n        title=\"\"\n        src=\"/static/85ddd65bbec309cedebf91cb37c143fa/b06ae/test-sheet.png\"\n        srcset=\"/static/85ddd65bbec309cedebf91cb37c143fa/c26ae/test-sheet.png 158w,\n/static/85ddd65bbec309cedebf91cb37c143fa/6bdcf/test-sheet.png 315w,\n/static/85ddd65bbec309cedebf91cb37c143fa/b06ae/test-sheet.png 560w\"\n        sizes=\"(max-width: 560px) 100vw, 560px\"\n        style=\"width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;\"\n        loading=\"lazy\"\n        decoding=\"async\"\n      />\n  </a>\n    </span></p>\n<h2>Node.js 어플리케이션 Google Sheet 연동</h2>\n<p>Node.js 어플리케이션이 없는 독자들은 아래와 같이 간단하게 생성하면 된다.</p>\n<ol>\n<li>프로젝트 폴더를 생성한다</li>\n<li>터미널에서 <code class=\"language-text\">npm init -y</code>를 입력한다</li>\n<li><code class=\"language-text\">app.js</code>라는 이름의 파일을 만든다 - <em>이름은 알아서 정해도 된다</em></li>\n</ol>\n<p>google sheet API를 사용하기 위해 필요한 라이브러리를 설치한다.</p>\n<div class=\"gatsby-highlight\" data-language=\"js\"><pre class=\"language-js\"><code class=\"language-js\">npm install <span class=\"token operator\">--</span>save googleapis</code></pre></div>\n<p>아래 코드를 app.js 파일에 복사하여 붙여넣는다.:</p>\n<div class=\"gatsby-highlight\" data-language=\"js\"><pre class=\"language-js\"><code class=\"language-js\"><span class=\"token keyword\">const</span> <span class=\"token punctuation\">{</span> google <span class=\"token punctuation\">}</span> <span class=\"token operator\">=</span> <span class=\"token function\">require</span><span class=\"token punctuation\">(</span><span class=\"token string\">'googleapis'</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n\n<span class=\"token keyword\">const</span> clientEmail <span class=\"token operator\">=</span> <span class=\"token string\">'your service account client email'</span><span class=\"token punctuation\">;</span>\n<span class=\"token keyword\">const</span> privateKey <span class=\"token operator\">=</span> <span class=\"token string\">'your service account private key'</span><span class=\"token punctuation\">;</span>\n<span class=\"token keyword\">const</span> googleSheetId <span class=\"token operator\">=</span> <span class=\"token string\">'your google sheet id'</span><span class=\"token punctuation\">;</span>\n<span class=\"token keyword\">const</span> googleSheetPage <span class=\"token operator\">=</span> <span class=\"token string\">'your google sheet page name'</span><span class=\"token punctuation\">;</span>\n\n<span class=\"token comment\">// authenticate the service account</span>\n<span class=\"token keyword\">const</span> googleAuth <span class=\"token operator\">=</span> <span class=\"token keyword\">new</span> <span class=\"token class-name\">google<span class=\"token punctuation\">.</span>auth<span class=\"token punctuation\">.</span>JWT</span><span class=\"token punctuation\">(</span>\n    clientEmail<span class=\"token punctuation\">,</span>\n    <span class=\"token keyword\">null</span><span class=\"token punctuation\">,</span>\n    privateKey<span class=\"token punctuation\">.</span><span class=\"token function\">replace</span><span class=\"token punctuation\">(</span><span class=\"token regex\"><span class=\"token regex-delimiter\">/</span><span class=\"token regex-source language-regex\">\\\\n</span><span class=\"token regex-delimiter\">/</span><span class=\"token regex-flags\">g</span></span><span class=\"token punctuation\">,</span> <span class=\"token string\">'\\n'</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">,</span>\n    <span class=\"token string\">'https://www.googleapis.com/auth/spreadsheets'</span>\n<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></code></pre></div>\n<p>앞서 언급했듯이 google sheet에 접근하기 위해서 필요한 값들은 <code class=\"language-text\">json</code> key 파일 안에 담긴 <strong>client email, private key</strong>와  <strong>google sheet id, 해당 sheet 이름</strong>이다.\n해당 sheet 이름은 화면 아래 탭에 적혀 있다. 위 코드에 각각 알맞은 값을 적어 넣는다.</p>\n<p><span\n      class=\"gatsby-resp-image-wrapper\"\n      style=\"position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 259px; \"\n    >\n      <a\n    class=\"gatsby-resp-image-link\"\n    href=\"/static/40bc58105d6397c3313af7356638d038/a2ead/sheet-name.png\"\n    style=\"display: block\"\n    target=\"_blank\"\n    rel=\"noopener\"\n  >\n    <span\n    class=\"gatsby-resp-image-background-image\"\n    style=\"padding-bottom: 65.82278481012659%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAANCAYAAACpUE5eAAAACXBIWXMAAAsTAAALEwEAmpwYAAABY0lEQVR42q1S206EMBTk/z/HN11906ivxoe9mCjscl96g1JKC2NaZLMmGE1ckskZctrJnDMNejvgsD8gyQro3kBrjd++cRwxDMNiL2ikBGUMjHM4rpQ6XfgJ1loYYxZ7gTbWO4yTDJ3u0XWd8+BFf8IsutQLZNuCEOpdXsShsQPSNANlHL2x/9+hc+h3KMRlHDpXURhhv08ut8Mp5cnhJLg46N9GdiNSQkAp8+OWxwpJmiPNCl9nPv0XiNMccZqderGv89lieoeyVXBOHa8oQ5qX/mBeEpQV9Y/ewXFKBThvfGVMgFEBQrlHRRgCVjdgovbgjURxrJAXJZTW+AgjbHdvkEr50MZhhOwVsvqIzmo0vYToavTWQNt+GpnXDfiXaNMqvIcR1tsdzDDi8ekZ16tbyE6jYsyvMSQxVpsH3GzucfV6h5dkDdpyxCz/LjiL1rL1wjN3cD3KxSkIF8p5QOehfAJ8yfFXKYH+SwAAAABJRU5ErkJggg=='); background-size: cover; display: block;\"\n  ></span>\n  <img\n        class=\"gatsby-resp-image-image\"\n        alt=\"sheet-name\"\n        title=\"\"\n        src=\"/static/40bc58105d6397c3313af7356638d038/a2ead/sheet-name.png\"\n        srcset=\"/static/40bc58105d6397c3313af7356638d038/c26ae/sheet-name.png 158w,\n/static/40bc58105d6397c3313af7356638d038/a2ead/sheet-name.png 259w\"\n        sizes=\"(max-width: 259px) 100vw, 259px\"\n        style=\"width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;\"\n        loading=\"lazy\"\n        decoding=\"async\"\n      />\n  </a>\n    </span></p>\n<h2>Sheet 읽기</h2>\n<div class=\"gatsby-highlight\" data-language=\"js\"><pre class=\"language-js\"><code class=\"language-js\"><span class=\"token keyword\">async</span> <span class=\"token keyword\">function</span> <span class=\"token function\">readSheet</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n  <span class=\"token keyword\">try</span> <span class=\"token punctuation\">{</span>\n    <span class=\"token comment\">// google sheet instance</span>\n    <span class=\"token keyword\">const</span> sheetInstance <span class=\"token operator\">=</span> <span class=\"token keyword\">await</span> google<span class=\"token punctuation\">.</span><span class=\"token function\">sheets</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">{</span> <span class=\"token literal-property property\">version</span><span class=\"token operator\">:</span> <span class=\"token string\">'v4'</span><span class=\"token punctuation\">,</span> <span class=\"token literal-property property\">auth</span><span class=\"token operator\">:</span> googleAuth<span class=\"token punctuation\">}</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n    <span class=\"token comment\">// read data in the range in a sheet</span>\n    <span class=\"token keyword\">const</span> infoObjectFromSheet <span class=\"token operator\">=</span> <span class=\"token keyword\">await</span> sheetInstance<span class=\"token punctuation\">.</span>spreadsheets<span class=\"token punctuation\">.</span>values<span class=\"token punctuation\">.</span><span class=\"token function\">get</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">{</span>\n        <span class=\"token literal-property property\">auth</span><span class=\"token operator\">:</span> googleAuth<span class=\"token punctuation\">,</span>\n        <span class=\"token literal-property property\">spreadsheetId</span><span class=\"token operator\">:</span> googleSheetId<span class=\"token punctuation\">,</span>\n        <span class=\"token literal-property property\">range</span><span class=\"token operator\">:</span> <span class=\"token template-string\"><span class=\"token template-punctuation string\">`</span><span class=\"token interpolation\"><span class=\"token interpolation-punctuation punctuation\">${</span>googleSheetPage<span class=\"token interpolation-punctuation punctuation\">}</span></span><span class=\"token string\">!A2:D6</span><span class=\"token template-punctuation string\">`</span></span>\n    <span class=\"token punctuation\">}</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n    \n    <span class=\"token keyword\">const</span> valuesFromSheet <span class=\"token operator\">=</span> infoObjectFromSheet<span class=\"token punctuation\">.</span>data<span class=\"token punctuation\">.</span>values<span class=\"token punctuation\">;</span>\n    console<span class=\"token punctuation\">.</span><span class=\"token function\">log</span><span class=\"token punctuation\">(</span>valuesFromSheet<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n  <span class=\"token punctuation\">}</span>\n  <span class=\"token keyword\">catch</span><span class=\"token punctuation\">(</span>err<span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n    console<span class=\"token punctuation\">.</span><span class=\"token function\">log</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"readSheet func() error\"</span><span class=\"token punctuation\">,</span> err<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>  \n  <span class=\"token punctuation\">}</span>\n<span class=\"token punctuation\">}</span>\n\n<span class=\"token function\">readSheet</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></code></pre></div>\n<p><strong>readSheet</strong> 함수에서 <strong>get</strong> 메소드를 통해 구글 시트에 적혀 있는 정보가 담긴 객체를 얻을 수 있다. 시트 내 범위를 <strong>A2:D6</strong> 설정해 주었는데 읽어오는 데이터의 행과 열을 나타낸다 - <em>헤더 행을 제외하기 위해 2번째 행부터 시작했다</em>.</p>\n<p>터미널에 <code class=\"language-text\">node app.js</code> 입력하면 다음과 같은 로그를 보게 된다:</p>\n<p><span\n      class=\"gatsby-resp-image-wrapper\"\n      style=\"position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 348px; \"\n    >\n      <a\n    class=\"gatsby-resp-image-link\"\n    href=\"/static/29ccf3de1a9fcc2a40b0b576669ec81d/34ea4/read-data-log.png\"\n    style=\"display: block\"\n    target=\"_blank\"\n    rel=\"noopener\"\n  >\n    <span\n    class=\"gatsby-resp-image-background-image\"\n    style=\"padding-bottom: 37.9746835443038%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAICAYAAAD5nd/tAAAACXBIWXMAAAsTAAALEwEAmpwYAAABZklEQVR42mVS2W7bQAzUp1R7ayXuodVZxUmsuGjT//+fKZa2mwJ9IEAOh0MSZGOMgZAS7TcBKSWUVpBKQikFKSRjTxOtgBQCSknm/Jt7WhOIEKYB5SUjzgStNYbskdaAcmQcv1b4wcN5h+UszFVCY7qMSDshhQjnHIS4D9SkFBFKj+02Yz0L9o8F5ZJgjeUmy7Vguy0o3zM671BeEua3wrm63XK5+5EC1zQhENJKWD8mJh+fG/J+7zpdMvvH7w198OipY07lUh5gq+BZQIVQ8gitFZoYAvIWMb+OmN9HzNeRxYbUY3rN2G8zlvcCay2Lz28jW9c5xGngDYgCcopo2xZNddJC2H7M3LkK9eQRV+LC43PFep3grMNYpzsL1rNOSPDksP9ckEtGjg/BznXQVqMjB9dbnqRe2HkL1z+wzkJrA+PMX8x1jnm1ThsNo839KPwOQvBLsNVrCfkVP7H/eF+vxPgj/gNmx/LFTEnQOgAAAABJRU5ErkJggg=='); background-size: cover; display: block;\"\n  ></span>\n  <img\n        class=\"gatsby-resp-image-image\"\n        alt=\"read-data-log\"\n        title=\"\"\n        src=\"/static/29ccf3de1a9fcc2a40b0b576669ec81d/34ea4/read-data-log.png\"\n        srcset=\"/static/29ccf3de1a9fcc2a40b0b576669ec81d/c26ae/read-data-log.png 158w,\n/static/29ccf3de1a9fcc2a40b0b576669ec81d/6bdcf/read-data-log.png 315w,\n/static/29ccf3de1a9fcc2a40b0b576669ec81d/34ea4/read-data-log.png 348w\"\n        sizes=\"(max-width: 348px) 100vw, 348px\"\n        style=\"width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;\"\n        loading=\"lazy\"\n        decoding=\"async\"\n      />\n  </a>\n    </span></p>\n<h2>Sheet 삭제</h2>\n<div class=\"gatsby-highlight\" data-language=\"js\"><pre class=\"language-js\"><code class=\"language-js\"><span class=\"token keyword\">async</span> <span class=\"token keyword\">function</span> <span class=\"token function\">clearSheet</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n  <span class=\"token keyword\">try</span> <span class=\"token punctuation\">{</span>\n    <span class=\"token comment\">// google sheet instance</span>\n    <span class=\"token keyword\">const</span> sheetInstance <span class=\"token operator\">=</span> <span class=\"token keyword\">await</span> google<span class=\"token punctuation\">.</span><span class=\"token function\">sheets</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">{</span> <span class=\"token literal-property property\">version</span><span class=\"token operator\">:</span> <span class=\"token string\">'v4'</span><span class=\"token punctuation\">,</span> <span class=\"token literal-property property\">auth</span><span class=\"token operator\">:</span> googleAuth<span class=\"token punctuation\">}</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n    <span class=\"token comment\">// clear data in the range</span>\n    <span class=\"token keyword\">await</span> sheetInstance<span class=\"token punctuation\">.</span>spreadsheets<span class=\"token punctuation\">.</span>values<span class=\"token punctuation\">.</span><span class=\"token function\">clear</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">{</span>\n        <span class=\"token literal-property property\">auth</span><span class=\"token operator\">:</span> googleAuth<span class=\"token punctuation\">,</span>\n        <span class=\"token literal-property property\">spreadsheetId</span><span class=\"token operator\">:</span> googleSheetId<span class=\"token punctuation\">,</span>\n        <span class=\"token literal-property property\">range</span><span class=\"token operator\">:</span> <span class=\"token template-string\"><span class=\"token template-punctuation string\">`</span><span class=\"token interpolation\"><span class=\"token interpolation-punctuation punctuation\">${</span>googleSheetPage<span class=\"token interpolation-punctuation punctuation\">}</span></span><span class=\"token string\">!A2:D6</span><span class=\"token template-punctuation string\">`</span></span><span class=\"token punctuation\">,</span>\n    <span class=\"token punctuation\">}</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n  <span class=\"token punctuation\">}</span>\n  <span class=\"token keyword\">catch</span><span class=\"token punctuation\">(</span>err<span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n    console<span class=\"token punctuation\">.</span><span class=\"token function\">log</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"clearSheet func() error\"</span><span class=\"token punctuation\">,</span> err<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>  \n  <span class=\"token punctuation\">}</span>\n<span class=\"token punctuation\">}</span>\n\n<span class=\"token function\">clearSheet</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></code></pre></div>\n<p><strong>clear</strong> 메소드로 행과 열에 담긴 데이터를 삭제할 수 있다. 어플리케이션을 실행하면 지정한 범위 내의 행과 열에 담긴 데이터가 삭제된다.</p>\n<h2>Sheet 업데이트</h2>\n<div class=\"gatsby-highlight\" data-language=\"js\"><pre class=\"language-js\"><code class=\"language-js\"><span class=\"token keyword\">async</span> <span class=\"token keyword\">function</span> <span class=\"token function\">updateSheet</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n  <span class=\"token keyword\">try</span> <span class=\"token punctuation\">{</span>\n    <span class=\"token comment\">// google sheet instance</span>\n    <span class=\"token keyword\">const</span> sheetInstance <span class=\"token operator\">=</span> <span class=\"token keyword\">await</span> google<span class=\"token punctuation\">.</span><span class=\"token function\">sheets</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">{</span> <span class=\"token literal-property property\">version</span><span class=\"token operator\">:</span> <span class=\"token string\">'v4'</span><span class=\"token punctuation\">,</span> <span class=\"token literal-property property\">auth</span><span class=\"token operator\">:</span> googleAuth<span class=\"token punctuation\">}</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n\n    <span class=\"token keyword\">const</span> updateToGsheet <span class=\"token operator\">=</span> <span class=\"token punctuation\">[</span>\n      <span class=\"token punctuation\">[</span> <span class=\"token string\">'Seoul'</span><span class=\"token punctuation\">,</span> <span class=\"token string\">'9,776,000'</span><span class=\"token punctuation\">,</span> <span class=\"token string\">'Asia'</span><span class=\"token punctuation\">,</span> <span class=\"token string\">'KRW'</span> <span class=\"token punctuation\">]</span><span class=\"token punctuation\">,</span>\n      <span class=\"token punctuation\">[</span> <span class=\"token string\">'Copenhagen'</span><span class=\"token punctuation\">,</span> <span class=\"token string\">'602,000'</span><span class=\"token punctuation\">,</span> <span class=\"token string\">'Europe'</span><span class=\"token punctuation\">,</span> <span class=\"token string\">'EUR'</span> <span class=\"token punctuation\">]</span><span class=\"token punctuation\">,</span>\n      <span class=\"token punctuation\">[</span> <span class=\"token string\">'Amsterdam'</span><span class=\"token punctuation\">,</span> <span class=\"token string\">'821,000'</span><span class=\"token punctuation\">,</span> <span class=\"token string\">'Europe'</span><span class=\"token punctuation\">,</span> <span class=\"token string\">'EUR'</span> <span class=\"token punctuation\">]</span><span class=\"token punctuation\">,</span>\n      <span class=\"token punctuation\">[</span> <span class=\"token string\">'Helsinki'</span><span class=\"token punctuation\">,</span> <span class=\"token string\">'631,000'</span><span class=\"token punctuation\">,</span> <span class=\"token string\">'Europe'</span><span class=\"token punctuation\">,</span> <span class=\"token string\">'EUR'</span> <span class=\"token punctuation\">]</span><span class=\"token punctuation\">,</span>\n      <span class=\"token punctuation\">[</span> <span class=\"token string\">'Sydney'</span><span class=\"token punctuation\">,</span> <span class=\"token string\">'5,312,000'</span><span class=\"token punctuation\">,</span> <span class=\"token string\">'Oceania'</span><span class=\"token punctuation\">,</span> <span class=\"token string\">'AUD'</span> <span class=\"token punctuation\">]</span>\n    <span class=\"token punctuation\">]</span><span class=\"token punctuation\">;</span>\n    \n    <span class=\"token comment\">// update data in the range</span>\n    <span class=\"token keyword\">await</span> sheetInstance<span class=\"token punctuation\">.</span>spreadsheets<span class=\"token punctuation\">.</span>values<span class=\"token punctuation\">.</span><span class=\"token function\">update</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">{</span>\n        <span class=\"token literal-property property\">auth</span><span class=\"token operator\">:</span> googleAuth<span class=\"token punctuation\">,</span>\n        <span class=\"token literal-property property\">spreadsheetId</span><span class=\"token operator\">:</span> googleSheetId<span class=\"token punctuation\">,</span>\n        <span class=\"token literal-property property\">range</span><span class=\"token operator\">:</span> <span class=\"token template-string\"><span class=\"token template-punctuation string\">`</span><span class=\"token interpolation\"><span class=\"token interpolation-punctuation punctuation\">${</span>googleSheetPage<span class=\"token interpolation-punctuation punctuation\">}</span></span><span class=\"token string\">!A2:D6</span><span class=\"token template-punctuation string\">`</span></span><span class=\"token punctuation\">,</span>\n        <span class=\"token literal-property property\">valueInputOption</span><span class=\"token operator\">:</span> <span class=\"token string\">'RAW'</span><span class=\"token punctuation\">,</span>\n        <span class=\"token literal-property property\">resource</span><span class=\"token operator\">:</span> <span class=\"token punctuation\">{</span>\n          <span class=\"token literal-property property\">values</span><span class=\"token operator\">:</span> updateToGsheet<span class=\"token punctuation\">,</span>\n        <span class=\"token punctuation\">}</span><span class=\"token punctuation\">,</span>\n    <span class=\"token punctuation\">}</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n  <span class=\"token punctuation\">}</span>\n  <span class=\"token keyword\">catch</span><span class=\"token punctuation\">(</span>err<span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n    console<span class=\"token punctuation\">.</span><span class=\"token function\">log</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"updateSheet func() error\"</span><span class=\"token punctuation\">,</span> err<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>  \n  <span class=\"token punctuation\">}</span>\n<span class=\"token punctuation\">}</span>\n\n<span class=\"token function\">updateSheet</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></code></pre></div>\n<p><strong>update</strong> 메소드로 지정된 범위의 값들을 업데이트 시킬 수 있다. 값들은 배열의 배열이어야 하며 지정된 행과 열과 크기가 동일한지 확인할 필요가 있다. <strong>updateToGsheet</strong> 변수의 처음 인자가 <strong>A2부터 D2</strong>에 입력되고 다음 인자가 <strong>A3부터 D3</strong>에 입력되며 차례대로 이 같은 방법으로 입력된다.</p>\n<p>어플리케이션을 실행하고 시트 안에 값들이 변했는지 확인한다 - <em>지정된 행과 열에 값이 있었다면 새로운 값으로 덮어 씌어진다</em>.</p>\n<h2>결론</h2>\n<p>간단하게 Node.js로 Google Sheet API를 연결하여 읽기, 쓰기, 삭제하는 방법을 알아보았다. 간단한 모델이기에 독자들이 본인의 의도에 맞게 추가 개발하여 심화시키면 좋을 거 같다.</p>\n<p><em><strong>읽어 주셔서 감사합니다. To be continued!</strong></em></p>\n<p><em>이 글은 <a href=\"https://medium.com/@shkim04/beginner-guide-on-google-sheet-api-for-node-js-4c0b533b071a\">Medium</a>에도 업로드 되었습니다.</em>\n<em>놀러 오세요!</em></p>","frontmatter":{"title":"Node.js에서 Googe Sheet API 사용하기","date":"2023년 01월 03일","description":"","tag":["NodeJS"]},"fields":{"locale":"ko"}},"previous":{"fields":{"slug":"/aws-ec2-인스턴트-시작-node-설치"},"frontmatter":{"title":"AWS EC2 인스턴스 생성 후 Node 설치하기"}},"next":{"fields":{"slug":"/python-가상환경-설정"},"frontmatter":{"title":"윈도우에 Python 가상 환경 설치하기"}}},"pageContext":{"locale":"ko","isDefaultLang":true,"slug":"/nodejs-에서-google-sheet-사용하는법","titleByLang":{"ko":"nodejs-에서-google-sheet-사용하는법","en":"how-to-use-google-sheet-on-nodejs"},"dateFormat":"YYYY년 MM월 DD일","id":"6ddf6df9-7b6a-55c3-88b5-726e9aaa6b29","previousPostId":"77f39f43-dd3e-5cfe-b0c7-f27e200976ae","nextPostId":"945a7103-9290-5475-bc9c-db50bc3a6841"}},"staticQueryHashes":[],"slicesMap":{}}