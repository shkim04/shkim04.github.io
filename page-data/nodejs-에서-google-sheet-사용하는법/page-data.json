{"componentChunkName":"component---src-templates-blog-post-js","path":"/nodejs-에서-google-sheet-사용하는법/","result":{"data":{"site":{"siteMetadata":{"title":"Seunghyun's Blog"}},"markdownRemark":{"id":"689a5c96-867e-5aba-b0ac-c0b545647a5a","excerpt":"Google Sheet는 브라우저에서 동작하기 때문에 어디서나 사용할 수 있고 기능이 다양해서 아주 유용한 소프트웨어 상품이다. 이 Google Sheet는 Google이 API를 제공하기 때문에 어느 어플리케이션이라도 쉽게 연결할 수 있다. Google Sheet API…","html":"<p><strong>Google Sheet</strong>는 브라우저에서 동작하기 때문에 어디서나 사용할 수 있고 기능이 다양해서 아주 유용한 소프트웨어 상품이다. 이 Google Sheet는 Google이 API를 제공하기 때문에 어느 어플리케이션이라도 쉽게 연결할 수 있다. <strong>Google Sheet API</strong>를 통해서 google sheet에서 입력한 정보를 읽고 가공하는 것이 가능하다.</p>\n<p>Google Sheet API를 사용하려면 먼저 가상의 사용자 계정을 만들어야 한다. 이 단계부터 시작해보자.</p>\n<h2>필수</h2>\n<ul>\n<li>google cloud 계정 — <em>검색하면 쉽게 나온다. 결제 정보를 입력해야 하니 참고바란다</em></li>\n<li>google sheet - <em>구글 계정이 있다면 누구나 만들 수 있다</em></li>\n<li>Node</li>\n</ul>\n<h2>Service 계정</h2>\n<p>google cloud에 로그인한 후 <strong>Google Cloud IAM and admin</strong>으로 이동한다. Service 계정이 글머리에서 언급한 가상의 사용자이다. 아래 빨간색으로 표시된 <strong>Service accounts</strong> 클릭한다.</p>\n<p><span\n      class=\"gatsby-resp-image-wrapper\"\n      style=\"position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 386px; \"\n    >\n      <a\n    class=\"gatsby-resp-image-link\"\n    href=\"/static/f95711c1640409667128513600121e18/7bc0b/iam-admin.png\"\n    style=\"display: block\"\n    target=\"_blank\"\n    rel=\"noopener\"\n  >\n    <span\n    class=\"gatsby-resp-image-background-image\"\n    style=\"padding-bottom: 108.86075949367088%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAWCAYAAADAQbwGAAAACXBIWXMAAAsTAAALEwEAmpwYAAAD0ElEQVR42n2UWW/bRhSF+Q/TFkULFG1sZDMSoGnsIlvbh6Zv/T19yEPR2Imj2I0TL7Jl7eIiktpISeYucfmKGcWOEhu9wMG95HDOnLlzhsrtRya3Hpms/mxy/3ebn571JNZ+sVh7anHjocl3P3a595vNyoYp3609sbj92GJ1w+SHByZf3TH48vYCysq6wcp6l2/vtVl7avDgWZe7vxqsbmjceWJwfV3jm7ttVjdUvr/f4eZDjZV1lVuPda4/0Ph6rc21my2u3Wjxxa0WyvO/K/z1/IijypjtnS7bOyY7ez129mxKuya772wOjh32yy4Hxy7vDkfslx3evLV586/J4Ykr5x5VxJiDsv9+l9LrTcgTyvvvaJweobXrVI8POS3v027WoZjxeTSqxzSqJ5++a4Uos9mMJEnIspyCgjwvZC1wXqdpJjGfpwRBKOuiKCRJUYjv8g9zMpShmzJyU7wgY+DMZfbDHC/MPkEQgzMOMAyDPAdND6k1fJrtgI4WEie5XEDRzBltPcGdZjTUhKlf4IUFZ+EiXyACuz/h+KSK684wrQjNCNC7IYYZ0h9EJEmKEscJAvM0xw8CgiAiCGOCIMYPIgnPD8lymEzOqNfr/F8oo9EIx3GYJQmnp6e02y25rU6nQ61WQ1U71Os10jTF9z3q9Ybs1daLF2y/2mb7VYmtzU1ebm5xsH+AIgZFUxeNXTRb5I/IL1Y/O/uo0BmNGPQHDAdDbMum3+sjxCnT6RSBOI6lQk3TaDabVKs1Wq0mqtpiNosvEVrdLp22imkYmIaJ1tGwTBPlXN3CAoWEsAsUxEnGYJgQxdklwuXvl2tlMpng+z5RFFEul6XCymmVRqPC7t6AP/5s8/b9RE6aTj8SnhNdOpTl1S6yLAviOMOyE8LwaoUL4xcXWUARigTSPKdSq9JSVeqtFrrokaZi2jppOrtEmGcFdi+hWvfRjIi2ujC6Mp/PmacpqecR2D3C/oB4MCQZjoj6A3zHJfvQ42VC102wbI9+32c4inDcmJETo4zHY0aOw6C0Q/mfF7R2d6m9LlHdfk2tVCI4qZBnV2+517No1mrYtkUch4zH7odTLgoiw+BMVQmMLp6m4+k6vq6TDodX+lDYzHVdppMpo+FIPouDlQoFZllGW9PQTROz18OwLLRuV2bhS0Hmed4FoZiz9fIlhq5zUj7mzPOlW2QPxbUSiMIQ3/OYTiaSQEwKfB9hLfGL+1zh3t4e54JEyN/X+U0RW9d1/WLwqlgmFAJs25aqBBY2ylHEvoMgkOymaUo1y85f3Jz8ykNZjvOb8h+nJFaUoe8KwwAAAABJRU5ErkJggg=='); background-size: cover; display: block;\"\n  ></span>\n  <img\n        class=\"gatsby-resp-image-image\"\n        alt=\"iam-admin\"\n        title=\"\"\n        src=\"/static/f95711c1640409667128513600121e18/7bc0b/iam-admin.png\"\n        srcset=\"/static/f95711c1640409667128513600121e18/c26ae/iam-admin.png 158w,\n/static/f95711c1640409667128513600121e18/6bdcf/iam-admin.png 315w,\n/static/f95711c1640409667128513600121e18/7bc0b/iam-admin.png 386w\"\n        sizes=\"(max-width: 386px) 100vw, 386px\"\n        style=\"width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;\"\n        loading=\"lazy\"\n        decoding=\"async\"\n      />\n  </a>\n    </span></p>\n<p>다음, <strong>CREATE SERVICE ACCOUNT</strong>를 클릭한다.</p>\n<p><span\n      class=\"gatsby-resp-image-wrapper\"\n      style=\"position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 630px; \"\n    >\n      <a\n    class=\"gatsby-resp-image-link\"\n    href=\"/static/e012a21a5e0cf20e995633b9509e2b2c/d0cc0/create-service-account.png\"\n    style=\"display: block\"\n    target=\"_blank\"\n    rel=\"noopener\"\n  >\n    <span\n    class=\"gatsby-resp-image-background-image\"\n    style=\"padding-bottom: 53.79746835443038%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAALCAYAAAB/Ca1DAAAACXBIWXMAAAsTAAALEwEAmpwYAAACEklEQVR42m2RW2sUQRCF5w8q6pugRqPGPCgSMSL5VyIqmJibShAVYgySxexuZmd37j237pmdmb180p1EQkjBoaq7q07VqbburTgsr41Yej3kwcsht5+ecOf5CQsrNgsvHG4t2dx4pHHCtcUe1+93ubn4l7vPuiy/6rO40uPxap+Hqw5P1oZY61vH7H612dztsbF1zPd9we8jxc8DwaedLpufbda3emx/cdg/zNl5+4eNN0dsv+uw+6HDzvsOex87fNuz+fHLx2obRTOWtLU0HubAFGiZTipmk4pJo2BWY6ySTJVippTxbSGZywLaEmiwlKooqzEXLUlSoijGHXn4XmC8xmjoYg8cgiDCcYbY9oAkTU2NHmM+B6soCsIwNHBdlyzLTFKapuR5hhACEQviKCJJEqIwIhGCROg4JE1SsjQ1b1JKrLIszSGOY+I4ZD6fGjIhUlw3Iy8kpVIoVaKUQucrc74AeQpZFFh13ZDnBUrlHBxmDIYNUuoJc9oWptPZqSSt58yfx1eZVRQ5vu/h+yN6fR+lJuRZil6Fluy5rmloViEEeZ4b1HVN27Y0TcN4PGYymRhYYVwRRBVeWCLSknYKfnBaqKUHvo/neoZg6DjIM2mDgWNywiCk1+0hC2mIrSRriJMxmjhOKmTZ4gWxmVB314vWhTq+LPmi9PN7q64r0kQYCBH9/1kt87JdRXB5p/8Ajxsu3XUMBqQAAAAASUVORK5CYII='); background-size: cover; display: block;\"\n  ></span>\n  <img\n        class=\"gatsby-resp-image-image\"\n        alt=\"create-service-account\"\n        title=\"\"\n        src=\"/static/e012a21a5e0cf20e995633b9509e2b2c/f058b/create-service-account.png\"\n        srcset=\"/static/e012a21a5e0cf20e995633b9509e2b2c/c26ae/create-service-account.png 158w,\n/static/e012a21a5e0cf20e995633b9509e2b2c/6bdcf/create-service-account.png 315w,\n/static/e012a21a5e0cf20e995633b9509e2b2c/f058b/create-service-account.png 630w,\n/static/e012a21a5e0cf20e995633b9509e2b2c/d0cc0/create-service-account.png 732w\"\n        sizes=\"(max-width: 630px) 100vw, 630px\"\n        style=\"width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;\"\n        loading=\"lazy\"\n        decoding=\"async\"\n      />\n  </a>\n    </span></p>\n<p>추후에 잘 기억할 수 있도록 이름을 준다.</p>\n<p><span\n      class=\"gatsby-resp-image-wrapper\"\n      style=\"position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 556px; \"\n    >\n      <a\n    class=\"gatsby-resp-image-link\"\n    href=\"/static/b0c6a3a2eb85b184d4df83ddf7975eab/96638/service-account-detail.png\"\n    style=\"display: block\"\n    target=\"_blank\"\n    rel=\"noopener\"\n  >\n    <span\n    class=\"gatsby-resp-image-background-image\"\n    style=\"padding-bottom: 65.18987341772153%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAANCAYAAACpUE5eAAAACXBIWXMAAAsTAAALEwEAmpwYAAABmElEQVR42qVTi46bMBDM//9aq94lup56FyBASAPYgB0escEw1S6Ba6tEPakrDQvYOzvegU10NNj7CoH/hsAPcEpOiMIQvufBe99j+7SFUhoU0zThX7FRuocQLV5fdtg977B9esa3L1/heT6klEiOCeq6gXMOfT9gGO6D1qjhBpjgXI/0nCKOYkSHEKdjwpuWGMdxLnTuA8OSB25mreW8cW5E3/eoqgpCCJRFMd/nAlJIpGm6KrynjN5TQ1LHCumBCMPggLcf73h9+Q5/78GN0zq3exhv8yRldV1DKTUT0qXrOpyShE0JDwfEYcTzK6SElMWaq7JEWZaoyoozkeRZjjiOIaT8UEhdgiCAVhpt26KhjpXioxNUNROQkvpy4TWtNbRSuOgL16wuu9uAqdv/xDJHVmiM4SNlWc5mZGmG888zZ2Mtn8CYx6D16/U6u7yYQjMjgjzLmDjPxep0IQsuoL1U9Ai/uTw8PMri6mfjRmihlIWQBrIwnNPsirrpiRLE9+jz+RszobVoGgOtuxVKdWhb8wfhZ/7nX/CI72zwlcp7AAAAAElFTkSuQmCC'); background-size: cover; display: block;\"\n  ></span>\n  <img\n        class=\"gatsby-resp-image-image\"\n        alt=\"service-account-detail\"\n        title=\"\"\n        src=\"/static/b0c6a3a2eb85b184d4df83ddf7975eab/96638/service-account-detail.png\"\n        srcset=\"/static/b0c6a3a2eb85b184d4df83ddf7975eab/c26ae/service-account-detail.png 158w,\n/static/b0c6a3a2eb85b184d4df83ddf7975eab/6bdcf/service-account-detail.png 315w,\n/static/b0c6a3a2eb85b184d4df83ddf7975eab/96638/service-account-detail.png 556w\"\n        sizes=\"(max-width: 556px) 100vw, 556px\"\n        style=\"width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;\"\n        loading=\"lazy\"\n        decoding=\"async\"\n      />\n  </a>\n    </span></p>\n<p>프로젝트나 팀 상황에 따라 이 계정에 부여하는 역할이 달라지지만 테스트이기 때문에 Service 계정에 <strong>Owner role</strong>을 준다.</p>\n<p><span\n      class=\"gatsby-resp-image-wrapper\"\n      style=\"position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 524px; \"\n    >\n      <a\n    class=\"gatsby-resp-image-link\"\n    href=\"/static/acb0db6dadc281f4ab780babf54fde92/664c8/select-role.png\"\n    style=\"display: block\"\n    target=\"_blank\"\n    rel=\"noopener\"\n  >\n    <span\n    class=\"gatsby-resp-image-background-image\"\n    style=\"padding-bottom: 90.50632911392405%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAASCAYAAABb0P4QAAAACXBIWXMAAAsTAAALEwEAmpwYAAAClElEQVR42nVU25KbMAzNz/epH9CH/ktn+tLpD2wIECAhC8ZgCBBuBpPTkbLusjtZz2iwZOvo6MjJTus7mrpDcAwQn8/wPQ9xfIF3cHE+n3GKIkRkQYgoDOF7Pl4vr/BcD2EQ8P2jf8Q0adDaOW6Pl72C5+7huS6cvYM0FchlDqUUZJYhEwJFnr/tM5RliTwvIDOJNEkgZY51XR+A6/0OrTXyPGdTqsQ0TnxhWQyMMbjf7/yd5xnLssDQ2TzDLDOMmTFrjWkc+d6OLgxDD89x4B0O8F0XR8/D4WWPo+u9xch34Lw4cJ0DguMRvhsgDCV8XyB5zVCViknsbNWqvKGqbijLFnXdo6o6/tbXAW3TYRxHtG3LbUohoIorpGyRplc0bcftMsPVLCjUiPjSIBU1sqxFJm8QooXMO2SyQ92MWFcDVRQ4RSecoxMu5xjxKWK2YRi+AxqzoGlHVFUNVUgIkUAVpGeGrmuxrgvmWWOaJtbQrOZhhmzFut6ZPRXkoXDLs2YdaU+JZFrP7I+j9fVTozu32+19yhSg5K7rUFUVmqZB3/f/WxBCsHZkX61hGN4BaSDbSnEcs9Fbo1XXNQ9NSok0TbmILWb3HwAJiALEkBKSJGGGZBS37RBTurMF2wKSpgxoHy0lFkXBvw4SmXwCtYAU30qxBSSN7doliUAURmibhjUkJpRMX6ps2yH2VobPgEWhUJbqAdh1Na6VgNYjJxNLAsuyjLUjVgRIxexgPgNSITLydr9+X/Hte4BE9LhWBZzDgdkQMC3SzQr+Gexpy3/+Kvz46ULmPZrmCtf1PmhFgNvJbtfToTyODD9uSiZm9h+GjJ7N1n/G8MOzoRg9bJqsrUqHNoH2W39rNt73A4AV0wD8A6+wZuRvbsUMAAAAAElFTkSuQmCC'); background-size: cover; display: block;\"\n  ></span>\n  <img\n        class=\"gatsby-resp-image-image\"\n        alt=\"select-role\"\n        title=\"\"\n        src=\"/static/acb0db6dadc281f4ab780babf54fde92/664c8/select-role.png\"\n        srcset=\"/static/acb0db6dadc281f4ab780babf54fde92/c26ae/select-role.png 158w,\n/static/acb0db6dadc281f4ab780babf54fde92/6bdcf/select-role.png 315w,\n/static/acb0db6dadc281f4ab780babf54fde92/664c8/select-role.png 524w\"\n        sizes=\"(max-width: 524px) 100vw, 524px\"\n        style=\"width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;\"\n        loading=\"lazy\"\n        decoding=\"async\"\n      />\n  </a>\n    </span></p>\n<p>완료되면 아래와 같이 service 계정을 클릭한다.</p>\n<p><span\n      class=\"gatsby-resp-image-wrapper\"\n      style=\"position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 420px; \"\n    >\n      <a\n    class=\"gatsby-resp-image-link\"\n    href=\"/static/f2c12e1824fe836da24b521ee843c8b9/d10fb/service-account.png\"\n    style=\"display: block\"\n    target=\"_blank\"\n    rel=\"noopener\"\n  >\n    <span\n    class=\"gatsby-resp-image-background-image\"\n    style=\"padding-bottom: 66.45569620253164%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAANCAYAAACpUE5eAAAACXBIWXMAAAsTAAALEwEAmpwYAAAB8UlEQVR42q1S2Y6cMBDk/z8pyUMSZTeHtEledg4wN3MwgDEe2xhmoCL3HNKusnmKpXK7q7uLthtPdh3yLMduu8WhLLHf7bHb7lDkBcr9HnVVUazIclSHGnsXKwpEYYRNUVCttRa35R2lBAsY4jBCmqSUGLIQLAioIIlj+Ks1ls9LbDe7a16CwA+IX6/WMKbH+XzGaRzhuU1rDWMMWXVUUEqj6zpIKYkXQlDMfdxBawN1POIoj+j7Hp0Q4E0D0bbwhsGiaWpwAr+AtyTStgKcc4jWnVuy5AtBxS635Zw414DL8URn8bw4IEkbaK2oQ9cNQem7r5S6+M5qA62uuc5eOWe983nGMALThP+yPLedTiOMuXQ1jiOGYSB7x80fRpxOJ0zT9CZI0Am5yTGfwdqe3sQ9cl3XdG55A9lJ4tw13Zrn+e8dukCWZSjLEtpopFkOqRTsOMBYi34YXsHCOFj74u+4gTpcLBaIkwRVyPDz3Xsc1muIKAJnIRqfkeWBw/XsBxBZDtP3L8TuglEYYleWkL4P/2mF4qlE/G2D9MeWED0WSL5vCPHXAvmvPeSSvX3lebq8B/+9RPzJR/oYInkIEXxYI/nCEH0MEH8OkD5ceL2toBnDNM80CNK4ggSJdNOWEkNVYWxqDPU/4HKkpJr5leAf6W/d494PDVsAAAAASUVORK5CYII='); background-size: cover; display: block;\"\n  ></span>\n  <img\n        class=\"gatsby-resp-image-image\"\n        alt=\"service-account\"\n        title=\"\"\n        src=\"/static/f2c12e1824fe836da24b521ee843c8b9/d10fb/service-account.png\"\n        srcset=\"/static/f2c12e1824fe836da24b521ee843c8b9/c26ae/service-account.png 158w,\n/static/f2c12e1824fe836da24b521ee843c8b9/6bdcf/service-account.png 315w,\n/static/f2c12e1824fe836da24b521ee843c8b9/d10fb/service-account.png 420w\"\n        sizes=\"(max-width: 420px) 100vw, 420px\"\n        style=\"width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;\"\n        loading=\"lazy\"\n        decoding=\"async\"\n      />\n  </a>\n    </span></p>\n<p>어플리케이션에 API를 연결하기 위해 <em>key</em>를 생성해야 한다. key에 이름을 주고 다운로드를 누르면 <code class=\"language-text\">json</code> 포맷으로 된 파일이 드라이브로 저장된다.</p>\n<p><span\n      class=\"gatsby-resp-image-wrapper\"\n      style=\"position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 533px; \"\n    >\n      <a\n    class=\"gatsby-resp-image-link\"\n    href=\"/static/37867e6fe0db2357ba5962ff4395ed63/a1aa0/add-key.png\"\n    style=\"display: block\"\n    target=\"_blank\"\n    rel=\"noopener\"\n  >\n    <span\n    class=\"gatsby-resp-image-background-image\"\n    style=\"padding-bottom: 63.291139240506325%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAANCAYAAACpUE5eAAAACXBIWXMAAAsTAAALEwEAmpwYAAAB6ElEQVR42o1Uia7bIBD0/39dWyW+nvLiG7Ax+AQfjadi00QvaqS+lUa7C2iMdgZ7nHEMwwAX4ziiKkswxtC2CsCB2eyQ7UL71hiwikErjeMArLWQTYPb7YbjuFH29n3Huq44jgPbtmEaRyJ2h7ftN5FxYTHNO/Z9wzRNtPc4P88zET3gpUmCfdvxv3A3+k54URhhmg3cTbd1pdsuy0L5LZav9fLaryu8oeVQokAYRPj54xcCP0Jw9hH4AaIgxPl0RhSG1Ie+j9APEccf8E8n+KczwiBEHMUIfB9xGMPrdYux12BVhc9LgaJy8zM0G2MtZjPDGENzm42h+glrKY/TSLN12dO6wzhO6LuexJjGAapVGPoBrWzR9wOUUlRrrdH3PTqtqe/+9k6gpyiyFtCthKxrtE2DTimqlZRkCUeutYJ05F2HTnfQ9AFJcP2LKEkmUJQNikoiLwSSK0OecSTXEnkmkCYCl6tBki3I8gWfiYVsd9yOrw44nvDYpUadNig/BHjeg4sFjFvynoOoF3BuUcsFdXOHO6P1+kL0JGzSBvzCMQkJm6X0Or4Xd4J/fKhTBpVUGHKGtW6edO+M/H7tddGrG4HBKasVSsZIfiEEKe7edFHkyPMcnN/XyrKkviwK+gc42ziLPfAHzcPlStC16rAAAAAASUVORK5CYII='); background-size: cover; display: block;\"\n  ></span>\n  <img\n        class=\"gatsby-resp-image-image\"\n        alt=\"add-key\"\n        title=\"\"\n        src=\"/static/37867e6fe0db2357ba5962ff4395ed63/a1aa0/add-key.png\"\n        srcset=\"/static/37867e6fe0db2357ba5962ff4395ed63/c26ae/add-key.png 158w,\n/static/37867e6fe0db2357ba5962ff4395ed63/6bdcf/add-key.png 315w,\n/static/37867e6fe0db2357ba5962ff4395ed63/a1aa0/add-key.png 533w\"\n        sizes=\"(max-width: 533px) 100vw, 533px\"\n        style=\"width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;\"\n        loading=\"lazy\"\n        decoding=\"async\"\n      />\n  </a>\n    </span></p>\n<p>파일은 아래와 같다:</p>\n<p><span\n      class=\"gatsby-resp-image-wrapper\"\n      style=\"position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 516px; \"\n    >\n      <a\n    class=\"gatsby-resp-image-link\"\n    href=\"/static/74757499d6b24a2750361802a556f514/75dcb/json-key.png\"\n    style=\"display: block\"\n    target=\"_blank\"\n    rel=\"noopener\"\n  >\n    <span\n    class=\"gatsby-resp-image-background-image\"\n    style=\"padding-bottom: 44.93670886075949%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAJCAYAAAAywQxIAAAACXBIWXMAAAsTAAALEwEAmpwYAAABeklEQVR42n1SW27kIBCcq9jmYYwH8BODB8fxZjZRcv/zVESPk6xW2v0oFQ2iqK7m0igOzjlqpYk5q1ALDsE5pHigqioUZUn8L5Tn+YUxBqVa7McH+mHG2I8YnMHkrpg7g2VwaBsFJcVDuCjp8t/4Er0wVqHRBvF2R1gP+HCgHyOsceiuDYn63hJ606IzGkpKlFX5H4dNi3j7BR82bPs7ut5Tq7ZtSGhyBuvUYTlFcxy6kailgOCM6m9BzhmkVFjTC3zYEW4HrM3uNF3OGGwL2+qzbUZtE8oHSOxPh3WtsaY7/LLD2B6uVUhzh8FoxNEhDBZzbxAGR+I5hq8oRnelvaxTFMVPy+npjRwOU4SzDke6YfUztrgghYAtzHjdFuxhQpw6PC0j7snT0JpaQtWS+HTYkGAeStreyG1ML8TODYjeo7ePHPcw4ogzfqcFz2HCczwRRqovqhZQSoAxAS4EhJDE+U+yM2wlOb2eh5BZq5o4Dy7vZXc537z+BKkVEt6pvwMtAAAAAElFTkSuQmCC'); background-size: cover; display: block;\"\n  ></span>\n  <img\n        class=\"gatsby-resp-image-image\"\n        alt=\"json-key\"\n        title=\"\"\n        src=\"/static/74757499d6b24a2750361802a556f514/75dcb/json-key.png\"\n        srcset=\"/static/74757499d6b24a2750361802a556f514/c26ae/json-key.png 158w,\n/static/74757499d6b24a2750361802a556f514/6bdcf/json-key.png 315w,\n/static/74757499d6b24a2750361802a556f514/75dcb/json-key.png 516w\"\n        sizes=\"(max-width: 516px) 100vw, 516px\"\n        style=\"width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;\"\n        loading=\"lazy\"\n        decoding=\"async\"\n      />\n  </a>\n    </span></p>\n<p>이 <code class=\"language-text\">json</code> 파일 안에는 구글 상품들과 연결할 때 필수적인 두 값이 있는데 하나는 <strong>client email</strong>이고 다른 하나는 <strong>private key</strong>이다.</p>\n<h2>Google Sheet API 허용</h2>\n<p><span\n      class=\"gatsby-resp-image-wrapper\"\n      style=\"position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 630px; \"\n    >\n      <a\n    class=\"gatsby-resp-image-link\"\n    href=\"/static/5b602c08ad3acf7d5a39b6e0a28b8d7e/99072/enable-api.png\"\n    style=\"display: block\"\n    target=\"_blank\"\n    rel=\"noopener\"\n  >\n    <span\n    class=\"gatsby-resp-image-background-image\"\n    style=\"padding-bottom: 14.556962025316455%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAADCAYAAACTWi8uAAAACXBIWXMAAAsTAAALEwEAmpwYAAAA3UlEQVR42j2J0UrCYABG9wixK28D7SKSgsCnsoIuoiRM0vdQ1NKyuirLC1nUhdBNLxDomPu3/99M2rJtFJ5IoQMfB76jZQqS7VNFrqLInijSR5L0ocP6scNmSbJWkKT2XfRdB31HsJK30fcEqweCrZJLrizJFpfeKEq0umHTNCxaT4Lmo03DsOkMfG5fQ64GatFqfYtqf8z5s+L65YNWd8jZ3YiLB5NOz6R9P+KyZ3LTfUObJwHJ55Q4fCcOJ0SBD/OYBT8Ryeyv+USBB9+z5T+dkLgesev/70t4ICW/XffBhbxT7NsAAAAASUVORK5CYII='); background-size: cover; display: block;\"\n  ></span>\n  <img\n        class=\"gatsby-resp-image-image\"\n        alt=\"enable-api\"\n        title=\"\"\n        src=\"/static/5b602c08ad3acf7d5a39b6e0a28b8d7e/f058b/enable-api.png\"\n        srcset=\"/static/5b602c08ad3acf7d5a39b6e0a28b8d7e/c26ae/enable-api.png 158w,\n/static/5b602c08ad3acf7d5a39b6e0a28b8d7e/6bdcf/enable-api.png 315w,\n/static/5b602c08ad3acf7d5a39b6e0a28b8d7e/f058b/enable-api.png 630w,\n/static/5b602c08ad3acf7d5a39b6e0a28b8d7e/99072/enable-api.png 842w\"\n        sizes=\"(max-width: 630px) 100vw, 630px\"\n        style=\"width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;\"\n        loading=\"lazy\"\n        decoding=\"async\"\n      />\n  </a>\n    </span></p>\n<p>Google Sheet API를 대시보드에서 허용해 주어야 사용할 수 있다. 프로젝트 하위에 <strong>Go to API and services</strong>로 이동하여 <strong>ENABLE APIS AND SERVICES</strong>를 클릭한다. 검색창에 <em>google sheet api</em> 를 입력한 후 API를 허용해 준다.</p>\n<h2>테스트 Google Sheet</h2>\n<p><em>google sheets</em> 에서 빈 sheet를 생성한다. 어플리케이션을 google sheet에 연결하기 위해서는 꼭 필요한 절차가 있다. 가상의 사용자인 Service 계정에 sheet를 접근할 권한을 주어야 한다. 우측에 보이는 <strong>Share</strong>를 통해 가능하다. <strong>Share</strong> 버튼을 클릭한다.</p>\n<p><span\n      class=\"gatsby-resp-image-wrapper\"\n      style=\"position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 331px; \"\n    >\n      <a\n    class=\"gatsby-resp-image-link\"\n    href=\"/static/ee3dbceb7c282c0d163b7cfafa426a96/62452/share-1.png\"\n    style=\"display: block\"\n    target=\"_blank\"\n    rel=\"noopener\"\n  >\n    <span\n    class=\"gatsby-resp-image-background-image\"\n    style=\"padding-bottom: 51.89873417721519%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAKCAYAAAC0VX7mAAAACXBIWXMAAAsTAAALEwEAmpwYAAABHklEQVR42q1STUvDQBDdf+UPEE9e9NhevXjwItaL+HEQRRFKpQ216kHwIAjehIL0H7VkY5LdTba7eTK7aVKwQhQHhnm8HR7zZpYVRYEmSZHnOWZhCGiDt6drXPX3cDvsoBvs47K3i/FLHwwNYiE4nc4w/pjAxAKds21sXmygfbOFnV4L6ydrOD1vg/1mQmstVJYBeo735y6C4SHuR0d4fDjGIDjA5PUOzBiDxmmtE6f6UzSyvMo+TWusgS3TmDk452D08B9JDrTWqwVpir/wVJlSCkJIpKmAUpmrnEcOS6lK3veQJc/LildSIQw5hPQ93wSFEIjjpBJMktRjJxgtCXqeBKPos+xN6NvUOyC8+CbLu3G4sNUx6v7aKgUd5QuY0PoJ1r5zdAAAAABJRU5ErkJggg=='); background-size: cover; display: block;\"\n  ></span>\n  <img\n        class=\"gatsby-resp-image-image\"\n        alt=\"share-1\"\n        title=\"\"\n        src=\"/static/ee3dbceb7c282c0d163b7cfafa426a96/62452/share-1.png\"\n        srcset=\"/static/ee3dbceb7c282c0d163b7cfafa426a96/c26ae/share-1.png 158w,\n/static/ee3dbceb7c282c0d163b7cfafa426a96/6bdcf/share-1.png 315w,\n/static/ee3dbceb7c282c0d163b7cfafa426a96/62452/share-1.png 331w\"\n        sizes=\"(max-width: 331px) 100vw, 331px\"\n        style=\"width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;\"\n        loading=\"lazy\"\n        decoding=\"async\"\n      />\n  </a>\n    </span></p>\n<p>팝업 창이 아래 사진처럼 나오게 되면 <code class=\"language-text\">json</code> key 파일에 있는 <strong>client email</strong>을 입력한다.</p>\n<p><span\n      class=\"gatsby-resp-image-wrapper\"\n      style=\"position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 602px; \"\n    >\n      <a\n    class=\"gatsby-resp-image-link\"\n    href=\"/static/ae86f727bbbf4abca8a40bdd1fc1144b/32056/share-2.png\"\n    style=\"display: block\"\n    target=\"_blank\"\n    rel=\"noopener\"\n  >\n    <span\n    class=\"gatsby-resp-image-background-image\"\n    style=\"padding-bottom: 34.177215189873415%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAHCAYAAAAIy204AAAACXBIWXMAAAsTAAALEwEAmpwYAAABCElEQVR42o2PyW7CMBBA859wQ+IKfAYSSfhAuFQtCWSzHW9ZyKscSnsCdaTnGXtGT+NovV6z3W7Z7XYzoX7eQ95sNi95zgaCZ7VaEe33e7TWlGVJVVU0TYMQkqIokFJircUYgzH2BzMT3kM/zEulCJ7lckl0PB6x1nA+n8nznCzLZk6nE23b8i7CInVdz+I0TVksFkRxfKDroRYeqQIdQnpU29Pq4S3ajKh2oB8geH6FxsH1prkVgqKUlJXiklUIaXH+jnXjS1rdo81EHMcPYZIkON/zeblxyUryaz3nRmh8d8e5Eedf4EaMHZgm/oRpmmBNx9dHjlICKQRNU+O9438xzefh8PjyNxmQ5GLpsQJnAAAAAElFTkSuQmCC'); background-size: cover; display: block;\"\n  ></span>\n  <img\n        class=\"gatsby-resp-image-image\"\n        alt=\"share-2\"\n        title=\"\"\n        src=\"/static/ae86f727bbbf4abca8a40bdd1fc1144b/32056/share-2.png\"\n        srcset=\"/static/ae86f727bbbf4abca8a40bdd1fc1144b/c26ae/share-2.png 158w,\n/static/ae86f727bbbf4abca8a40bdd1fc1144b/6bdcf/share-2.png 315w,\n/static/ae86f727bbbf4abca8a40bdd1fc1144b/32056/share-2.png 602w\"\n        sizes=\"(max-width: 602px) 100vw, 602px\"\n        style=\"width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;\"\n        loading=\"lazy\"\n        decoding=\"async\"\n      />\n  </a>\n    </span></p>\n<p>Google Sheet API를 연결하기 위해서 연결할 sheet의 id도 필요하게 된다. 이 id는 해당 sheet의 url에서 확인할 수 있으며 다음과 같다:</p>\n<div class=\"gatsby-highlight\" data-language=\"text\"><pre class=\"language-text\"><code class=\"language-text\">https://docs.google.com/spreadsheets/d/[your-sheet-id]/edit#gid=0</code></pre></div>\n<p>아래와 같이 간단한 데이터셋을 입력하고 다음 단계로 넘어가자.</p>\n<p><span\n      class=\"gatsby-resp-image-wrapper\"\n      style=\"position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 560px; \"\n    >\n      <a\n    class=\"gatsby-resp-image-link\"\n    href=\"/static/85ddd65bbec309cedebf91cb37c143fa/b06ae/test-sheet.png\"\n    style=\"display: block\"\n    target=\"_blank\"\n    rel=\"noopener\"\n  >\n    <span\n    class=\"gatsby-resp-image-background-image\"\n    style=\"padding-bottom: 63.291139240506325%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAANCAYAAACpUE5eAAAACXBIWXMAAAsTAAALEwEAmpwYAAACNUlEQVR42m1T227bMAz1v+4z9ml77lO7oEGaNU3iu5vYiW3d5XvOQHbNBqwECEmQeHiOSAZX32JVbnFbbqjrGlprXqUUGMcRxlhoY+Cc4zPZ7Xb7ciULHqsNvv34DtNbxFGMoigQhiHyPIe1FkIIXK9XCCEhpGRQ8r7vMU0Tuq7j1XvP+6D2Ag/nFcZphFKKQYgRMW2FgLEWVVnC+x5VVaFpGkipUF0u8M7hdD7DGINzWaIsSwTMcwRnJAZF8c6P53lmUO87ljQMA8Zh5JXYUHIpJYY/jEkJnYNxmuC8Y0BiVzcNnPcMSEF9P/CeZJFTMEmzzjFwPwz3t8Q0kErfAz6zW+vQeY/L5Yp5XtinaeZ1Wf53iicVy3JD0DQtsrxAdroge78gLSrk5xpNq9D1PejeWMfSrfPQ2kAI9XG2Ds53EFJBG8v7IMtPSLITHh43ODUewi04yQWr13e8bJ7x9PQTSZKygsNhj/X6Gfv9gc/aaGzWa7xst5BKMcuAsgul8XaIcC5rdMME15PP/F9UuSRJ2NM0RduKe99prfC6+8VsyUh+QFSV1sjSGFEYYrd7hdLq3qhUvSgKmSX1Jr2hQpAZaxAnMReUjP6SAamvojhCGIXI8pzl0CWZkhJpljLDPMsQRxGG4WNiqKoU9wn4l6FSOEZHHI8hxnFiSZ+Vo0ZO0gRRGCFNE+zf9txWnEwrHMPjF4Da8DSUVclA/7ZD27Y8ejwl9ZVHkyaJzHvHMfTXH22z4DfJQd/QrHJOegAAAABJRU5ErkJggg=='); background-size: cover; display: block;\"\n  ></span>\n  <img\n        class=\"gatsby-resp-image-image\"\n        alt=\"test-sheet\"\n        title=\"\"\n        src=\"/static/85ddd65bbec309cedebf91cb37c143fa/b06ae/test-sheet.png\"\n        srcset=\"/static/85ddd65bbec309cedebf91cb37c143fa/c26ae/test-sheet.png 158w,\n/static/85ddd65bbec309cedebf91cb37c143fa/6bdcf/test-sheet.png 315w,\n/static/85ddd65bbec309cedebf91cb37c143fa/b06ae/test-sheet.png 560w\"\n        sizes=\"(max-width: 560px) 100vw, 560px\"\n        style=\"width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;\"\n        loading=\"lazy\"\n        decoding=\"async\"\n      />\n  </a>\n    </span></p>\n<h2>Node.js 어플리케이션 Google Sheet 연동</h2>\n<p>Node.js 어플리케이션이 없는 독자들은 아래와 같이 간단하게 생성하면 된다.</p>\n<ol>\n<li>프로젝트 폴더를 생성한다</li>\n<li>터미널에서 <code class=\"language-text\">npm init -y</code>를 입력한다</li>\n<li><code class=\"language-text\">app.js</code>라는 이름의 파일을 만든다 - <em>이름은 알아서 정해도 된다</em></li>\n</ol>\n<p>google sheet API를 사용하기 위해 필요한 라이브러리를 설치한다.</p>\n<div class=\"gatsby-highlight\" data-language=\"js\"><pre class=\"language-js\"><code class=\"language-js\">npm install <span class=\"token operator\">--</span>save googleapis</code></pre></div>\n<p>아래 코드를 app.js 파일에 복사하여 붙여넣는다.:</p>\n<div class=\"gatsby-highlight\" data-language=\"js\"><pre class=\"language-js\"><code class=\"language-js\"><span class=\"token keyword\">const</span> <span class=\"token punctuation\">{</span> google <span class=\"token punctuation\">}</span> <span class=\"token operator\">=</span> <span class=\"token function\">require</span><span class=\"token punctuation\">(</span><span class=\"token string\">'googleapis'</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\r\n\r\n<span class=\"token keyword\">const</span> clientEmail <span class=\"token operator\">=</span> <span class=\"token string\">'your service account client email'</span><span class=\"token punctuation\">;</span>\r\n<span class=\"token keyword\">const</span> privateKey <span class=\"token operator\">=</span> <span class=\"token string\">'your service account private key'</span><span class=\"token punctuation\">;</span>\r\n<span class=\"token keyword\">const</span> googleSheetId <span class=\"token operator\">=</span> <span class=\"token string\">'your google sheet id'</span><span class=\"token punctuation\">;</span>\r\n<span class=\"token keyword\">const</span> googleSheetPage <span class=\"token operator\">=</span> <span class=\"token string\">'your google sheet page name'</span><span class=\"token punctuation\">;</span>\r\n\r\n<span class=\"token comment\">// authenticate the service account</span>\r\n<span class=\"token keyword\">const</span> googleAuth <span class=\"token operator\">=</span> <span class=\"token keyword\">new</span> <span class=\"token class-name\">google<span class=\"token punctuation\">.</span>auth<span class=\"token punctuation\">.</span>JWT</span><span class=\"token punctuation\">(</span>\r\n    clientEmail<span class=\"token punctuation\">,</span>\r\n    <span class=\"token keyword\">null</span><span class=\"token punctuation\">,</span>\r\n    privateKey<span class=\"token punctuation\">.</span><span class=\"token function\">replace</span><span class=\"token punctuation\">(</span><span class=\"token regex\"><span class=\"token regex-delimiter\">/</span><span class=\"token regex-source language-regex\">\\\\n</span><span class=\"token regex-delimiter\">/</span><span class=\"token regex-flags\">g</span></span><span class=\"token punctuation\">,</span> <span class=\"token string\">'\\n'</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">,</span>\r\n    <span class=\"token string\">'https://www.googleapis.com/auth/spreadsheets'</span>\r\n<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></code></pre></div>\n<p>앞서 언급했듯이 google sheet에 접근하기 위해서 필요한 값들은 <code class=\"language-text\">json</code> key 파일 안에 담긴 <strong>client email, private key</strong>와  <strong>google sheet id, 해당 sheet 이름</strong>이다.\r\n해당 sheet 이름은 화면 아래 탭에 적혀 있다. 위 코드에 각각 알맞은 값을 적어 넣는다.</p>\n<p><span\n      class=\"gatsby-resp-image-wrapper\"\n      style=\"position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 259px; \"\n    >\n      <a\n    class=\"gatsby-resp-image-link\"\n    href=\"/static/40bc58105d6397c3313af7356638d038/a2ead/sheet-name.png\"\n    style=\"display: block\"\n    target=\"_blank\"\n    rel=\"noopener\"\n  >\n    <span\n    class=\"gatsby-resp-image-background-image\"\n    style=\"padding-bottom: 65.82278481012659%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAANCAYAAACpUE5eAAAACXBIWXMAAAsTAAALEwEAmpwYAAABgklEQVR42q1S207jMBDN/3/OvtHdNxDieYUEBQk2DUnaXHyL40vs5CA7m25bBZYHRjqasWc0Pj4zyeA8sl2GojzADg7GWASbpgmXttwFP47jal0iewXKGBgX6GQPpVQs9t6vIuSc93DOrdYlNjDM3pAXexg7wBhzfPkjxEYnDE8RGbYtAaHsSwxDo8DuQ4aDH1EWJQjlUUNrLf5npxpeWmQY2H2bhmHKu3SHLCuOGn6m31FD71dz/xiymaE+GQqwhssvn+cTpTQoIaCUQWuNum7jTpb7Kvolns/zXdiI/G9u8TMqJIGVVAqBqZQ9WsJQHppYeKgJqoYiL6t4rpvwMAdnXfSMClAqQAgDIRxNS5Ew0WEBlz2qpsG+qqCtxWuaYvv8DKk1mBDxg8pp7LsaxlvIoYcwHdzkMYxunjLvJAJCQ6k0Xv6keNg+IazT7d0drjY/0WuDlrIoU0pybLY32Dxe48f9L/wuHkEVR84O5w2XpkL26Hp1HncSlIt5spg+3c93Uz7wa2YdGgUAAAAASUVORK5CYII='); background-size: cover; display: block;\"\n  ></span>\n  <img\n        class=\"gatsby-resp-image-image\"\n        alt=\"sheet-name\"\n        title=\"\"\n        src=\"/static/40bc58105d6397c3313af7356638d038/a2ead/sheet-name.png\"\n        srcset=\"/static/40bc58105d6397c3313af7356638d038/c26ae/sheet-name.png 158w,\n/static/40bc58105d6397c3313af7356638d038/a2ead/sheet-name.png 259w\"\n        sizes=\"(max-width: 259px) 100vw, 259px\"\n        style=\"width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;\"\n        loading=\"lazy\"\n        decoding=\"async\"\n      />\n  </a>\n    </span></p>\n<h2>Sheet 읽기</h2>\n<div class=\"gatsby-highlight\" data-language=\"js\"><pre class=\"language-js\"><code class=\"language-js\"><span class=\"token keyword\">async</span> <span class=\"token keyword\">function</span> <span class=\"token function\">readSheet</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\r\n  <span class=\"token keyword\">try</span> <span class=\"token punctuation\">{</span>\r\n    <span class=\"token comment\">// google sheet instance</span>\r\n    <span class=\"token keyword\">const</span> sheetInstance <span class=\"token operator\">=</span> <span class=\"token keyword\">await</span> google<span class=\"token punctuation\">.</span><span class=\"token function\">sheets</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">{</span> <span class=\"token literal-property property\">version</span><span class=\"token operator\">:</span> <span class=\"token string\">'v4'</span><span class=\"token punctuation\">,</span> <span class=\"token literal-property property\">auth</span><span class=\"token operator\">:</span> googleAuth<span class=\"token punctuation\">}</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\r\n    <span class=\"token comment\">// read data in the range in a sheet</span>\r\n    <span class=\"token keyword\">const</span> infoObjectFromSheet <span class=\"token operator\">=</span> <span class=\"token keyword\">await</span> sheetInstance<span class=\"token punctuation\">.</span>spreadsheets<span class=\"token punctuation\">.</span>values<span class=\"token punctuation\">.</span><span class=\"token function\">get</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">{</span>\r\n        <span class=\"token literal-property property\">auth</span><span class=\"token operator\">:</span> googleAuth<span class=\"token punctuation\">,</span>\r\n        <span class=\"token literal-property property\">spreadsheetId</span><span class=\"token operator\">:</span> googleSheetId<span class=\"token punctuation\">,</span>\r\n        <span class=\"token literal-property property\">range</span><span class=\"token operator\">:</span> <span class=\"token template-string\"><span class=\"token template-punctuation string\">`</span><span class=\"token interpolation\"><span class=\"token interpolation-punctuation punctuation\">${</span>googleSheetPage<span class=\"token interpolation-punctuation punctuation\">}</span></span><span class=\"token string\">!A2:D6</span><span class=\"token template-punctuation string\">`</span></span>\r\n    <span class=\"token punctuation\">}</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\r\n    \r\n    <span class=\"token keyword\">const</span> valuesFromSheet <span class=\"token operator\">=</span> infoObjectFromSheet<span class=\"token punctuation\">.</span>data<span class=\"token punctuation\">.</span>values<span class=\"token punctuation\">;</span>\r\n    console<span class=\"token punctuation\">.</span><span class=\"token function\">log</span><span class=\"token punctuation\">(</span>valuesFromSheet<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\r\n  <span class=\"token punctuation\">}</span>\r\n  <span class=\"token keyword\">catch</span><span class=\"token punctuation\">(</span>err<span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\r\n    console<span class=\"token punctuation\">.</span><span class=\"token function\">log</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"readSheet func() error\"</span><span class=\"token punctuation\">,</span> err<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>  \r\n  <span class=\"token punctuation\">}</span>\r\n<span class=\"token punctuation\">}</span>\r\n\r\n<span class=\"token function\">readSheet</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></code></pre></div>\n<p><strong>readSheet</strong> 함수에서 <strong>get</strong> 메소드를 통해 구글 시트에 적혀 있는 정보가 담긴 객체를 얻을 수 있다. 시트 내 범위를 <strong>A2:D6</strong> 설정해 주었는데 읽어오는 데이터의 행과 열을 나타낸다 - <em>헤더 행을 제외하기 위해 2번째 행부터 시작했다</em>.</p>\n<p>터미널에 <code class=\"language-text\">node app.js</code> 입력하면 다음과 같은 로그를 보게 된다:</p>\n<p><span\n      class=\"gatsby-resp-image-wrapper\"\n      style=\"position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 348px; \"\n    >\n      <a\n    class=\"gatsby-resp-image-link\"\n    href=\"/static/29ccf3de1a9fcc2a40b0b576669ec81d/34ea4/read-data-log.png\"\n    style=\"display: block\"\n    target=\"_blank\"\n    rel=\"noopener\"\n  >\n    <span\n    class=\"gatsby-resp-image-background-image\"\n    style=\"padding-bottom: 37.9746835443038%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAICAYAAAD5nd/tAAAACXBIWXMAAAsTAAALEwEAmpwYAAABZklEQVR42lVS7XKjMAzkUWKDPzD+NgbSpGmadNre+z/Q3sgc1+kPzYhFWmmt7YQQ4JyDnRh4z9EPPfp+D8Ipju9Ww3/XHHVH3jln4cqEfI3ws4MYBKZoEFaPfIl4+Vpg7Ag9KizvBb5YDHxAeU2IZ4fgA5RSYHwf1sXgG+H2UbE+CrZnRbkGSCmRL6mREJZfIrRRbUh9KyjXCFJXX/fcO996Ou8cwuKwPOZ9o+8VafNtKm2RzgGXPyuMMzBuRL4ErM8Cl6ZGsDwyXLbIMUGIAZ33DnH1mG8J9S2j3lMjs3FqhLR5vWcoqRC3vW6+ZWit4GeL+p5hrQMpPbETuhgDQrXYPmaszxk2GBhr2tbUSBsv9wKtdFNAT0BqXLQYrcb5syKWhBgCGBFqrSHk0H4qo5oMuiLletpDatmOJbVo76gmBaVVu+roqF9Aklt6jq6dne22YYz/twrljP3DDpwd+A92WOmwzl8eufHFRMpd2AAAAABJRU5ErkJggg=='); background-size: cover; display: block;\"\n  ></span>\n  <img\n        class=\"gatsby-resp-image-image\"\n        alt=\"read-data-log\"\n        title=\"\"\n        src=\"/static/29ccf3de1a9fcc2a40b0b576669ec81d/34ea4/read-data-log.png\"\n        srcset=\"/static/29ccf3de1a9fcc2a40b0b576669ec81d/c26ae/read-data-log.png 158w,\n/static/29ccf3de1a9fcc2a40b0b576669ec81d/6bdcf/read-data-log.png 315w,\n/static/29ccf3de1a9fcc2a40b0b576669ec81d/34ea4/read-data-log.png 348w\"\n        sizes=\"(max-width: 348px) 100vw, 348px\"\n        style=\"width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;\"\n        loading=\"lazy\"\n        decoding=\"async\"\n      />\n  </a>\n    </span></p>\n<h2>Sheet 삭제</h2>\n<div class=\"gatsby-highlight\" data-language=\"js\"><pre class=\"language-js\"><code class=\"language-js\"><span class=\"token keyword\">async</span> <span class=\"token keyword\">function</span> <span class=\"token function\">clearSheet</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\r\n  <span class=\"token keyword\">try</span> <span class=\"token punctuation\">{</span>\r\n    <span class=\"token comment\">// google sheet instance</span>\r\n    <span class=\"token keyword\">const</span> sheetInstance <span class=\"token operator\">=</span> <span class=\"token keyword\">await</span> google<span class=\"token punctuation\">.</span><span class=\"token function\">sheets</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">{</span> <span class=\"token literal-property property\">version</span><span class=\"token operator\">:</span> <span class=\"token string\">'v4'</span><span class=\"token punctuation\">,</span> <span class=\"token literal-property property\">auth</span><span class=\"token operator\">:</span> googleAuth<span class=\"token punctuation\">}</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\r\n    <span class=\"token comment\">// clear data in the range</span>\r\n    <span class=\"token keyword\">await</span> sheetInstance<span class=\"token punctuation\">.</span>spreadsheets<span class=\"token punctuation\">.</span>values<span class=\"token punctuation\">.</span><span class=\"token function\">clear</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">{</span>\r\n        <span class=\"token literal-property property\">auth</span><span class=\"token operator\">:</span> googleAuth<span class=\"token punctuation\">,</span>\r\n        <span class=\"token literal-property property\">spreadsheetId</span><span class=\"token operator\">:</span> googleSheetId<span class=\"token punctuation\">,</span>\r\n        <span class=\"token literal-property property\">range</span><span class=\"token operator\">:</span> <span class=\"token template-string\"><span class=\"token template-punctuation string\">`</span><span class=\"token interpolation\"><span class=\"token interpolation-punctuation punctuation\">${</span>googleSheetPage<span class=\"token interpolation-punctuation punctuation\">}</span></span><span class=\"token string\">!A2:D6</span><span class=\"token template-punctuation string\">`</span></span><span class=\"token punctuation\">,</span>\r\n    <span class=\"token punctuation\">}</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\r\n  <span class=\"token punctuation\">}</span>\r\n  <span class=\"token keyword\">catch</span><span class=\"token punctuation\">(</span>err<span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\r\n    console<span class=\"token punctuation\">.</span><span class=\"token function\">log</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"clearSheet func() error\"</span><span class=\"token punctuation\">,</span> err<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>  \r\n  <span class=\"token punctuation\">}</span>\r\n<span class=\"token punctuation\">}</span>\r\n\r\n<span class=\"token function\">clearSheet</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></code></pre></div>\n<p><strong>clear</strong> 메소드로 행과 열에 담긴 데이터를 삭제할 수 있다. 어플리케이션을 실행하면 지정한 범위 내의 행과 열에 담긴 데이터가 삭제된다.</p>\n<h2>Sheet 업데이트</h2>\n<div class=\"gatsby-highlight\" data-language=\"js\"><pre class=\"language-js\"><code class=\"language-js\"><span class=\"token keyword\">async</span> <span class=\"token keyword\">function</span> <span class=\"token function\">updateSheet</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\r\n  <span class=\"token keyword\">try</span> <span class=\"token punctuation\">{</span>\r\n    <span class=\"token comment\">// google sheet instance</span>\r\n    <span class=\"token keyword\">const</span> sheetInstance <span class=\"token operator\">=</span> <span class=\"token keyword\">await</span> google<span class=\"token punctuation\">.</span><span class=\"token function\">sheets</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">{</span> <span class=\"token literal-property property\">version</span><span class=\"token operator\">:</span> <span class=\"token string\">'v4'</span><span class=\"token punctuation\">,</span> <span class=\"token literal-property property\">auth</span><span class=\"token operator\">:</span> googleAuth<span class=\"token punctuation\">}</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\r\n\r\n    <span class=\"token keyword\">const</span> updateToGsheet <span class=\"token operator\">=</span> <span class=\"token punctuation\">[</span>\r\n      <span class=\"token punctuation\">[</span> <span class=\"token string\">'Seoul'</span><span class=\"token punctuation\">,</span> <span class=\"token string\">'9,776,000'</span><span class=\"token punctuation\">,</span> <span class=\"token string\">'Asia'</span><span class=\"token punctuation\">,</span> <span class=\"token string\">'KRW'</span> <span class=\"token punctuation\">]</span><span class=\"token punctuation\">,</span>\r\n      <span class=\"token punctuation\">[</span> <span class=\"token string\">'Copenhagen'</span><span class=\"token punctuation\">,</span> <span class=\"token string\">'602,000'</span><span class=\"token punctuation\">,</span> <span class=\"token string\">'Europe'</span><span class=\"token punctuation\">,</span> <span class=\"token string\">'EUR'</span> <span class=\"token punctuation\">]</span><span class=\"token punctuation\">,</span>\r\n      <span class=\"token punctuation\">[</span> <span class=\"token string\">'Amsterdam'</span><span class=\"token punctuation\">,</span> <span class=\"token string\">'821,000'</span><span class=\"token punctuation\">,</span> <span class=\"token string\">'Europe'</span><span class=\"token punctuation\">,</span> <span class=\"token string\">'EUR'</span> <span class=\"token punctuation\">]</span><span class=\"token punctuation\">,</span>\r\n      <span class=\"token punctuation\">[</span> <span class=\"token string\">'Helsinki'</span><span class=\"token punctuation\">,</span> <span class=\"token string\">'631,000'</span><span class=\"token punctuation\">,</span> <span class=\"token string\">'Europe'</span><span class=\"token punctuation\">,</span> <span class=\"token string\">'EUR'</span> <span class=\"token punctuation\">]</span><span class=\"token punctuation\">,</span>\r\n      <span class=\"token punctuation\">[</span> <span class=\"token string\">'Sydney'</span><span class=\"token punctuation\">,</span> <span class=\"token string\">'5,312,000'</span><span class=\"token punctuation\">,</span> <span class=\"token string\">'Oceania'</span><span class=\"token punctuation\">,</span> <span class=\"token string\">'AUD'</span> <span class=\"token punctuation\">]</span>\r\n    <span class=\"token punctuation\">]</span><span class=\"token punctuation\">;</span>\r\n    \r\n    <span class=\"token comment\">// update data in the range</span>\r\n    <span class=\"token keyword\">await</span> sheetInstance<span class=\"token punctuation\">.</span>spreadsheets<span class=\"token punctuation\">.</span>values<span class=\"token punctuation\">.</span><span class=\"token function\">update</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">{</span>\r\n        <span class=\"token literal-property property\">auth</span><span class=\"token operator\">:</span> googleAuth<span class=\"token punctuation\">,</span>\r\n        <span class=\"token literal-property property\">spreadsheetId</span><span class=\"token operator\">:</span> googleSheetId<span class=\"token punctuation\">,</span>\r\n        <span class=\"token literal-property property\">range</span><span class=\"token operator\">:</span> <span class=\"token template-string\"><span class=\"token template-punctuation string\">`</span><span class=\"token interpolation\"><span class=\"token interpolation-punctuation punctuation\">${</span>googleSheetPage<span class=\"token interpolation-punctuation punctuation\">}</span></span><span class=\"token string\">!A2:D6</span><span class=\"token template-punctuation string\">`</span></span><span class=\"token punctuation\">,</span>\r\n        <span class=\"token literal-property property\">valueInputOption</span><span class=\"token operator\">:</span> <span class=\"token string\">'RAW'</span><span class=\"token punctuation\">,</span>\r\n        <span class=\"token literal-property property\">resource</span><span class=\"token operator\">:</span> <span class=\"token punctuation\">{</span>\r\n          <span class=\"token literal-property property\">values</span><span class=\"token operator\">:</span> updateToGsheet<span class=\"token punctuation\">,</span>\r\n        <span class=\"token punctuation\">}</span><span class=\"token punctuation\">,</span>\r\n    <span class=\"token punctuation\">}</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\r\n  <span class=\"token punctuation\">}</span>\r\n  <span class=\"token keyword\">catch</span><span class=\"token punctuation\">(</span>err<span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\r\n    console<span class=\"token punctuation\">.</span><span class=\"token function\">log</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"updateSheet func() error\"</span><span class=\"token punctuation\">,</span> err<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>  \r\n  <span class=\"token punctuation\">}</span>\r\n<span class=\"token punctuation\">}</span>\r\n\r\n<span class=\"token function\">updateSheet</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></code></pre></div>\n<p><strong>update</strong> 메소드로 지정된 범위의 값들을 업데이트 시킬 수 있다. 값들은 배열의 배열이어야 하며 지정된 행과 열과 크기가 동일한지 확인할 필요가 있다. <strong>updateToGsheet</strong> 변수의 처음 인자가 <strong>A2부터 D2</strong>에 입력되고 다음 인자가 <strong>A3부터 D3</strong>에 입력되며 차례대로 이 같은 방법으로 입력된다.</p>\n<p>어플리케이션을 실행하고 시트 안에 값들이 변했는지 확인한다 - <em>지정된 행과 열에 값이 있었다면 새로운 값으로 덮어 씌어진다</em>.</p>\n<h2>결론</h2>\n<p>간단하게 Node.js로 Google Sheet API를 연결하여 읽기, 쓰기, 삭제하는 방법을 알아보았다. 간단한 모델이기에 독자들이 본인의 의도에 맞게 추가 개발하여 심화시키면 좋을 거 같다.</p>\n<p><em><strong>읽어 주셔서 감사합니다. To be continued!</strong></em></p>\n<p><em>이 글은 <a href=\"https://medium.com/@shkim04/beginner-guide-on-google-sheet-api-for-node-js-4c0b533b071a\">Medium</a>에도 업로드 되었습니다.</em>\r\n<em>놀러 오세요!</em></p>","frontmatter":{"title":"Node.js에서 Googe Sheet API 사용하기","date":"2023년 01월 03일","description":"Node.js에 Google Sheet API 연결하여 구글 시트에 담긴 데이터 읽기, 쓰기, 삭제","tag":["NodeJS","Cloud"]},"fields":{"locale":"ko"}},"previous":{"fields":{"slug":"/react-native-modal-구현하기"},"frontmatter":{"title":"React Native Modal Expo로 구현하기"}},"next":{"fields":{"slug":"/react-native-modal-구현하기"},"frontmatter":{"title":"React Native Modal Expo로 구현하기"}}},"pageContext":{"locale":"ko","isDefaultLang":true,"slug":"/nodejs-에서-google-sheet-사용하는법","titleByLang":{"ko":"nodejs-에서-google-sheet-사용하는법","en":"how-to-use-google-sheet-on-nodejs"},"dateFormat":"YYYY년 MM월 DD일","id":"689a5c96-867e-5aba-b0ac-c0b545647a5a"}},"staticQueryHashes":[],"slicesMap":{}}