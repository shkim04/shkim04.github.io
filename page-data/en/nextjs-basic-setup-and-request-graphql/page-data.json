{"componentChunkName":"component---src-templates-blog-post-js","path":"/en/nextjs-basic-setup-and-request-graphql/","result":{"data":{"site":{"siteMetadata":{"title":"Seunghyun's Blog"}},"markdownRemark":{"id":"4db06414-8370-57fa-83c0-e34041a8a65f","excerpt":"Now that I have Nestjs-graphql backend to do CRUD operation for toilets information, I will create a simple Nextjs application that interacts with the…","html":"<p>Now that I have Nestjs-graphql backend to do CRUD operation for toilets information, I will create a simple Nextjs application that interacts with the information. Let's dive into it.</p>\n<h2>Create Nextjs app</h2>\n<div class=\"gatsby-highlight\" data-language=\"bash\"><pre class=\"language-bash\"><code class=\"language-bash\">npx create-next-app</code></pre></div>\n<p>Once you enter the command as shown above, the prompts will show up:</p>\n<div class=\"gatsby-highlight\" data-language=\"text\"><pre class=\"language-text\"><code class=\"language-text\">What is your project named? my-app\nWould you like to use TypeScript? No / Yes\nWould you like to use ESLint? No / Yes\nWould you like to use Tailwind CSS? No / Yes\nWould you like to use `src/` directory? No / Yes\nWould you like to use App Router? (recommended) No / Yes\nWould you like to customize the default import alias? No / Yes\nWhat import alias would you like configured? @/*</code></pre></div>\n<p>We will choose <code class=\"language-text\">Yes</code> for every prompt because they seem to make development easier.</p>\n<h2>Create dynamic routes</h2>\n<p>I would like to have pages that shows dynamically a list of toilets information by country, city and street. According to the official documentation, dynamci routes of App Router can be achieved by a folder name wrapped around the square brackets like <code class=\"language-text\">[country]</code> or <code class=\"language-text\">[city]</code>. Country, city and street are dependent on one another so, the route would look like <code class=\"language-text\">[country]/[city]/[street]</code>.</p>\n<p>To accomplish the goal, we will create a folder named <code class=\"language-text\">toilets</code> which will become a route represented as <code class=\"language-text\">/toilets</code>. And then, <code class=\"language-text\">[country]</code> will be placed under <code class=\"language-text\">toilets</code> folder. By the same token, <code class=\"language-text\">[city]</code> and <code class=\"language-text\">[street]</code> will be placed under <code class=\"language-text\">[country]</code> and <code class=\"language-text\">[city]</code> respectively.</p>\n<div class=\"gatsby-highlight\" data-language=\"text\"><pre class=\"language-text\"><code class=\"language-text\">src/app\n└── toilets\n    ├── [country]\n    │   ├── [city]\n    │   │   ├── [street]\n    │   │   │   └── page.tsx\n    │   │   └── page.tsx\n    │   └── page.tsx\n    └── page.tsx</code></pre></div>\n<h2>Add test toilets</h2>\n<p>To see if Nestjs-graphql server still works well, we will add test toilets using <em>playground</em>. And then, these test toilets information will be used in the Nextjs application.</p>\n<p><span\n      class=\"gatsby-resp-image-wrapper\"\n      style=\"position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 630px; \"\n    >\n      <a\n    class=\"gatsby-resp-image-link\"\n    href=\"/static/e0fc2e2bc7b64cfeddc73047a5e92a27/c7dcc/test-toilets-playground.png\"\n    style=\"display: block\"\n    target=\"_blank\"\n    rel=\"noopener\"\n  >\n    <span\n    class=\"gatsby-resp-image-background-image\"\n    style=\"padding-bottom: 104.43037974683544%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAVCAYAAABG1c6oAAAACXBIWXMAABYlAAAWJQFJUiTwAAACDElEQVR42qVV2XLaQBDkK9idJam4UuVUGaH7PlZSjAnBjv//czo1s8ICHmIgD420i9Q1092zWjzGJYKyxPekgQlHkN9Bec3dWCy9BpTsQMkelP6CiX7CbDqodXMXFsyqmTSwUL6F3jRQYYtl2EEdEbQOobvqqJvXp8/5rSNU6xo6GGDyV6mQmi2+1BZfmx46H0DlAJ330FkvV2pG6MSC6lH+o2qQPQq7idCroX0Lyg9CStEW36IeP5IW5E3teDe0LBWyIcUbTPbbVZm9g+I91FN1TvaZKR+LTeda5grzA1ZBDzpqNOkm2m2uJeS2Q67sIFVSZJ021SDaUTFAp2xaex3hkgmjZxC3HL+AYiYbndhp7154uqFljgs7LZmMt6BgkGrE2ayH+qSyM0J+0XAOvRpqXTnw/WSY4NpJ4R8et1VgsWRHuRJ286meyQTT3iVO989aZlfjLbTfQqcdVDFgydpldgq1hS7clcppXU+BLyYEJ8FWfg9TvMJke+jsBQ9phce8BCX2IzL6eB/beR26tWJszkavh5HIHMSQVXrAQ7aDFk1Pp6G+kONEHq+5mOXq3QU73cHEWyh/nHU6Jbgu2O4YMzzPxR8Y1jS3oHZ0B8Ix5JH9J+lMyFXKDO8l2KwLkwnYHL91uHZSHOEzTPkmpOJ40jvCanRktxwOxu8u5rS97xMwT8r/fUuOhH8BeQt3j17kO+gAAAAASUVORK5CYII='); background-size: cover; display: block;\"\n  ></span>\n  <img\n        class=\"gatsby-resp-image-image\"\n        alt=\"test-toilets-playground\"\n        title=\"\"\n        src=\"/static/e0fc2e2bc7b64cfeddc73047a5e92a27/f058b/test-toilets-playground.png\"\n        srcset=\"/static/e0fc2e2bc7b64cfeddc73047a5e92a27/c26ae/test-toilets-playground.png 158w,\n/static/e0fc2e2bc7b64cfeddc73047a5e92a27/6bdcf/test-toilets-playground.png 315w,\n/static/e0fc2e2bc7b64cfeddc73047a5e92a27/f058b/test-toilets-playground.png 630w,\n/static/e0fc2e2bc7b64cfeddc73047a5e92a27/c7dcc/test-toilets-playground.png 641w\"\n        sizes=\"(max-width: 630px) 100vw, 630px\"\n        style=\"width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;\"\n        loading=\"lazy\"\n        decoding=\"async\"\n      />\n  </a>\n    </span></p>\n<h2>Display test toilets by city</h2>\n<p>Let's retrieve the toilets in <strong>Jeonju</strong>. In order to do it, we should make a query request. With App Router, we can do by simply using <strong>fetch</strong>. Write the code below in <code class=\"language-text\">page.tsx</code> under <code class=\"language-text\">[city]</code> folder:</p>\n<div class=\"gatsby-highlight\" data-language=\"js\"><pre class=\"language-js\"><code class=\"language-js\"><span class=\"token keyword\">async</span> <span class=\"token keyword\">function</span> <span class=\"token function\">getData</span><span class=\"token punctuation\">(</span><span class=\"token parameter\"><span class=\"token literal-property property\">city</span><span class=\"token operator\">:</span> string</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n  <span class=\"token keyword\">const</span> res <span class=\"token operator\">=</span> <span class=\"token keyword\">await</span> <span class=\"token function\">fetch</span><span class=\"token punctuation\">(</span><span class=\"token string\">'http://localhost:4000/graphql'</span><span class=\"token punctuation\">,</span> <span class=\"token punctuation\">{</span>\n    <span class=\"token literal-property property\">method</span><span class=\"token operator\">:</span> <span class=\"token string\">'POST'</span><span class=\"token punctuation\">,</span>\n    <span class=\"token literal-property property\">body</span><span class=\"token operator\">:</span> <span class=\"token constant\">JSON</span><span class=\"token punctuation\">.</span><span class=\"token function\">stringify</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">{</span>\n      <span class=\"token literal-property property\">query</span><span class=\"token operator\">:</span> <span class=\"token template-string\"><span class=\"token template-punctuation string\">`</span><span class=\"token string\">{ toilets(city: \"</span><span class=\"token interpolation\"><span class=\"token interpolation-punctuation punctuation\">${</span>city<span class=\"token interpolation-punctuation punctuation\">}</span></span><span class=\"token string\">\") {\n        id\n        price\n        isPaid\n        address {\n          street\n          city\n          country\n        }\n      }}</span><span class=\"token template-punctuation string\">`</span></span><span class=\"token punctuation\">,</span>\n    <span class=\"token punctuation\">}</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">,</span>\n    <span class=\"token literal-property property\">headers</span><span class=\"token operator\">:</span> <span class=\"token punctuation\">{</span>\n      <span class=\"token string-property property\">'Content-Type'</span><span class=\"token operator\">:</span> <span class=\"token string\">'application/json'</span><span class=\"token punctuation\">,</span>\n    <span class=\"token punctuation\">}</span><span class=\"token punctuation\">,</span>\n    <span class=\"token literal-property property\">next</span><span class=\"token operator\">:</span> <span class=\"token punctuation\">{</span> <span class=\"token literal-property property\">revalidate</span><span class=\"token operator\">:</span> <span class=\"token number\">10</span> <span class=\"token punctuation\">}</span><span class=\"token punctuation\">,</span>\n  <span class=\"token punctuation\">}</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n\n  <span class=\"token keyword\">if</span> <span class=\"token punctuation\">(</span><span class=\"token operator\">!</span>res<span class=\"token punctuation\">.</span>ok<span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n    <span class=\"token keyword\">throw</span> <span class=\"token keyword\">new</span> <span class=\"token class-name\">Error</span><span class=\"token punctuation\">(</span><span class=\"token string\">'Failed to fetch toilet data in a city'</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n  <span class=\"token punctuation\">}</span>\n  <span class=\"token keyword\">const</span> dataObj <span class=\"token operator\">=</span> <span class=\"token keyword\">await</span> res<span class=\"token punctuation\">.</span><span class=\"token function\">json</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n  <span class=\"token keyword\">return</span> dataObj<span class=\"token punctuation\">.</span>data<span class=\"token punctuation\">;</span>\n<span class=\"token punctuation\">}</span>\n\n<span class=\"token keyword\">export</span> <span class=\"token keyword\">default</span> <span class=\"token keyword\">async</span> <span class=\"token keyword\">function</span> <span class=\"token function\">City</span><span class=\"token punctuation\">(</span><span class=\"token parameter\"><span class=\"token punctuation\">{</span> params <span class=\"token punctuation\">}</span><span class=\"token operator\">:</span> <span class=\"token punctuation\">{</span> <span class=\"token literal-property property\">params</span><span class=\"token operator\">:</span> <span class=\"token punctuation\">{</span> <span class=\"token literal-property property\">city</span><span class=\"token operator\">:</span> string <span class=\"token punctuation\">}</span> <span class=\"token punctuation\">}</span></span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n  <span class=\"token keyword\">const</span> <span class=\"token punctuation\">{</span> toilets <span class=\"token punctuation\">}</span> <span class=\"token operator\">=</span> <span class=\"token keyword\">await</span> <span class=\"token function\">getData</span><span class=\"token punctuation\">(</span>params<span class=\"token punctuation\">.</span>city<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n  <span class=\"token keyword\">return</span> <span class=\"token punctuation\">(</span>\n    <span class=\"token operator\">&lt;</span>main className<span class=\"token operator\">=</span><span class=\"token string\">'flex min-h-screen flex-col items-center justify-between p-24'</span><span class=\"token operator\">></span>\n      <span class=\"token operator\">&lt;</span>div className<span class=\"token operator\">=</span><span class=\"token string\">'z-10 max-w-5xl flex-col w-full items-center justify-between font-mono text-sm lg:flex'</span><span class=\"token operator\">></span>\n        <span class=\"token punctuation\">{</span>toilets<span class=\"token punctuation\">.</span><span class=\"token function\">map</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">(</span><span class=\"token parameter\"><span class=\"token literal-property property\">toilet</span><span class=\"token operator\">:</span> any<span class=\"token punctuation\">,</span> <span class=\"token literal-property property\">index</span><span class=\"token operator\">:</span> number</span><span class=\"token punctuation\">)</span> <span class=\"token operator\">=></span> <span class=\"token punctuation\">{</span>\n          <span class=\"token keyword\">return</span> <span class=\"token punctuation\">(</span>\n            <span class=\"token operator\">&lt;</span>p\n              key<span class=\"token operator\">=</span><span class=\"token punctuation\">{</span>index<span class=\"token punctuation\">}</span>\n              className<span class=\"token operator\">=</span><span class=\"token string\">'flex flex-col w-full justify-center border-b border-gray-300 bg-gradient-to-b from-zinc-200 pb-6 pt-8 backdrop-blur-2xl dark:border-neutral-800 dark:bg-zinc-800/30 dark:from-inherit lg:static lg:w-auto  lg:rounded-xl lg:border lg:bg-gray-200 lg:p-4 lg:dark:bg-zinc-800/30'</span>\n            <span class=\"token operator\">></span>\n              <span class=\"token operator\">&lt;</span>span className<span class=\"token operator\">=</span><span class=\"token string\">'w-full'</span><span class=\"token operator\">></span><span class=\"token constant\">ID</span><span class=\"token operator\">:</span> <span class=\"token punctuation\">{</span>toilet<span class=\"token punctuation\">.</span>id<span class=\"token punctuation\">}</span><span class=\"token operator\">&lt;</span><span class=\"token operator\">/</span>span<span class=\"token operator\">></span>\n              <span class=\"token operator\">&lt;</span>br <span class=\"token operator\">/</span><span class=\"token operator\">></span>\n              <span class=\"token operator\">&lt;</span>span className<span class=\"token operator\">=</span><span class=\"token string\">'w-full'</span><span class=\"token operator\">></span>Price<span class=\"token operator\">:</span> <span class=\"token punctuation\">{</span>toilet<span class=\"token punctuation\">.</span>price<span class=\"token punctuation\">}</span><span class=\"token operator\">&lt;</span><span class=\"token operator\">/</span>span<span class=\"token operator\">></span>\n              <span class=\"token operator\">&lt;</span>br <span class=\"token operator\">/</span><span class=\"token operator\">></span>\n              <span class=\"token operator\">&lt;</span>span className<span class=\"token operator\">=</span><span class=\"token string\">'w-full'</span><span class=\"token operator\">></span>Country<span class=\"token operator\">:</span> <span class=\"token punctuation\">{</span>toilet<span class=\"token punctuation\">.</span>address<span class=\"token punctuation\">.</span>country<span class=\"token punctuation\">}</span><span class=\"token operator\">&lt;</span><span class=\"token operator\">/</span>span<span class=\"token operator\">></span>\n              <span class=\"token operator\">&lt;</span>br <span class=\"token operator\">/</span><span class=\"token operator\">></span>\n              <span class=\"token operator\">&lt;</span>span className<span class=\"token operator\">=</span><span class=\"token string\">'w-full'</span><span class=\"token operator\">></span>City<span class=\"token operator\">:</span> <span class=\"token punctuation\">{</span>toilet<span class=\"token punctuation\">.</span>address<span class=\"token punctuation\">.</span>city<span class=\"token punctuation\">}</span><span class=\"token operator\">&lt;</span><span class=\"token operator\">/</span>span<span class=\"token operator\">></span>\n              <span class=\"token operator\">&lt;</span>br <span class=\"token operator\">/</span><span class=\"token operator\">></span>\n              <span class=\"token operator\">&lt;</span>span className<span class=\"token operator\">=</span><span class=\"token string\">'w-full'</span><span class=\"token operator\">></span>Street<span class=\"token operator\">:</span> <span class=\"token punctuation\">{</span>toilet<span class=\"token punctuation\">.</span>address<span class=\"token punctuation\">.</span>street<span class=\"token punctuation\">}</span><span class=\"token operator\">&lt;</span><span class=\"token operator\">/</span>span<span class=\"token operator\">></span>\n            <span class=\"token operator\">&lt;</span><span class=\"token operator\">/</span>p<span class=\"token operator\">></span>\n          <span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n        <span class=\"token punctuation\">}</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">}</span>\n      <span class=\"token operator\">&lt;</span><span class=\"token operator\">/</span>div<span class=\"token operator\">></span>\n    <span class=\"token operator\">&lt;</span><span class=\"token operator\">/</span>main<span class=\"token operator\">></span>\n  <span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n<span class=\"token punctuation\">}</span></code></pre></div>\n<p>The parameter, which contains a city name, will be passed to the <strong>City</strong> component, when a use hits the url that looks like <em><a href=\"https://your-website.com/toilets/a-country-name/a-city-name\">https://your-website.com/toilets/a-country-name/a-city-name</a></em>. The city name will go and form a complete query in <code class=\"language-text\">getData</code> function. Once the component gets the toilets information that match the query sent, These toilets information will show up on the browser like:</p>\n<p><span\n      class=\"gatsby-resp-image-wrapper\"\n      style=\"position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 630px; \"\n    >\n      <a\n    class=\"gatsby-resp-image-link\"\n    href=\"/static/9c348002ea151ba21c7a064838103b29/ae694/test-toilets-info.png\"\n    style=\"display: block\"\n    target=\"_blank\"\n    rel=\"noopener\"\n  >\n    <span\n    class=\"gatsby-resp-image-background-image\"\n    style=\"padding-bottom: 72.78481012658227%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAPCAYAAADkmO9VAAAACXBIWXMAABYlAAAWJQFJUiTwAAABsElEQVR42pXT25KjIBQFUP7/z7oSc4/xhtxBUduku+Z5T0HiDJXkJQ+rzkFro4CSsmohpYUxPaz1cNbHGszzL263Px8hFWVouAAVEpTLe330TGpwZT5CCkpxad7L6+ZjpGIcz0rGHnhUJXXpyze5gITlplqhwKWJyw3CuOUqbkHs4/jeh615zpNWKiyY0qgpw/GYY73e4utrjTwvcToVOOcFjsdLvLc/nLHfn8HE/+yCcK2xEMagoRyb7QGHY45ss4eQBtYNULqDNh10UqW2SPMBkcZioaxD0wqs1tv4Fqtsh/BZtUzBWP9CmQ5pPiDadUgJfZ+UCY2WazStBBMGrhthH4wbYtW2x3OemL7HwnoPJlVcdlHWqCoK+ugvlwpF0cS9DMJYGYc0HxDnByy6YYyTrbMdsmyH1WoD2op4rQk/ABWom3sN17TtkOYD0o8jFn6awLhClu1xOhfxUML+WefjwbjuLvRR55HmAzJM31iM3zO40NgdzjjlJbLNAae8Qn6p4yHolPFw/YA0H5BpnpEKk07zFeN8jXV5kB+nF+Hec57MtxtS15f686++85z/C9HdSad/2j98AAAAAElFTkSuQmCC'); background-size: cover; display: block;\"\n  ></span>\n  <img\n        class=\"gatsby-resp-image-image\"\n        alt=\"test-toilets-info\"\n        title=\"\"\n        src=\"/static/9c348002ea151ba21c7a064838103b29/f058b/test-toilets-info.png\"\n        srcset=\"/static/9c348002ea151ba21c7a064838103b29/c26ae/test-toilets-info.png 158w,\n/static/9c348002ea151ba21c7a064838103b29/6bdcf/test-toilets-info.png 315w,\n/static/9c348002ea151ba21c7a064838103b29/f058b/test-toilets-info.png 630w,\n/static/9c348002ea151ba21c7a064838103b29/ae694/test-toilets-info.png 850w\"\n        sizes=\"(max-width: 630px) 100vw, 630px\"\n        style=\"width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;\"\n        loading=\"lazy\"\n        decoding=\"async\"\n      />\n  </a>\n    </span></p>\n<p>For now, I have just focused on creating simple dynamic routes and making a graphql request. Not only will I improve the frontend with Typescript and Tailwind, but also have more details on the backend when there is a room for improvement interacting with the frontend.</p>\n<p><em><strong>THANKS FOR READING. SEE YOU NEXT TIME!</strong></em></p>\n<h3>References</h3>\n<ul>\n<li><a href=\"https://nextjs.org/docs/app/building-your-application/routing/defining-routes\">https://nextjs.org/docs/app/building-your-application/routing/defining-routes</a></li>\n<li><a href=\"https://nextjs.org/docs/app/building-your-application/data-fetching/fetching-caching-and-revalidating\">https://nextjs.org/docs/app/building-your-application/data-fetching/fetching-caching-and-revalidating</a></li>\n</ul>","frontmatter":{"title":"#10 Nextjs basic setup and GraphQL request","date":"13 Sep, 2023","description":"","tag":["Project","React"]},"fields":{"locale":"en"}},"previous":{"fields":{"slug":"/en/nestjs-graphql-logging-and-exception-handling"},"frontmatter":{"title":"#9 Nestjs Graphql logging and exception handling"}},"next":{"fields":{"slug":"/en/nextjs-graphql-mutation-query-using-app-router"},"frontmatter":{"title":"#11 Nextjs Graphql mutation query using App router"}}},"pageContext":{"locale":"en","isDefaultLang":false,"slug":"/en/nextjs-basic-setup-and-request-graphql","titleByLang":{"ko":"nextjs-기본-설정-및-graphql-요청","en":"nextjs-basic-setup-and-request-graphql"},"dateFormat":"DD MMM, YYYY","id":"4db06414-8370-57fa-83c0-e34041a8a65f","previousPostId":"27b4496d-afc9-549d-b72c-d019f8ff41af","nextPostId":"0eb72de5-cd51-5e81-a2e0-31151c0eacbf"}},"staticQueryHashes":[],"slicesMap":{}}