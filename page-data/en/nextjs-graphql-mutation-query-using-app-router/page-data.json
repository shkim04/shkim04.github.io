{"componentChunkName":"component---src-templates-blog-post-js","path":"/en/nextjs-graphql-mutation-query-using-app-router/","result":{"data":{"site":{"siteMetadata":{"title":"Seunghyun's Blog"}},"markdownRemark":{"id":"0eb72de5-cd51-5e81-a2e0-31151c0eacbf","excerpt":"The web application has pages that dynamically show toilets information by a country, city and street. However, users should be able to register a toilet by…","html":"<p>The web application has pages that dynamically show toilets information by a country, city and street. However, users should be able to register a toilet by giving us an address and review about the toilet in the first place. So, we will create a route named <code class=\"language-text\">/contribute</code> that write a form that contains toilet information and make graphql mutation query using it.</p>\n<h2>Create contribute component</h2>\n<p>We can have <code class=\"language-text\">/contribute</code> route by creating a folder named <code class=\"language-text\">contribute</code> as shown below.</p>\n<div class=\"gatsby-highlight\" data-language=\"text\"><pre class=\"language-text\"><code class=\"language-text\">src/app\n├── contribute\n│   └── page.tsx\n└── toilets\n    ├── [country]\n    │   ├── [city]\n    │   │   ├── [street]\n    │   │   │   └── page.tsx\n    │   │   └── page.tsx\n    │   └── page.tsx\n    └── page.tsx</code></pre></div>\n<p>Write the following code in <code class=\"language-text\">page.tsx</code> under <code class=\"language-text\">contribute</code> folder.</p>\n<div class=\"gatsby-highlight\" data-language=\"js\"><pre class=\"language-js\"><code class=\"language-js\"><span class=\"token string\">'use client'</span><span class=\"token punctuation\">;</span>\n<span class=\"token keyword\">import</span> <span class=\"token punctuation\">{</span> useState<span class=\"token punctuation\">,</span> useRef <span class=\"token punctuation\">}</span> <span class=\"token keyword\">from</span> <span class=\"token string\">'react'</span><span class=\"token punctuation\">;</span>\n<span class=\"token keyword\">import</span> create <span class=\"token keyword\">from</span> <span class=\"token string\">'./action'</span><span class=\"token punctuation\">;</span>\n\n<span class=\"token keyword\">export</span> <span class=\"token keyword\">default</span> <span class=\"token keyword\">function</span> <span class=\"token function\">Contribute</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n  <span class=\"token keyword\">const</span> <span class=\"token punctuation\">[</span>paid<span class=\"token punctuation\">,</span> setPaid<span class=\"token punctuation\">]</span> <span class=\"token operator\">=</span> <span class=\"token function\">useState</span><span class=\"token punctuation\">(</span><span class=\"token string\">''</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n  <span class=\"token keyword\">const</span> priceRef <span class=\"token operator\">=</span> useRef<span class=\"token operator\">&lt;</span>HTMLInputElement<span class=\"token operator\">></span><span class=\"token punctuation\">(</span><span class=\"token keyword\">null</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n  <span class=\"token keyword\">const</span> streetNumberRef <span class=\"token operator\">=</span> useRef<span class=\"token operator\">&lt;</span>HTMLInputElement<span class=\"token operator\">></span><span class=\"token punctuation\">(</span><span class=\"token keyword\">null</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n  <span class=\"token keyword\">const</span> streetRef <span class=\"token operator\">=</span> useRef<span class=\"token operator\">&lt;</span>HTMLInputElement<span class=\"token operator\">></span><span class=\"token punctuation\">(</span><span class=\"token keyword\">null</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n  <span class=\"token keyword\">const</span> cityRef <span class=\"token operator\">=</span> useRef<span class=\"token operator\">&lt;</span>HTMLInputElement<span class=\"token operator\">></span><span class=\"token punctuation\">(</span><span class=\"token keyword\">null</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n  <span class=\"token keyword\">const</span> countryRef <span class=\"token operator\">=</span> useRef<span class=\"token operator\">&lt;</span>HTMLInputElement<span class=\"token operator\">></span><span class=\"token punctuation\">(</span><span class=\"token keyword\">null</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n  <span class=\"token keyword\">const</span> emailRef <span class=\"token operator\">=</span> useRef<span class=\"token operator\">&lt;</span>HTMLInputElement<span class=\"token operator\">></span><span class=\"token punctuation\">(</span><span class=\"token keyword\">null</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n  <span class=\"token keyword\">const</span> passwordRef <span class=\"token operator\">=</span> useRef<span class=\"token operator\">&lt;</span>HTMLInputElement<span class=\"token operator\">></span><span class=\"token punctuation\">(</span><span class=\"token keyword\">null</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n  <span class=\"token keyword\">const</span> cleanlinessRef <span class=\"token operator\">=</span> useRef<span class=\"token operator\">&lt;</span>HTMLInputElement<span class=\"token operator\">></span><span class=\"token punctuation\">(</span><span class=\"token keyword\">null</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n  <span class=\"token keyword\">const</span> performanceRef <span class=\"token operator\">=</span> useRef<span class=\"token operator\">&lt;</span>HTMLInputElement<span class=\"token operator\">></span><span class=\"token punctuation\">(</span><span class=\"token keyword\">null</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n  <span class=\"token keyword\">const</span> descriptionRef <span class=\"token operator\">=</span> useRef<span class=\"token operator\">&lt;</span>HTMLTextAreaElement<span class=\"token operator\">></span><span class=\"token punctuation\">(</span><span class=\"token keyword\">null</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n\n  <span class=\"token keyword\">return</span> <span class=\"token punctuation\">(</span>\n    <span class=\"token operator\">&lt;</span>main className<span class=\"token operator\">=</span><span class=\"token string\">'flex min-h-screen flex-col items-center justify-between p-24'</span><span class=\"token operator\">></span>\n      <span class=\"token operator\">&lt;</span>form\n        className<span class=\"token operator\">=</span><span class=\"token string\">'w-1/2 bg-white shadow-md rounded px-8 pt-6 pb-8 mb-4'</span>\n        action<span class=\"token operator\">=</span><span class=\"token punctuation\">{</span>create<span class=\"token punctuation\">}</span>\n      <span class=\"token operator\">></span>\n        <span class=\"token operator\">&lt;</span>div className<span class=\"token operator\">=</span><span class=\"token string\">'mb-4'</span><span class=\"token operator\">></span>\n          <span class=\"token operator\">&lt;</span>label className<span class=\"token operator\">=</span><span class=\"token string\">'block text-gray-700 text-sm font-bold mb-2'</span><span class=\"token operator\">></span>\n            Paid or not\n          <span class=\"token operator\">&lt;</span><span class=\"token operator\">/</span>label<span class=\"token operator\">></span>\n          <span class=\"token operator\">&lt;</span>div className<span class=\"token operator\">=</span><span class=\"token string\">'flex items-center mb-4'</span><span class=\"token operator\">></span>\n            <span class=\"token operator\">&lt;</span>input\n              className<span class=\"token operator\">=</span><span class=\"token string\">'w-4 h-4 text-blue-600 bg-gray-100 border-gray-300 rounded focus:ring-blue-500 dark:focus:ring-blue-600 dark:ring-offset-gray-800 focus:ring-2 dark:bg-gray-700 dark:border-gray-600'</span>\n              checked<span class=\"token operator\">=</span><span class=\"token punctuation\">{</span>paid <span class=\"token operator\">===</span> <span class=\"token string\">'Yes'</span><span class=\"token punctuation\">}</span>\n              type<span class=\"token operator\">=</span><span class=\"token string\">'radio'</span>\n              name<span class=\"token operator\">=</span><span class=\"token string\">'paid'</span>\n              value<span class=\"token operator\">=</span><span class=\"token string\">'Yes'</span>\n              onChange<span class=\"token operator\">=</span><span class=\"token punctuation\">{</span><span class=\"token punctuation\">(</span><span class=\"token parameter\">e</span><span class=\"token punctuation\">)</span> <span class=\"token operator\">=></span> <span class=\"token function\">setPaid</span><span class=\"token punctuation\">(</span>e<span class=\"token punctuation\">.</span>target<span class=\"token punctuation\">.</span>value<span class=\"token punctuation\">)</span><span class=\"token punctuation\">}</span>\n            <span class=\"token operator\">/</span><span class=\"token operator\">></span>\n            <span class=\"token operator\">&lt;</span>label\n              htmlFor<span class=\"token operator\">=</span><span class=\"token string\">'Yes'</span>\n              className<span class=\"token operator\">=</span><span class=\"token string\">'ml-2 text-sm font-medium text-gray-900 dark:text-gray-300'</span>\n            <span class=\"token operator\">></span>\n              Yes\n            <span class=\"token operator\">&lt;</span><span class=\"token operator\">/</span>label<span class=\"token operator\">></span>\n          <span class=\"token operator\">&lt;</span><span class=\"token operator\">/</span>div<span class=\"token operator\">></span>\n          <span class=\"token operator\">&lt;</span>div className<span class=\"token operator\">=</span><span class=\"token string\">'flex items-center mb-4'</span><span class=\"token operator\">></span>\n            <span class=\"token operator\">&lt;</span>input\n              className<span class=\"token operator\">=</span><span class=\"token string\">'w-4 h-4 text-blue-600 bg-gray-100 border-gray-300 rounded focus:ring-blue-500 dark:focus:ring-blue-600 dark:ring-offset-gray-800 focus:ring-2 dark:bg-gray-700 dark:border-gray-600'</span>\n              checked<span class=\"token operator\">=</span><span class=\"token punctuation\">{</span>paid <span class=\"token operator\">===</span> <span class=\"token string\">'No'</span><span class=\"token punctuation\">}</span>\n              type<span class=\"token operator\">=</span><span class=\"token string\">'radio'</span>\n              name<span class=\"token operator\">=</span><span class=\"token string\">'paid'</span>\n              value<span class=\"token operator\">=</span><span class=\"token string\">'No'</span>\n              onChange<span class=\"token operator\">=</span><span class=\"token punctuation\">{</span><span class=\"token punctuation\">(</span><span class=\"token parameter\">e</span><span class=\"token punctuation\">)</span> <span class=\"token operator\">=></span> <span class=\"token function\">setPaid</span><span class=\"token punctuation\">(</span>e<span class=\"token punctuation\">.</span>target<span class=\"token punctuation\">.</span>value<span class=\"token punctuation\">)</span><span class=\"token punctuation\">}</span>\n            <span class=\"token operator\">/</span><span class=\"token operator\">></span>\n            <span class=\"token operator\">&lt;</span>label\n              htmlFor<span class=\"token operator\">=</span><span class=\"token string\">'No'</span>\n              className<span class=\"token operator\">=</span><span class=\"token string\">'ml-2 text-sm font-medium text-gray-900 dark:text-gray-300'</span>\n            <span class=\"token operator\">></span>\n              No\n            <span class=\"token operator\">&lt;</span><span class=\"token operator\">/</span>label<span class=\"token operator\">></span>\n          <span class=\"token operator\">&lt;</span><span class=\"token operator\">/</span>div<span class=\"token operator\">></span>\n        <span class=\"token operator\">&lt;</span><span class=\"token operator\">/</span>div<span class=\"token operator\">></span>\n        <span class=\"token operator\">&lt;</span>div className<span class=\"token operator\">=</span><span class=\"token string\">'mb-4'</span><span class=\"token operator\">></span>\n          <span class=\"token operator\">&lt;</span>label className<span class=\"token operator\">=</span><span class=\"token string\">'block text-gray-700 text-sm font-bold mb-2'</span><span class=\"token operator\">></span>\n            Price\n          <span class=\"token operator\">&lt;</span><span class=\"token operator\">/</span>label<span class=\"token operator\">></span>\n          <span class=\"token operator\">&lt;</span>input\n            className<span class=\"token operator\">=</span><span class=\"token string\">'shadow appearance-none border rounded w-full py-2 px-3 text-gray-700 mb-3 leading-tight focus:outline-none focus:shadow-outline'</span>\n            type<span class=\"token operator\">=</span><span class=\"token string\">'text'</span>\n            name<span class=\"token operator\">=</span><span class=\"token string\">'price'</span>\n            placeholder<span class=\"token operator\">=</span><span class=\"token string\">'How much is it?'</span>\n            ref<span class=\"token operator\">=</span><span class=\"token punctuation\">{</span>priceRef<span class=\"token punctuation\">}</span>\n          <span class=\"token operator\">/</span><span class=\"token operator\">></span>\n        <span class=\"token operator\">&lt;</span><span class=\"token operator\">/</span>div<span class=\"token operator\">></span>\n        <span class=\"token operator\">&lt;</span>div className<span class=\"token operator\">=</span><span class=\"token string\">'mb-4'</span><span class=\"token operator\">></span>\n          <span class=\"token operator\">&lt;</span>label className<span class=\"token operator\">=</span><span class=\"token string\">'block text-gray-700 text-sm font-bold mb-2'</span><span class=\"token operator\">></span>\n            Street no<span class=\"token punctuation\">.</span>\n          <span class=\"token operator\">&lt;</span><span class=\"token operator\">/</span>label<span class=\"token operator\">></span>\n          <span class=\"token operator\">&lt;</span>input\n            className<span class=\"token operator\">=</span><span class=\"token string\">'shadow appearance-none border rounded w-full py-2 px-3 text-gray-700 mb-3 leading-tight focus:outline-none focus:shadow-outline'</span>\n            type<span class=\"token operator\">=</span><span class=\"token string\">'text'</span>\n            name<span class=\"token operator\">=</span><span class=\"token string\">'streetNumber'</span>\n            ref<span class=\"token operator\">=</span><span class=\"token punctuation\">{</span>streetNumberRef<span class=\"token punctuation\">}</span>\n          <span class=\"token operator\">/</span><span class=\"token operator\">></span>\n        <span class=\"token operator\">&lt;</span><span class=\"token operator\">/</span>div<span class=\"token operator\">></span>\n        <span class=\"token operator\">&lt;</span>div className<span class=\"token operator\">=</span><span class=\"token string\">'mb-4'</span><span class=\"token operator\">></span>\n          <span class=\"token operator\">&lt;</span>label className<span class=\"token operator\">=</span><span class=\"token string\">'block text-gray-700 text-sm font-bold mb-2'</span><span class=\"token operator\">></span>\n            Street\n          <span class=\"token operator\">&lt;</span><span class=\"token operator\">/</span>label<span class=\"token operator\">></span>\n          <span class=\"token operator\">&lt;</span>input\n            className<span class=\"token operator\">=</span><span class=\"token string\">'shadow appearance-none border rounded w-full py-2 px-3 text-gray-700 mb-3 leading-tight focus:outline-none focus:shadow-outline'</span>\n            type<span class=\"token operator\">=</span><span class=\"token string\">'text'</span>\n            name<span class=\"token operator\">=</span><span class=\"token string\">'street'</span>\n            ref<span class=\"token operator\">=</span><span class=\"token punctuation\">{</span>streetRef<span class=\"token punctuation\">}</span>\n          <span class=\"token operator\">/</span><span class=\"token operator\">></span>\n        <span class=\"token operator\">&lt;</span><span class=\"token operator\">/</span>div<span class=\"token operator\">></span>\n        <span class=\"token operator\">&lt;</span>div className<span class=\"token operator\">=</span><span class=\"token string\">'mb-4'</span><span class=\"token operator\">></span>\n          <span class=\"token operator\">&lt;</span>label className<span class=\"token operator\">=</span><span class=\"token string\">'block text-gray-700 text-sm font-bold mb-2'</span><span class=\"token operator\">></span>\n            City\n          <span class=\"token operator\">&lt;</span><span class=\"token operator\">/</span>label<span class=\"token operator\">></span>\n          <span class=\"token operator\">&lt;</span>input\n            className<span class=\"token operator\">=</span><span class=\"token string\">'shadow appearance-none border rounded w-full py-2 px-3 text-gray-700 mb-3 leading-tight focus:outline-none focus:shadow-outline'</span>\n            type<span class=\"token operator\">=</span><span class=\"token string\">'text'</span>\n            name<span class=\"token operator\">=</span><span class=\"token string\">'city'</span>\n            ref<span class=\"token operator\">=</span><span class=\"token punctuation\">{</span>cityRef<span class=\"token punctuation\">}</span>\n          <span class=\"token operator\">/</span><span class=\"token operator\">></span>\n        <span class=\"token operator\">&lt;</span><span class=\"token operator\">/</span>div<span class=\"token operator\">></span>\n        <span class=\"token operator\">&lt;</span>div className<span class=\"token operator\">=</span><span class=\"token string\">'mb-4'</span><span class=\"token operator\">></span>\n          <span class=\"token operator\">&lt;</span>label className<span class=\"token operator\">=</span><span class=\"token string\">'block text-gray-700 text-sm font-bold mb-2'</span><span class=\"token operator\">></span>\n            Country\n          <span class=\"token operator\">&lt;</span><span class=\"token operator\">/</span>label<span class=\"token operator\">></span>\n          <span class=\"token operator\">&lt;</span>input\n            className<span class=\"token operator\">=</span><span class=\"token string\">'shadow appearance-none border rounded w-full py-2 px-3 text-gray-700 mb-3 leading-tight focus:outline-none focus:shadow-outline'</span>\n            type<span class=\"token operator\">=</span><span class=\"token string\">'text'</span>\n            name<span class=\"token operator\">=</span><span class=\"token string\">'country'</span>\n            ref<span class=\"token operator\">=</span><span class=\"token punctuation\">{</span>countryRef<span class=\"token punctuation\">}</span>\n          <span class=\"token operator\">/</span><span class=\"token operator\">></span>\n        <span class=\"token operator\">&lt;</span><span class=\"token operator\">/</span>div<span class=\"token operator\">></span>\n        <span class=\"token operator\">&lt;</span>div className<span class=\"token operator\">=</span><span class=\"token string\">'mb-4'</span><span class=\"token operator\">></span>\n          <span class=\"token operator\">&lt;</span>label className<span class=\"token operator\">=</span><span class=\"token string\">'block text-gray-700 text-sm font-bold mb-2'</span><span class=\"token operator\">></span>\n            Cleanliness\n          <span class=\"token operator\">&lt;</span><span class=\"token operator\">/</span>label<span class=\"token operator\">></span>\n          <span class=\"token operator\">&lt;</span>input\n            className<span class=\"token operator\">=</span><span class=\"token string\">'shadow appearance-none border rounded w-full py-2 px-3 text-gray-700 mb-3 leading-tight focus:outline-none focus:shadow-outline'</span>\n            type<span class=\"token operator\">=</span><span class=\"token string\">'number'</span>\n            step<span class=\"token operator\">=</span><span class=\"token punctuation\">{</span><span class=\"token number\">0.1</span><span class=\"token punctuation\">}</span>\n            name<span class=\"token operator\">=</span><span class=\"token string\">'cleanliness'</span>\n            placeholder<span class=\"token operator\">=</span><span class=\"token string\">'How clean is it?'</span>\n            ref<span class=\"token operator\">=</span><span class=\"token punctuation\">{</span>cleanlinessRef<span class=\"token punctuation\">}</span>\n          <span class=\"token operator\">/</span><span class=\"token operator\">></span>\n        <span class=\"token operator\">&lt;</span><span class=\"token operator\">/</span>div<span class=\"token operator\">></span>\n        <span class=\"token operator\">&lt;</span>div className<span class=\"token operator\">=</span><span class=\"token string\">'mb-4'</span><span class=\"token operator\">></span>\n          <span class=\"token operator\">&lt;</span>label className<span class=\"token operator\">=</span><span class=\"token string\">'block text-gray-700 text-sm font-bold mb-2'</span><span class=\"token operator\">></span>\n            Performance\n          <span class=\"token operator\">&lt;</span><span class=\"token operator\">/</span>label<span class=\"token operator\">></span>\n          <span class=\"token operator\">&lt;</span>input\n            className<span class=\"token operator\">=</span><span class=\"token string\">'shadow appearance-none border rounded w-full py-2 px-3 text-gray-700 mb-3 leading-tight focus:outline-none focus:shadow-outline'</span>\n            type<span class=\"token operator\">=</span><span class=\"token string\">'number'</span>\n            step<span class=\"token operator\">=</span><span class=\"token punctuation\">{</span><span class=\"token number\">0.1</span><span class=\"token punctuation\">}</span>\n            name<span class=\"token operator\">=</span><span class=\"token string\">'performance'</span>\n            placeholder<span class=\"token operator\">=</span><span class=\"token string\">'How well does it work?'</span>\n            ref<span class=\"token operator\">=</span><span class=\"token punctuation\">{</span>performanceRef<span class=\"token punctuation\">}</span>\n          <span class=\"token operator\">/</span><span class=\"token operator\">></span>\n        <span class=\"token operator\">&lt;</span><span class=\"token operator\">/</span>div<span class=\"token operator\">></span>\n        <span class=\"token operator\">&lt;</span>div className<span class=\"token operator\">=</span><span class=\"token string\">'mb-4'</span><span class=\"token operator\">></span>\n          <span class=\"token operator\">&lt;</span>label className<span class=\"token operator\">=</span><span class=\"token string\">'block text-gray-700 text-sm font-bold mb-2'</span><span class=\"token operator\">></span>\n            Description\n          <span class=\"token operator\">&lt;</span><span class=\"token operator\">/</span>label<span class=\"token operator\">></span>\n          <span class=\"token operator\">&lt;</span>textarea\n            className<span class=\"token operator\">=</span><span class=\"token string\">'resize-none shadow appearance-none border rounded w-full py-2 px-3 text-gray-700 mb-3 leading-tight focus:outline-none focus:shadow-outline'</span>\n            rows<span class=\"token operator\">=</span><span class=\"token punctuation\">{</span><span class=\"token number\">2</span><span class=\"token punctuation\">}</span>\n            name<span class=\"token operator\">=</span><span class=\"token string\">'description'</span>\n            placeholder<span class=\"token operator\">=</span><span class=\"token string\">'Write your experience in less than 500 characters'</span>\n            maxLength<span class=\"token operator\">=</span><span class=\"token punctuation\">{</span><span class=\"token number\">500</span><span class=\"token punctuation\">}</span>\n            ref<span class=\"token operator\">=</span><span class=\"token punctuation\">{</span>descriptionRef<span class=\"token punctuation\">}</span>\n          <span class=\"token operator\">/</span><span class=\"token operator\">></span>\n        <span class=\"token operator\">&lt;</span><span class=\"token operator\">/</span>div<span class=\"token operator\">></span>\n        <span class=\"token operator\">&lt;</span>div className<span class=\"token operator\">=</span><span class=\"token string\">'mb-4'</span><span class=\"token operator\">></span>\n          <span class=\"token operator\">&lt;</span>label className<span class=\"token operator\">=</span><span class=\"token string\">'block text-gray-700 text-sm font-bold mb-2'</span><span class=\"token operator\">></span>\n            Email\n          <span class=\"token operator\">&lt;</span><span class=\"token operator\">/</span>label<span class=\"token operator\">></span>\n          <span class=\"token operator\">&lt;</span>input\n            className<span class=\"token operator\">=</span><span class=\"token string\">'shadow appearance-none border rounded w-full py-2 px-3 text-gray-700 mb-3 leading-tight focus:outline-none focus:shadow-outline'</span>\n            type<span class=\"token operator\">=</span><span class=\"token string\">'email'</span>\n            name<span class=\"token operator\">=</span><span class=\"token string\">'email'</span>\n            ref<span class=\"token operator\">=</span><span class=\"token punctuation\">{</span>emailRef<span class=\"token punctuation\">}</span>\n          <span class=\"token operator\">/</span><span class=\"token operator\">></span>\n        <span class=\"token operator\">&lt;</span><span class=\"token operator\">/</span>div<span class=\"token operator\">></span>\n        <span class=\"token operator\">&lt;</span>div className<span class=\"token operator\">=</span><span class=\"token string\">'mb-4'</span><span class=\"token operator\">></span>\n          <span class=\"token operator\">&lt;</span>label className<span class=\"token operator\">=</span><span class=\"token string\">'block text-gray-700 text-sm font-bold mb-2'</span><span class=\"token operator\">></span>\n            Password\n          <span class=\"token operator\">&lt;</span><span class=\"token operator\">/</span>label<span class=\"token operator\">></span>\n          <span class=\"token operator\">&lt;</span>input\n            className<span class=\"token operator\">=</span><span class=\"token string\">'shadow appearance-none border rounded w-full py-2 px-3 text-gray-700 mb-3 leading-tight focus:outline-none focus:shadow-outline'</span>\n            type<span class=\"token operator\">=</span><span class=\"token string\">'password'</span>\n            name<span class=\"token operator\">=</span><span class=\"token string\">'password'</span>\n            ref<span class=\"token operator\">=</span><span class=\"token punctuation\">{</span>passwordRef<span class=\"token punctuation\">}</span>\n          <span class=\"token operator\">/</span><span class=\"token operator\">></span>\n        <span class=\"token operator\">&lt;</span><span class=\"token operator\">/</span>div<span class=\"token operator\">></span>\n        <span class=\"token operator\">&lt;</span>div className<span class=\"token operator\">=</span><span class=\"token string\">'flex items-center justify-between'</span><span class=\"token operator\">></span>\n          <span class=\"token operator\">&lt;</span>button\n            className<span class=\"token operator\">=</span><span class=\"token string\">'bg-blue-500 hover:bg-blue-700 text-white font-bold py-2 px-4 rounded focus:outline-none focus:shadow-outline'</span>\n            type<span class=\"token operator\">=</span><span class=\"token string\">'submit'</span>\n          <span class=\"token operator\">></span>\n            Submit\n          <span class=\"token operator\">&lt;</span><span class=\"token operator\">/</span>button<span class=\"token operator\">></span>\n        <span class=\"token operator\">&lt;</span><span class=\"token operator\">/</span>div<span class=\"token operator\">></span>\n      <span class=\"token operator\">&lt;</span><span class=\"token operator\">/</span>form<span class=\"token operator\">></span>\n    <span class=\"token operator\">&lt;</span><span class=\"token operator\">/</span>main<span class=\"token operator\">></span>\n  <span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n<span class=\"token punctuation\">}</span></code></pre></div>\n<p>When you run the application in development mode and hit <code class=\"language-text\">http://localhost:4000/contribute</code> in a browser, you will see like:</p>\n<p><span\n      class=\"gatsby-resp-image-wrapper\"\n      style=\"position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 630px; \"\n    >\n      <a\n    class=\"gatsby-resp-image-link\"\n    href=\"/static/d29d17b7ff73265b611f10ec2f45b0ea/ddc81/create-form-2.png\"\n    style=\"display: block\"\n    target=\"_blank\"\n    rel=\"noopener\"\n  >\n    <span\n    class=\"gatsby-resp-image-background-image\"\n    style=\"padding-bottom: 95.56962025316456%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAATCAYAAACQjC21AAAACXBIWXMAABYlAAAWJQFJUiTwAAABu0lEQVR42p2UTW4UMRCFfd4sOA/ZIcQ1YIWy4gJsIgXQMDP953bb7X8/9GpmkqwSui29Rdnur+q53FbHroMPAevq0fcjtDaotWLrCCHg1PdQp65/Bh5PHbp+QowJpVS0hneVc0GtDSFGnLoB6jwMAmytCYgi3Psglb4lfuN9RE4ZMSWcxxGqGwahE6JnA2MWybrZcozoCezHSejWOrH893jG4laxTPB71m+WyRgmDTVoLXSWH2JCShnWrXDOw9r1uvaW5SDfpJwxag01TlrOjV1aFiswbtw6UkqY9Aw16lnoZrH49eeAw7GTqjjHzLSUc36lIuI6rd6Sc+80GyhtjPjnIjsmXfbhYvvabcZs2kVB5qnaXu4rE5Cl5mURIMdWq9xfW5PmEEiWMtZKUEq5Vlr/W629WOZxkKXM4uRqsDldP2LvIHCxDso6JxXimm2fLkCylFtXCWiBtqmtQKmwFJClVu8Fxt/u6fcB4zTvssxCyFJ8GBgQeqt0j20yyFIhRAkkS23Pl3XrGbKxZCkfIoCKLw8ZHz4H3H0K+PF4SVA3XEs6izFC8UEg8PvPgvtvCR+/Jjye2z5gSvgH+jDUaF1fOhcAAAAASUVORK5CYII='); background-size: cover; display: block;\"\n  ></span>\n  <img\n        class=\"gatsby-resp-image-image\"\n        alt=\"create-form-2.png\"\n        title=\"\"\n        src=\"/static/d29d17b7ff73265b611f10ec2f45b0ea/f058b/create-form-2.png\"\n        srcset=\"/static/d29d17b7ff73265b611f10ec2f45b0ea/c26ae/create-form-2.png 158w,\n/static/d29d17b7ff73265b611f10ec2f45b0ea/6bdcf/create-form-2.png 315w,\n/static/d29d17b7ff73265b611f10ec2f45b0ea/f058b/create-form-2.png 630w,\n/static/d29d17b7ff73265b611f10ec2f45b0ea/ddc81/create-form-2.png 837w\"\n        sizes=\"(max-width: 630px) 100vw, 630px\"\n        style=\"width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;\"\n        loading=\"lazy\"\n        decoding=\"async\"\n      />\n  </a>\n    </span></p>\n<h2>Make graphql mutation query</h2>\n<p>In the component we have just created, you can see a form that invokes <code class=\"language-text\">create</code> function when clicking <strong>Submit</strong> button. This function is where the data we have got from the form is handled so we will make a graphql query.</p>\n<p>To do it, we will create a file named <code class=\"language-text\">action.ts</code> under <code class=\"language-text\">contribute</code> folder.</p>\n<div class=\"gatsby-highlight\" data-language=\"text\"><pre class=\"language-text\"><code class=\"language-text\">src/app\n└── contribute\n    ├── action.ts\n    └── page.tsx</code></pre></div>\n<p>Write the following code in <code class=\"language-text\">action.ts</code> file.</p>\n<div class=\"gatsby-highlight\" data-language=\"js\"><pre class=\"language-js\"><code class=\"language-js\"><span class=\"token string\">'use server'</span><span class=\"token punctuation\">;</span>\n<span class=\"token keyword\">import</span> <span class=\"token punctuation\">{</span> redirect <span class=\"token punctuation\">}</span> <span class=\"token keyword\">from</span> <span class=\"token string\">'next/navigation'</span><span class=\"token punctuation\">;</span>\n\n<span class=\"token keyword\">export</span> <span class=\"token keyword\">default</span> <span class=\"token keyword\">async</span> <span class=\"token keyword\">function</span> <span class=\"token function\">create</span><span class=\"token punctuation\">(</span><span class=\"token parameter\"><span class=\"token literal-property property\">formData</span><span class=\"token operator\">:</span> FormData</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n  <span class=\"token keyword\">const</span> isPaid <span class=\"token operator\">=</span> formData<span class=\"token punctuation\">.</span><span class=\"token function\">get</span><span class=\"token punctuation\">(</span><span class=\"token string\">'paid'</span><span class=\"token punctuation\">)</span> <span class=\"token operator\">===</span> <span class=\"token string\">'Yes'</span> <span class=\"token operator\">?</span> <span class=\"token boolean\">true</span> <span class=\"token operator\">:</span> <span class=\"token boolean\">false</span><span class=\"token punctuation\">;</span>\n  <span class=\"token keyword\">const</span> price <span class=\"token operator\">=</span> <span class=\"token function\">parseInt</span><span class=\"token punctuation\">(</span>formData<span class=\"token punctuation\">.</span><span class=\"token function\">get</span><span class=\"token punctuation\">(</span><span class=\"token string\">'price'</span><span class=\"token punctuation\">)</span> <span class=\"token keyword\">as</span> string<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n  <span class=\"token keyword\">const</span> streetNumber <span class=\"token operator\">=</span> formData<span class=\"token punctuation\">.</span><span class=\"token function\">get</span><span class=\"token punctuation\">(</span><span class=\"token string\">'streetNumber'</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n  <span class=\"token keyword\">const</span> street <span class=\"token operator\">=</span> formData<span class=\"token punctuation\">.</span><span class=\"token function\">get</span><span class=\"token punctuation\">(</span><span class=\"token string\">'street'</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n  <span class=\"token keyword\">const</span> city <span class=\"token operator\">=</span> formData<span class=\"token punctuation\">.</span><span class=\"token function\">get</span><span class=\"token punctuation\">(</span><span class=\"token string\">'city'</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n  <span class=\"token keyword\">const</span> country <span class=\"token operator\">=</span> formData<span class=\"token punctuation\">.</span><span class=\"token function\">get</span><span class=\"token punctuation\">(</span><span class=\"token string\">'country'</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n  <span class=\"token keyword\">const</span> email <span class=\"token operator\">=</span> formData<span class=\"token punctuation\">.</span><span class=\"token function\">get</span><span class=\"token punctuation\">(</span><span class=\"token string\">'email'</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n  <span class=\"token keyword\">const</span> password <span class=\"token operator\">=</span> formData<span class=\"token punctuation\">.</span><span class=\"token function\">get</span><span class=\"token punctuation\">(</span><span class=\"token string\">'password'</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n  <span class=\"token keyword\">const</span> cleanliness <span class=\"token operator\">=</span> <span class=\"token function\">parseFloat</span><span class=\"token punctuation\">(</span>formData<span class=\"token punctuation\">.</span><span class=\"token function\">get</span><span class=\"token punctuation\">(</span><span class=\"token string\">'cleanliness'</span><span class=\"token punctuation\">)</span> <span class=\"token keyword\">as</span> string<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n  <span class=\"token keyword\">const</span> performance <span class=\"token operator\">=</span> <span class=\"token function\">parseFloat</span><span class=\"token punctuation\">(</span>formData<span class=\"token punctuation\">.</span><span class=\"token function\">get</span><span class=\"token punctuation\">(</span><span class=\"token string\">'performance'</span><span class=\"token punctuation\">)</span> <span class=\"token keyword\">as</span> string<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n  <span class=\"token keyword\">const</span> description <span class=\"token operator\">=</span> formData<span class=\"token punctuation\">.</span><span class=\"token function\">get</span><span class=\"token punctuation\">(</span><span class=\"token string\">'description'</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n\n  <span class=\"token keyword\">const</span> apiUrl <span class=\"token operator\">=</span> <span class=\"token string\">'http://localhost:4000/graphql'</span><span class=\"token punctuation\">;</span>\n  <span class=\"token keyword\">const</span> response <span class=\"token operator\">=</span> <span class=\"token keyword\">await</span> <span class=\"token function\">fetch</span><span class=\"token punctuation\">(</span>apiUrl<span class=\"token punctuation\">,</span> <span class=\"token punctuation\">{</span>\n    <span class=\"token literal-property property\">method</span><span class=\"token operator\">:</span> <span class=\"token string\">'POST'</span><span class=\"token punctuation\">,</span>\n    <span class=\"token literal-property property\">headers</span><span class=\"token operator\">:</span> <span class=\"token punctuation\">{</span> <span class=\"token string-property property\">'Content-Type'</span><span class=\"token operator\">:</span> <span class=\"token string\">'application/json'</span> <span class=\"token punctuation\">}</span><span class=\"token punctuation\">,</span>\n    <span class=\"token literal-property property\">body</span><span class=\"token operator\">:</span> <span class=\"token constant\">JSON</span><span class=\"token punctuation\">.</span><span class=\"token function\">stringify</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">{</span>\n      <span class=\"token literal-property property\">query</span><span class=\"token operator\">:</span> <span class=\"token template-string\"><span class=\"token template-punctuation string\">`</span><span class=\"token string\">mutation { createToilet(createToiletData: {\n          isPaid: </span><span class=\"token interpolation\"><span class=\"token interpolation-punctuation punctuation\">${</span>isPaid<span class=\"token interpolation-punctuation punctuation\">}</span></span><span class=\"token string\">\n          price: </span><span class=\"token interpolation\"><span class=\"token interpolation-punctuation punctuation\">${</span>price<span class=\"token interpolation-punctuation punctuation\">}</span></span><span class=\"token string\">\n          address: {\n            streetNumber: \"</span><span class=\"token interpolation\"><span class=\"token interpolation-punctuation punctuation\">${</span>streetNumber<span class=\"token interpolation-punctuation punctuation\">}</span></span><span class=\"token string\">\"\n            street: \"</span><span class=\"token interpolation\"><span class=\"token interpolation-punctuation punctuation\">${</span>street<span class=\"token interpolation-punctuation punctuation\">}</span></span><span class=\"token string\">\"\n            city: \"</span><span class=\"token interpolation\"><span class=\"token interpolation-punctuation punctuation\">${</span>city<span class=\"token interpolation-punctuation punctuation\">}</span></span><span class=\"token string\">\"\n            country: \"</span><span class=\"token interpolation\"><span class=\"token interpolation-punctuation punctuation\">${</span>country<span class=\"token interpolation-punctuation punctuation\">}</span></span><span class=\"token string\">\"\n          }\n          reviews: {\n            contributedBy: \"</span><span class=\"token interpolation\"><span class=\"token interpolation-punctuation punctuation\">${</span>email<span class=\"token interpolation-punctuation punctuation\">}</span></span><span class=\"token string\">\"\n            password: \"</span><span class=\"token interpolation\"><span class=\"token interpolation-punctuation punctuation\">${</span>password<span class=\"token interpolation-punctuation punctuation\">}</span></span><span class=\"token string\">\"\n            cleanliness: </span><span class=\"token interpolation\"><span class=\"token interpolation-punctuation punctuation\">${</span>cleanliness<span class=\"token interpolation-punctuation punctuation\">}</span></span><span class=\"token string\">\n            performance: </span><span class=\"token interpolation\"><span class=\"token interpolation-punctuation punctuation\">${</span>performance<span class=\"token interpolation-punctuation punctuation\">}</span></span><span class=\"token string\">\n            description: \"</span><span class=\"token interpolation\"><span class=\"token interpolation-punctuation punctuation\">${</span>description<span class=\"token interpolation-punctuation punctuation\">}</span></span><span class=\"token string\">\"\n          }\n        }) {\n          id\n          isPaid\n          price\n          address {\n            street\n            city\n            country\n          }\n        }\n      }</span><span class=\"token template-punctuation string\">`</span></span><span class=\"token punctuation\">,</span>\n    <span class=\"token punctuation\">}</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">,</span>\n  <span class=\"token punctuation\">}</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n\n  <span class=\"token keyword\">const</span> data <span class=\"token operator\">=</span> <span class=\"token keyword\">await</span> response<span class=\"token punctuation\">.</span><span class=\"token function\">json</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n  console<span class=\"token punctuation\">.</span><span class=\"token function\">log</span><span class=\"token punctuation\">(</span>data<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n  <span class=\"token function\">redirect</span><span class=\"token punctuation\">(</span><span class=\"token string\">'/'</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n<span class=\"token punctuation\">}</span></code></pre></div>\n<p>Let me briefly explain what is going on here. This <code class=\"language-text\">create</code> function will get the form data from <code class=\"language-text\">Contribute</code> component and use it to make a graphql mutation query. The mutation query is included in <code class=\"language-text\">body</code> field as shown above. When the query is sent to the server, it will await its response and console-log it. Finally, it will redirect to the root route.</p>\n<p>In order to register a toilet now, we make sure to run the backend server that listen on a port we set up which is <code class=\"language-text\">4000</code> here.</p>\n<p>When we go to <code class=\"language-text\">/contribute</code>, fill every field in the form and click <strong>Submit</strong> button, we should be going to see a log in the terminal like</p>\n<p><span\n      class=\"gatsby-resp-image-wrapper\"\n      style=\"position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 568px; \"\n    >\n      <a\n    class=\"gatsby-resp-image-link\"\n    href=\"/static/546db917d9662ae01f6c4a7c350f9e34/10e91/create-response.png\"\n    style=\"display: block\"\n    target=\"_blank\"\n    rel=\"noopener\"\n  >\n    <span\n    class=\"gatsby-resp-image-background-image\"\n    style=\"padding-bottom: 42.405063291139236%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAICAYAAAD5nd/tAAAACXBIWXMAABYlAAAWJQFJUiTwAAABKUlEQVR42o1Sy3LCMAzkH4hfJHEaGEPMK7ZxUihtcqGnDv//OduxwwTaHspBXkljrVayJy/lC7SuMJ+XyLIMjDFQSiNyziGEGI1z8SP+beH+JBTWxqDrOrRtg/2+xma9xmKxiA0COUkICCHRT25+wCRJQOmAhNCBMBzT6RTbzRb+4LHb7XG5fKLve7jDIeacc/CNhzMWx+MRzlp473E+v8E6O6CpIQTHJEhljEZFp9MJr20LrdfoPt5RVSvMZrOoNJc58jyHLIoBpUQhB7+45QJXJAxy1VKh73oYU8cVXK9fUErFi2majnu9Gx1zjzuPI3PGoLVG4xs466LaVbWK41lrIGU+FvxnkXBelsjS9LZcMnZ9jJ8hi4RLpVBICcrY/fkF//MdniX8BklS2jd4+fOsAAAAAElFTkSuQmCC'); background-size: cover; display: block;\"\n  ></span>\n  <img\n        class=\"gatsby-resp-image-image\"\n        alt=\"create-response.png\"\n        title=\"\"\n        src=\"/static/546db917d9662ae01f6c4a7c350f9e34/10e91/create-response.png\"\n        srcset=\"/static/546db917d9662ae01f6c4a7c350f9e34/c26ae/create-response.png 158w,\n/static/546db917d9662ae01f6c4a7c350f9e34/6bdcf/create-response.png 315w,\n/static/546db917d9662ae01f6c4a7c350f9e34/10e91/create-response.png 568w\"\n        sizes=\"(max-width: 568px) 100vw, 568px\"\n        style=\"width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;\"\n        loading=\"lazy\"\n        decoding=\"async\"\n      />\n  </a>\n    </span></p>\n<p>In addition to logging, we can also check if the toilet has been created by using <code class=\"language-text\">/toilets</code> route. Feel free to do it.</p>\n<p><em><strong>THANKS FOR READING. SEE YOU NEXT TIME!</strong></em></p>\n<h3>References</h3>\n<ul>\n<li><a href=\"https://nextjs.org/docs/pages/building-your-application/data-fetching/forms-and-mutations\">https://nextjs.org/docs/pages/building-your-application/data-fetching/forms-and-mutations</a></li>\n</ul>","frontmatter":{"title":"#11 Nextjs Graphql mutation query using App router","date":"20 Sep, 2023","description":"","tag":["Project","React"]},"fields":{"locale":"en"}},"previous":{"fields":{"slug":"/en/nextjs-basic-setup-and-request-graphql"},"frontmatter":{"title":"#10 Nextjs basic setup and GraphQL request"}},"next":{"fields":{"slug":"/en/nextjs-update-data-approach-using-app-router"},"frontmatter":{"title":"#12 Nextjs update data approach using App router"}}},"pageContext":{"locale":"en","isDefaultLang":false,"slug":"/en/nextjs-graphql-mutation-query-using-app-router","titleByLang":{"ko":"nextjs-app-router로-graphql-mutation-쿼리-요청하기","en":"nextjs-graphql-mutation-query-using-app-router"},"dateFormat":"DD MMM, YYYY","id":"0eb72de5-cd51-5e81-a2e0-31151c0eacbf","previousPostId":"4db06414-8370-57fa-83c0-e34041a8a65f","nextPostId":"6d86c34b-9491-5605-b30a-2582117e26bc"}},"staticQueryHashes":[],"slicesMap":{}}