{"componentChunkName":"component---src-templates-blog-post-js","path":"/en/pandas-for-excel-python/","result":{"data":{"site":{"siteMetadata":{"title":"Seunghyun's Blog"}},"markdownRemark":{"id":"80f6651d-4d08-5a50-8588-b38718b45d67","excerpt":"Pandas’s official website says pandas is a fast, powerful, flexible and easy to use open source data analysis and manipulation tool, built on top of the Python…","html":"<p>Pandas’s <a href=\"https://pandas.pydata.org/\">official website</a> says</p>\n<blockquote>\n<p>pandas is a fast, powerful, flexible and easy to use open source data analysis and manipulation tool, built on top of the Python programming language.</p>\n</blockquote>\n<p>Especially, <strong>pandas</strong> is an incredibly easy tool to deal with and analyze data stored in an excel file. We will learn how to implement pandas for excel and practice an example with a real world data.</p>\n<h2>Prerequisite</h2>\n<ul>\n<li>Set up a virtual environment — <em>I have already covered up how to set up one on my previous <a href=\"https://shkim04.github.io/en/how-to-set-up-python-virtual-env\">post</a></em></li>\n</ul>\n<h2>Install pandas</h2>\n<div class=\"gatsby-highlight\" data-language=\"text\"><pre class=\"language-text\"><code class=\"language-text\">pip install pandas\npip list</code></pre></div>\n<p>Once you install it, check out the list of packages to see if the package is installed properly that looks like as shown below:</p>\n<p><span\n      class=\"gatsby-resp-image-wrapper\"\n      style=\"position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 313px; \"\n    >\n      <a\n    class=\"gatsby-resp-image-link\"\n    href=\"/static/9af7fa5999d8699318e46d5d73d1002e/80977/pip-list.png\"\n    style=\"display: block\"\n    target=\"_blank\"\n    rel=\"noopener\"\n  >\n    <span\n    class=\"gatsby-resp-image-background-image\"\n    style=\"padding-bottom: 86.70886075949367%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAARCAYAAADdRIy+AAAACXBIWXMAAAsTAAALEwEAmpwYAAACm0lEQVR42m1U23KiQBTMVySVrKJcBNxaDYhyl2G4DXjJ1j7n/7+jt85RE3H3YRwsmj6n+/TMk2ma8DwPq9UvrFdr+P4GwSZAsNlgvVrBsiwYhgHC0b5cLuG6Lu/0nWWZX+9pPS0WNk6nI4LAR1U1+H3+g65pMKgeH+czXNeBrusMpj1NUqRJgjhOoLoOpqHDMMxvQtu2kaYpDsMRx+MRnrfGZDLhj3XDGFXXdQPhbocgCKBUB8/zEWz8r4LXDi1kaYZeDTifTojjkCX9XC5HZLcOozBEkqQQokCW5vx/Pp9/E1rWAl3X4ePjBNX3OB0H9KrHPs9GlW8dxlEEKSskcYzT4Yi6ktA07a5D20bTNOzHwF2esXTdf7pjQsPANtgijhKE4Q5RFMK4Fb3i2UOlFNqmhihKVFJ+EdKEaY0lR4iiCOEuZMLFYjGesuM4l+6GHrOZhufnZ8xmM2jaFNPpdWka5vocmjZDKSX7F5KXcYIkicYeEqGUEl3XolcdZFnyJOuqRds0qOsKpdhD7AV8z8d2GyDPc6RpwqSXHN7HxnHQdi3KUrBcWQp47++oqwsZ+SuKPfIsh+95TCJEyYQkmSwbS3YdzhTJTtMYLy8v+DGZ4PX1FW9vb5xJmiLZMJ1qKIoCn5+f6PuOT9Q2CMaSydSqqtC1DXtTVRJZlqEUgk+DbS8YSMOh2NQ1Da9AlqVszcZ/CDb9yFLylPu+R69alk7+UTeObXNcbjkkMjp+eZZxJnfb7WOwLYhCMJCmTDJJIskjmeOjp7NEIjkMigsKIcbBNk2LO+yVwj7PeSD6NYP/CzZhKYOHYeABBY8e2raDSlYMoMvhUcL9Mm6E4YWQbh0K+oiQQNpM+w7w9aVxd9PcP2tXDOFpv8cT4V+v1Q2lLvfJKgAAAABJRU5ErkJggg=='); background-size: cover; display: block;\"\n  ></span>\n  <img\n        class=\"gatsby-resp-image-image\"\n        alt=\"pip-list\"\n        title=\"\"\n        src=\"/static/9af7fa5999d8699318e46d5d73d1002e/80977/pip-list.png\"\n        srcset=\"/static/9af7fa5999d8699318e46d5d73d1002e/c26ae/pip-list.png 158w,\n/static/9af7fa5999d8699318e46d5d73d1002e/80977/pip-list.png 313w\"\n        sizes=\"(max-width: 313px) 100vw, 313px\"\n        style=\"width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;\"\n        loading=\"lazy\"\n        decoding=\"async\"\n      />\n  </a>\n    </span></p>\n<p>You can see the other packages in addition to pandas. They are peer packages of pandas so it would not work out properly without them.</p>\n<h2>Analyze Data From Excel</h2>\n<p>If you do not have any sample data, I will create a <a href=\"https://github.com/shkim04/python_practice\"><strong>repository</strong></a> for this simple project so, you can download the code and the sample data. It looks like:</p>\n<p><span\n      class=\"gatsby-resp-image-wrapper\"\n      style=\"position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 630px; \"\n    >\n      <a\n    class=\"gatsby-resp-image-link\"\n    href=\"/static/074ef4268e7766e1389edefaed597334/c1b63/excel-data.png\"\n    style=\"display: block\"\n    target=\"_blank\"\n    rel=\"noopener\"\n  >\n    <span\n    class=\"gatsby-resp-image-background-image\"\n    style=\"padding-bottom: 36.075949367088604%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAHCAYAAAAIy204AAAACXBIWXMAAAsTAAALEwEAmpwYAAABQElEQVR42lVR2Y6DMAzk/z+sUt+WHkDFmQAJlCvhPlaaVdzdavtgxZ6xx0csrTX2fSfbto1sWeYP7P3+8v85pRRU16FtWyzLAqvvexzHN9Z1xba9kuZ5xn4c7yKT+Cm0v7GmrtE0DbIsxzRNsIRUGMYDRanQdjOUXtG0E3S/Q/cbOrVAFh1xJlb6hZVPTZjxTY2QLZ5VDyvPBdI0A+cpkoRRJ8Y4xQZnnJOZ2OQKIfFXQ754YXGcUJ3FGEMURWRB4CNJEtzvd5xOJ4p93yfufD7D8zy4rovH4wHXc2DbXwhCH9fLBWEUwLZtWGVZYhxH1HUN80HDMCDPc9xuNzq0wczhHcdBURTEycJMliEMQ9RNTQ2r+okgCMzKOYkJIWDEq6pCHMfUTUpJmBG6Xq/gnBPHOEMURzSpEfZcD2nGaYMfsp4KauPmGKAAAAAASUVORK5CYII='); background-size: cover; display: block;\"\n  ></span>\n  <img\n        class=\"gatsby-resp-image-image\"\n        alt=\"excel-data\"\n        title=\"\"\n        src=\"/static/074ef4268e7766e1389edefaed597334/f058b/excel-data.png\"\n        srcset=\"/static/074ef4268e7766e1389edefaed597334/c26ae/excel-data.png 158w,\n/static/074ef4268e7766e1389edefaed597334/6bdcf/excel-data.png 315w,\n/static/074ef4268e7766e1389edefaed597334/f058b/excel-data.png 630w,\n/static/074ef4268e7766e1389edefaed597334/40601/excel-data.png 945w,\n/static/074ef4268e7766e1389edefaed597334/c1b63/excel-data.png 1200w\"\n        sizes=\"(max-width: 630px) 100vw, 630px\"\n        style=\"width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;\"\n        loading=\"lazy\"\n        decoding=\"async\"\n      />\n  </a>\n    </span></p>\n<p>Now, we will read this excel file in the Python script. Before starting, make sure to activate a virtual environment if you follow how to set up one from my previous post — <em>recommended to get used to using a virtual environment from the beginner level</em>.</p>\n<p>Once you activate the virtual environment, create a file named main.py. Inside main.py, we will import pandas and then, write a code that actually reads this excel file using pandas.</p>\n<div class=\"gatsby-highlight\" data-language=\"python\"><pre class=\"language-python\"><code class=\"language-python\"><span class=\"token keyword\">import</span> pandas <span class=\"token keyword\">as</span> pd\n\nexcel_data_df <span class=\"token operator\">=</span> pd<span class=\"token punctuation\">.</span>read_excel<span class=\"token punctuation\">(</span><span class=\"token string\">'sample_data.xlsx'</span><span class=\"token punctuation\">,</span> sheet_name<span class=\"token operator\">=</span><span class=\"token string\">'data1'</span><span class=\"token punctuation\">,</span> skiprows<span class=\"token operator\">=</span><span class=\"token number\">7</span><span class=\"token punctuation\">)</span>\n<span class=\"token keyword\">print</span><span class=\"token punctuation\">(</span>excel_data_df<span class=\"token punctuation\">)</span></code></pre></div>\n<p><strong>read_excel</strong> method takes in a few parameters. They are the path to the excel file, the name of the sheet and how many rows you want to skip here in this case. There are actually more parameters you can put in the method as you desire so check out the <a href=\"https://pandas.pydata.org/docs/reference/api/pandas.read_excel.html\"><strong>official documentation</strong></a> of pandas for more. Enter <code class=\"language-text\">python main.py</code> in the terminal and it will print out like:</p>\n<p><span\n      class=\"gatsby-resp-image-wrapper\"\n      style=\"position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 630px; \"\n    >\n      <a\n    class=\"gatsby-resp-image-link\"\n    href=\"/static/c76f1c48da613f1f6f8c9d0d66d6c5f5/38a65/read-log.png\"\n    style=\"display: block\"\n    target=\"_blank\"\n    rel=\"noopener\"\n  >\n    <span\n    class=\"gatsby-resp-image-background-image\"\n    style=\"padding-bottom: 22.151898734177216%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAECAYAAACOXx+WAAAACXBIWXMAAAsTAAALEwEAmpwYAAAAmklEQVR42k1PSQ7EMAjrU6pKVQgkgUT9/9c8Ml00B8usxmyjd/hwzJhYc2HO9eWEiECKJJ/nmVyl3lxrQlW/eNNac6GUknB37PuO3jrCI3n0kUco0h8Db43zrDdrt6CpQtWgVWFqWGvhOA5EBK7ryiUK020VgXvkJ/Ew63RIYWptVC1/DumIgmaWMY/wOmP2M28tQZfs8cPX4Q/sPHh4NgDzUgAAAABJRU5ErkJggg=='); background-size: cover; display: block;\"\n  ></span>\n  <img\n        class=\"gatsby-resp-image-image\"\n        alt=\"read-log\"\n        title=\"\"\n        src=\"/static/c76f1c48da613f1f6f8c9d0d66d6c5f5/f058b/read-log.png\"\n        srcset=\"/static/c76f1c48da613f1f6f8c9d0d66d6c5f5/c26ae/read-log.png 158w,\n/static/c76f1c48da613f1f6f8c9d0d66d6c5f5/6bdcf/read-log.png 315w,\n/static/c76f1c48da613f1f6f8c9d0d66d6c5f5/f058b/read-log.png 630w,\n/static/c76f1c48da613f1f6f8c9d0d66d6c5f5/40601/read-log.png 945w,\n/static/c76f1c48da613f1f6f8c9d0d66d6c5f5/38a65/read-log.png 1075w\"\n        sizes=\"(max-width: 630px) 100vw, 630px\"\n        style=\"width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;\"\n        loading=\"lazy\"\n        decoding=\"async\"\n      />\n  </a>\n    </span></p>\n<h2>Practice</h2>\n<p>Let’s say our goal is to calculate the ratio of the number of values that are between 9.0 and 9.4 to the whole in the column, <strong>MFD</strong>.</p>\n<p><span\n      class=\"gatsby-resp-image-wrapper\"\n      style=\"position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 475px; \"\n    >\n      <a\n    class=\"gatsby-resp-image-link\"\n    href=\"/static/099c9cc3831a2a98ff890b8322abd4b4/466da/mfd.png\"\n    style=\"display: block\"\n    target=\"_blank\"\n    rel=\"noopener\"\n  >\n    <span\n    class=\"gatsby-resp-image-background-image\"\n    style=\"padding-bottom: 32.911392405063296%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAHCAYAAAAIy204AAAACXBIWXMAAAsTAAALEwEAmpwYAAABYklEQVR42q2Oy07bQABF/f+rov5AWyIVWoEqwQJlFZxFSPNwEpKxxzYztvHbscfwA6eyK/EFXOlI92yursUnx1JKobXGFS5aRwyulMb3fXw/GF0rTRiGeJ5HFEW87vforYPe7Uj3B3QQIKVEehLr0Z4xt+f8+PadxeKJwe35I39ub7m/ux/7wPThgZvfNyyfltiTCb++XHB18RX7csJiNmM6nXL98wqrqHO6c4uzcej7N8q6GAmHd6Eae9UU5K8p4llg+p4k1aRKEwjJua7p+573t3cC6WPlVUbbnFkt/9J1hrLOKaoc9ygI/XD0gURHbFcOnTHEmSbPMqQMaLsOYwym6xBHgTU8ONcNm9UaY3qqphyRwhsHh143FWkcczqIcTDNE9I4wRUebdt+DB6cPZaKQoq8YL1aU5U1OlHoWCGOJ9yTS5So/7woDrtnyrLEC04kUUzgB2RZRlEUVGWJs9nyD1Xr+SusvfI3AAAAAElFTkSuQmCC'); background-size: cover; display: block;\"\n  ></span>\n  <img\n        class=\"gatsby-resp-image-image\"\n        alt=\"mfd\"\n        title=\"\"\n        src=\"/static/099c9cc3831a2a98ff890b8322abd4b4/466da/mfd.png\"\n        srcset=\"/static/099c9cc3831a2a98ff890b8322abd4b4/c26ae/mfd.png 158w,\n/static/099c9cc3831a2a98ff890b8322abd4b4/6bdcf/mfd.png 315w,\n/static/099c9cc3831a2a98ff890b8322abd4b4/466da/mfd.png 475w\"\n        sizes=\"(max-width: 475px) 100vw, 475px\"\n        style=\"width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;\"\n        loading=\"lazy\"\n        decoding=\"async\"\n      />\n  </a>\n    </span></p>\n<p>It is really simple to read the column. We can specify the name of the header in the data frame. If you print it out, you can see the only one column printed.</p>\n<p><span\n      class=\"gatsby-resp-image-wrapper\"\n      style=\"position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 630px; \"\n    >\n      <a\n    class=\"gatsby-resp-image-link\"\n    href=\"/static/24a3c2ffc071ecf1d18ae6f693a22f7b/0f2bc/read-data.png\"\n    style=\"display: block\"\n    target=\"_blank\"\n    rel=\"noopener\"\n  >\n    <span\n    class=\"gatsby-resp-image-background-image\"\n    style=\"padding-bottom: 8.860759493670885%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAACCAYAAABYBvyLAAAACXBIWXMAAAsTAAALEwEAmpwYAAAAd0lEQVR42i2IWxKCMBDAOIotSsvWsqU8uozo/W8Vh9GPTDLp7PywmtFexnEcnO+Tfa3Y1rDN2IqyTBnVhVIbqpUpRUSEuRpaFkSelLmRc6ZTzey2k5IwBCGOiSGMhCjEmHjcH8Qh0PcO5xz+wvd473Hu9nv/vvwFqmQ8olU27OAAAAAASUVORK5CYII='); background-size: cover; display: block;\"\n  ></span>\n  <img\n        class=\"gatsby-resp-image-image\"\n        alt=\"read-data\"\n        title=\"\"\n        src=\"/static/24a3c2ffc071ecf1d18ae6f693a22f7b/f058b/read-data.png\"\n        srcset=\"/static/24a3c2ffc071ecf1d18ae6f693a22f7b/c26ae/read-data.png 158w,\n/static/24a3c2ffc071ecf1d18ae6f693a22f7b/6bdcf/read-data.png 315w,\n/static/24a3c2ffc071ecf1d18ae6f693a22f7b/f058b/read-data.png 630w,\n/static/24a3c2ffc071ecf1d18ae6f693a22f7b/0f2bc/read-data.png 742w\"\n        sizes=\"(max-width: 630px) 100vw, 630px\"\n        style=\"width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;\"\n        loading=\"lazy\"\n        decoding=\"async\"\n      />\n  </a>\n    </span></p>\n<p>There are lots of ways to achieve our goal from here. You can go over each value of the list and count the number of values that meet the condition individually, but it will be just one line code if we use one of pandas’s methods, query. We will just pass a query in the valid form designated by their API to query method as an argument.</p>\n<p><span\n      class=\"gatsby-resp-image-wrapper\"\n      style=\"position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 590px; \"\n    >\n      <a\n    class=\"gatsby-resp-image-link\"\n    href=\"/static/cb99dd5f0f32c17dde61201d743799a6/fcda8/filter-data.png\"\n    style=\"display: block\"\n    target=\"_blank\"\n    rel=\"noopener\"\n  >\n    <span\n    class=\"gatsby-resp-image-background-image\"\n    style=\"padding-bottom: 27.848101265822784%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAGCAYAAADDl76dAAAACXBIWXMAAAsTAAALEwEAmpwYAAABBUlEQVR42n2QSW4DMQwE/RR7Fu37aNbA+f+vKpBiG8glhwZFipSKfTu+nuzXk1wqzge2Y+e8MiVbavZoLUnesiRHSY7gDVYrcjIIMTGOI9M09th0M05ivUIbwTSPKCOwTiL13M9Czn3QWIFQ06emtGAWE8MwMDwGhuH1YMwLSz1Z1oPj+sZ5j0+O88yce6XWle14UteTdbuIacVYQ60LueyE6Fm3QvSOWXRCRZP1Ghc02kqEmnmTN7172n3LpRadsOXy1dvmGvGteRGsxiiJ0wqtRKcIoZDyRso72/6Fc5b7/f674kuPx9/YdPNR9R+aN81HYyVSSUK2uGg7RSyOWMzH+P/0A2Iws3FDNG6NAAAAAElFTkSuQmCC'); background-size: cover; display: block;\"\n  ></span>\n  <img\n        class=\"gatsby-resp-image-image\"\n        alt=\"filter-data\"\n        title=\"\"\n        src=\"/static/cb99dd5f0f32c17dde61201d743799a6/fcda8/filter-data.png\"\n        srcset=\"/static/cb99dd5f0f32c17dde61201d743799a6/c26ae/filter-data.png 158w,\n/static/cb99dd5f0f32c17dde61201d743799a6/6bdcf/filter-data.png 315w,\n/static/cb99dd5f0f32c17dde61201d743799a6/fcda8/filter-data.png 590w\"\n        sizes=\"(max-width: 590px) 100vw, 590px\"\n        style=\"width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;\"\n        loading=\"lazy\"\n        decoding=\"async\"\n      />\n  </a>\n    </span></p>\n<p>When we pass the query <strong>`MFD` > 9.0 and `MFD` &#x3C;= 9.4</strong> and print the result out, it will show only values that meet the condition. Now we know the number of allthe values in the whole MFD columns and the number of the values that are between 9.0 and 9.4. so we can do the final math. The ratio is <strong>58.17</strong>.</p>\n<h2>Conclusion</h2>\n<p>We have just learned a tiny piece of pandas now. There are thousands of real world use cases for data analysis on excel. I hope you go further than this and deal with lots of examples so, you can make your tasks much easier or even automate them eventually.</p>\n<p><em><strong>THANKS FOR READING. SEE YOU NEXT TIME!</strong></em></p>\n<p><em>This is originally posted on my <a href=\"https://medium.com/@shkim04/how-to-use-pandas-for-excel-on-python-45ffb15af57e\">Medium</a>.</em>\n<em>Let's connect!</em></p>","frontmatter":{"title":"How To Use Pandas For Excel On Python","date":"30 Jan, 2023","description":"","tag":["Python"]},"fields":{"locale":"en"}},"previous":{"fields":{"slug":"/en/how-to-set-up-python-virtual-env"},"frontmatter":{"title":"How To Set Up a Virtual Environment On Windows"}},"next":{"fields":{"slug":"/en/how-to-use-aws-sqs-nodejs"},"frontmatter":{"title":"How To Use AWS SQS On Node.js"}}},"pageContext":{"locale":"en","isDefaultLang":false,"slug":"/en/pandas-for-excel-python","titleByLang":{"ko":"python-pandas-엑셀-사용하기","en":"pandas-for-excel-python"},"dateFormat":"DD MMM, YYYY","id":"80f6651d-4d08-5a50-8588-b38718b45d67","previousPostId":"543ce0a2-3f33-5ee5-aeb1-578fdf99a0b8","nextPostId":"6719ac9b-a265-5708-9b8c-5d0de3a784ba"}},"staticQueryHashes":[],"slicesMap":{}}