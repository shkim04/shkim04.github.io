{"componentChunkName":"component---src-templates-blog-post-js","path":"/2023-01-30/python-pandas-엑셀-사용하기/","result":{"data":{"site":{"siteMetadata":{"title":"Seunghyun's Blog"}},"markdownRemark":{"id":"ec2539c3-e069-5c78-8b26-97037ee075cd","excerpt":"Pandas의 공식 웹페이지 따르면 pandas is a fast, powerful, flexible and easy to use open source data analysis and manipulation tool, built on top of the Python programming…","html":"<p>Pandas의 공식 <a href=\"https://pandas.pydata.org/\">웹페이지</a> 따르면</p>\n<blockquote>\n<p>pandas is a fast, powerful, flexible and easy to use open source data analysis and manipulation tool, built on top of the Python programming language.</p>\n</blockquote>\n<p>특히, <strong>pandas</strong>는 엑셀 파일에 저장된 데이터를 분석하고 가공할 때 아주 용이하다. 실제 데이터 모델을 가지고 pandas를 엑셀에 활용하는 방법을 알아보자.</p>\n<h2>필수</h2>\n<ul>\n<li>가상 환경 설치 — <em><a href=\"https://shkim04.github.io/python-%EA%B0%80%EC%83%81%ED%99%98%EA%B2%BD-%EC%84%A4%EC%A0%95\">이전 글</a>에 가상 환경 설치에 대해 글을 적었으니 읽어보길 바란다</em></li>\n</ul>\n<h2>pandas 설치</h2>\n<div class=\"gatsby-highlight\" data-language=\"text\"><pre class=\"language-text\"><code class=\"language-text\">pip install pandas\r\npip list</code></pre></div>\n<p>설치가 완료가 되면 패키지 목록에 있는지 확인하여 설치가 잘 되었는지 확인해보자. 목록은 다음과 같이 생겼다:</p>\n<p><span\n      class=\"gatsby-resp-image-wrapper\"\n      style=\"position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 313px; \"\n    >\n      <a\n    class=\"gatsby-resp-image-link\"\n    href=\"/static/9af7fa5999d8699318e46d5d73d1002e/80977/pip-list.png\"\n    style=\"display: block\"\n    target=\"_blank\"\n    rel=\"noopener\"\n  >\n    <span\n    class=\"gatsby-resp-image-background-image\"\n    style=\"padding-bottom: 86.70886075949367%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAARCAYAAADdRIy+AAAACXBIWXMAAAsTAAALEwEAmpwYAAACm0lEQVR42m1U23KiQBTMVySVrKJcBNxaDYhyl2G4DXjJ1j7n/7+jt85RE3H3YRwsmj6n+/TMk2ma8DwPq9UvrFdr+P4GwSZAsNlgvVrBsiwYhgHC0b5cLuG6Lu/0nWWZX+9pPS0WNk6nI4LAR1U1+H3+g65pMKgeH+czXNeBrusMpj1NUqRJgjhOoLoOpqHDMMxvQtu2kaYpDsMRx+MRnrfGZDLhj3XDGFXXdQPhbocgCKBUB8/zEWz8r4LXDi1kaYZeDTifTojjkCX9XC5HZLcOozBEkqQQokCW5vx/Pp9/E1rWAl3X4ePjBNX3OB0H9KrHPs9GlW8dxlEEKSskcYzT4Yi6ktA07a5D20bTNOzHwF2esXTdf7pjQsPANtgijhKE4Q5RFMK4Fb3i2UOlFNqmhihKVFJ+EdKEaY0lR4iiCOEuZMLFYjGesuM4l+6GHrOZhufnZ8xmM2jaFNPpdWka5vocmjZDKSX7F5KXcYIkicYeEqGUEl3XolcdZFnyJOuqRds0qOsKpdhD7AV8z8d2GyDPc6RpwqSXHN7HxnHQdi3KUrBcWQp47++oqwsZ+SuKPfIsh+95TCJEyYQkmSwbS3YdzhTJTtMYLy8v+DGZ4PX1FW9vb5xJmiLZMJ1qKIoCn5+f6PuOT9Q2CMaSydSqqtC1DXtTVRJZlqEUgk+DbS8YSMOh2NQ1Da9AlqVszcZ/CDb9yFLylPu+R69alk7+UTeObXNcbjkkMjp+eZZxJnfb7WOwLYhCMJCmTDJJIskjmeOjp7NEIjkMigsKIcbBNk2LO+yVwj7PeSD6NYP/CzZhKYOHYeABBY8e2raDSlYMoMvhUcL9Mm6E4YWQbh0K+oiQQNpM+w7w9aVxd9PcP2tXDOFpv8cT4V+v1Q2lLvfJKgAAAABJRU5ErkJggg=='); background-size: cover; display: block;\"\n  ></span>\n  <img\n        class=\"gatsby-resp-image-image\"\n        alt=\"pip-list\"\n        title=\"\"\n        src=\"/static/9af7fa5999d8699318e46d5d73d1002e/80977/pip-list.png\"\n        srcset=\"/static/9af7fa5999d8699318e46d5d73d1002e/c26ae/pip-list.png 158w,\n/static/9af7fa5999d8699318e46d5d73d1002e/80977/pip-list.png 313w\"\n        sizes=\"(max-width: 313px) 100vw, 313px\"\n        style=\"width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;\"\n        loading=\"lazy\"\n        decoding=\"async\"\n      />\n  </a>\n    </span></p>\n<p>다른 패키지도 설치된 것을 확인할 수 있는데 이들은 pandas를 설치하면 같이 설치되는 일종의 묶음 패키지이다. 이 패키지들이 없으면 pandas가 정상적으로 동작하지 않을 수 있다.</p>\n<h2>엑셀 데이터 분석</h2>\n<p>실제 데이터 모델과 이 글에 적혀 있는 코드가 개인 <a href=\"https://github.com/shkim04/python_practice\"><strong>레파지토리</strong></a> 있으니 따로 연습할 데이터가 없는 독자들은 다운로드 받아도 된다. 샘플 데이터는 다음과 생겼다:</p>\n<p><span\n      class=\"gatsby-resp-image-wrapper\"\n      style=\"position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 630px; \"\n    >\n      <a\n    class=\"gatsby-resp-image-link\"\n    href=\"/static/074ef4268e7766e1389edefaed597334/c1b63/excel-data.png\"\n    style=\"display: block\"\n    target=\"_blank\"\n    rel=\"noopener\"\n  >\n    <span\n    class=\"gatsby-resp-image-background-image\"\n    style=\"padding-bottom: 36.075949367088604%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAHCAYAAAAIy204AAAACXBIWXMAAAsTAAALEwEAmpwYAAABQElEQVR42lVR2Y6DMAzk/z+sUt+WHkDFmQAJlCvhPlaaVdzdavtgxZ6xx0csrTX2fSfbto1sWeYP7P3+8v85pRRU16FtWyzLAqvvexzHN9Z1xba9kuZ5xn4c7yKT+Cm0v7GmrtE0DbIsxzRNsIRUGMYDRanQdjOUXtG0E3S/Q/cbOrVAFh1xJlb6hZVPTZjxTY2QLZ5VDyvPBdI0A+cpkoRRJ8Y4xQZnnJOZ2OQKIfFXQ754YXGcUJ3FGEMURWRB4CNJEtzvd5xOJ4p93yfufD7D8zy4rovH4wHXc2DbXwhCH9fLBWEUwLZtWGVZYhxH1HUN80HDMCDPc9xuNzq0wczhHcdBURTEycJMliEMQ9RNTQ2r+okgCMzKOYkJIWDEq6pCHMfUTUpJmBG6Xq/gnBPHOEMURzSpEfZcD2nGaYMfsp4KauPmGKAAAAAASUVORK5CYII='); background-size: cover; display: block;\"\n  ></span>\n  <img\n        class=\"gatsby-resp-image-image\"\n        alt=\"excel-data\"\n        title=\"\"\n        src=\"/static/074ef4268e7766e1389edefaed597334/f058b/excel-data.png\"\n        srcset=\"/static/074ef4268e7766e1389edefaed597334/c26ae/excel-data.png 158w,\n/static/074ef4268e7766e1389edefaed597334/6bdcf/excel-data.png 315w,\n/static/074ef4268e7766e1389edefaed597334/f058b/excel-data.png 630w,\n/static/074ef4268e7766e1389edefaed597334/40601/excel-data.png 945w,\n/static/074ef4268e7766e1389edefaed597334/c1b63/excel-data.png 1200w\"\n        sizes=\"(max-width: 630px) 100vw, 630px\"\n        style=\"width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;\"\n        loading=\"lazy\"\n        decoding=\"async\"\n      />\n  </a>\n    </span></p>\n<p>Python 스크립트에 이 엑셀 파일을 읽어보자. 먼저 시작하기 전에 이전 글에서 다룬 가상 환경을 꼭 설치하고 활성화하길 바란다 - <em>Python에 입문한 독자들도 미리 익숙해질 수 있게 설치를 권장한다</em>.</p>\n<p>가상 환경을 활성화시켰다면 <strong>main.py</strong>라는 이름의 파일을 생성한다. pandas를 import하고 아래와 같이 엑셀 파일을 읽는 코드를 입력한다.</p>\n<div class=\"gatsby-highlight\" data-language=\"python\"><pre class=\"language-python\"><code class=\"language-python\"><span class=\"token keyword\">import</span> pandas <span class=\"token keyword\">as</span> pd\r\n\r\nexcel_data_df <span class=\"token operator\">=</span> pd<span class=\"token punctuation\">.</span>read_excel<span class=\"token punctuation\">(</span><span class=\"token string\">'sample_data.xlsx'</span><span class=\"token punctuation\">,</span> sheet_name<span class=\"token operator\">=</span><span class=\"token string\">'data1'</span><span class=\"token punctuation\">,</span> skiprows<span class=\"token operator\">=</span><span class=\"token number\">7</span><span class=\"token punctuation\">)</span>\r\n<span class=\"token keyword\">print</span><span class=\"token punctuation\">(</span>excel_data_df<span class=\"token punctuation\">)</span></code></pre></div>\n<p><strong>read_excel</strong> 메소드는 여러 인자를 받는다. 위의 코드에서는 엑셀 파일의 경로, 시트 이름, 건너 뛸 행의 개수가 되겠다. 더 많은 인자들을 해당 메소드에 입력할 수 있는데 필요에 따라 pandas <a href=\"https://pandas.pydata.org/docs/reference/api/pandas.read_excel.html\">공식 문서</a>에서 확인 바란다. 터미널을 열어 <code class=\"language-text\">python main.py</code>을 입력하여 실행하면 다음과 같이 출력된다:</p>\n<p><span\n      class=\"gatsby-resp-image-wrapper\"\n      style=\"position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 630px; \"\n    >\n      <a\n    class=\"gatsby-resp-image-link\"\n    href=\"/static/c76f1c48da613f1f6f8c9d0d66d6c5f5/38a65/read-log.png\"\n    style=\"display: block\"\n    target=\"_blank\"\n    rel=\"noopener\"\n  >\n    <span\n    class=\"gatsby-resp-image-background-image\"\n    style=\"padding-bottom: 22.151898734177216%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAECAYAAACOXx+WAAAACXBIWXMAAAsTAAALEwEAmpwYAAAAmklEQVR42k1PSQ7EMAjrU6pKVQgkgUT9/9c8Ml00B8usxmyjd/hwzJhYc2HO9eWEiECKJJ/nmVyl3lxrQlW/eNNac6GUknB37PuO3jrCI3n0kUco0h8Db43zrDdrt6CpQtWgVWFqWGvhOA5EBK7ryiUK020VgXvkJ/Ew63RIYWptVC1/DumIgmaWMY/wOmP2M28tQZfs8cPX4Q/sPHh4NgDzUgAAAABJRU5ErkJggg=='); background-size: cover; display: block;\"\n  ></span>\n  <img\n        class=\"gatsby-resp-image-image\"\n        alt=\"read-log\"\n        title=\"\"\n        src=\"/static/c76f1c48da613f1f6f8c9d0d66d6c5f5/f058b/read-log.png\"\n        srcset=\"/static/c76f1c48da613f1f6f8c9d0d66d6c5f5/c26ae/read-log.png 158w,\n/static/c76f1c48da613f1f6f8c9d0d66d6c5f5/6bdcf/read-log.png 315w,\n/static/c76f1c48da613f1f6f8c9d0d66d6c5f5/f058b/read-log.png 630w,\n/static/c76f1c48da613f1f6f8c9d0d66d6c5f5/40601/read-log.png 945w,\n/static/c76f1c48da613f1f6f8c9d0d66d6c5f5/38a65/read-log.png 1075w\"\n        sizes=\"(max-width: 630px) 100vw, 630px\"\n        style=\"width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;\"\n        loading=\"lazy\"\n        decoding=\"async\"\n      />\n  </a>\n    </span></p>\n<h2>연습</h2>\n<p><strong>MFD</strong> 열에 있는 값들 중 9.0과 9.4 사이에 존재하는 값의 수 대 전체 값의 개수의 비를 계산해보자.</p>\n<p><span\n      class=\"gatsby-resp-image-wrapper\"\n      style=\"position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 475px; \"\n    >\n      <a\n    class=\"gatsby-resp-image-link\"\n    href=\"/static/099c9cc3831a2a98ff890b8322abd4b4/466da/mfd.png\"\n    style=\"display: block\"\n    target=\"_blank\"\n    rel=\"noopener\"\n  >\n    <span\n    class=\"gatsby-resp-image-background-image\"\n    style=\"padding-bottom: 32.911392405063296%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAHCAYAAAAIy204AAAACXBIWXMAAAsTAAALEwEAmpwYAAABYklEQVR42q2Oy07bQABF/f+rov5AWyIVWoEqwQJlFZxFSPNwEpKxxzYztvHbscfwA6eyK/EFXOlI92yursUnx1JKobXGFS5aRwyulMb3fXw/GF0rTRiGeJ5HFEW87vforYPe7Uj3B3QQIKVEehLr0Z4xt+f8+PadxeKJwe35I39ub7m/ux/7wPThgZvfNyyfltiTCb++XHB18RX7csJiNmM6nXL98wqrqHO6c4uzcej7N8q6GAmHd6Eae9UU5K8p4llg+p4k1aRKEwjJua7p+573t3cC6WPlVUbbnFkt/9J1hrLOKaoc9ygI/XD0gURHbFcOnTHEmSbPMqQMaLsOYwym6xBHgTU8ONcNm9UaY3qqphyRwhsHh143FWkcczqIcTDNE9I4wRUebdt+DB6cPZaKQoq8YL1aU5U1OlHoWCGOJ9yTS5So/7woDrtnyrLEC04kUUzgB2RZRlEUVGWJs9nyD1Xr+SusvfI3AAAAAElFTkSuQmCC'); background-size: cover; display: block;\"\n  ></span>\n  <img\n        class=\"gatsby-resp-image-image\"\n        alt=\"mfd\"\n        title=\"\"\n        src=\"/static/099c9cc3831a2a98ff890b8322abd4b4/466da/mfd.png\"\n        srcset=\"/static/099c9cc3831a2a98ff890b8322abd4b4/c26ae/mfd.png 158w,\n/static/099c9cc3831a2a98ff890b8322abd4b4/6bdcf/mfd.png 315w,\n/static/099c9cc3831a2a98ff890b8322abd4b4/466da/mfd.png 475w\"\n        sizes=\"(max-width: 475px) 100vw, 475px\"\n        style=\"width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;\"\n        loading=\"lazy\"\n        decoding=\"async\"\n      />\n  </a>\n    </span></p>\n<p>해당 열은 data frame에서 해당 열의 헤더의 이름, 즉 MFD를 입력하면 읽을 수 있다. 로그를 출력해보면 해당 열만 출력될 것이다.</p>\n<p><span\n      class=\"gatsby-resp-image-wrapper\"\n      style=\"position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 630px; \"\n    >\n      <a\n    class=\"gatsby-resp-image-link\"\n    href=\"/static/24a3c2ffc071ecf1d18ae6f693a22f7b/0f2bc/read-data.png\"\n    style=\"display: block\"\n    target=\"_blank\"\n    rel=\"noopener\"\n  >\n    <span\n    class=\"gatsby-resp-image-background-image\"\n    style=\"padding-bottom: 8.860759493670885%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAACCAYAAABYBvyLAAAACXBIWXMAAAsTAAALEwEAmpwYAAAAd0lEQVR42i2IWxKCMBDAOIotSsvWsqU8uozo/W8Vh9GPTDLp7PywmtFexnEcnO+Tfa3Y1rDN2IqyTBnVhVIbqpUpRUSEuRpaFkSelLmRc6ZTzey2k5IwBCGOiSGMhCjEmHjcH8Qh0PcO5xz+wvd473Hu9nv/vvwFqmQ8olU27OAAAAAASUVORK5CYII='); background-size: cover; display: block;\"\n  ></span>\n  <img\n        class=\"gatsby-resp-image-image\"\n        alt=\"read-data\"\n        title=\"\"\n        src=\"/static/24a3c2ffc071ecf1d18ae6f693a22f7b/f058b/read-data.png\"\n        srcset=\"/static/24a3c2ffc071ecf1d18ae6f693a22f7b/c26ae/read-data.png 158w,\n/static/24a3c2ffc071ecf1d18ae6f693a22f7b/6bdcf/read-data.png 315w,\n/static/24a3c2ffc071ecf1d18ae6f693a22f7b/f058b/read-data.png 630w,\n/static/24a3c2ffc071ecf1d18ae6f693a22f7b/0f2bc/read-data.png 742w\"\n        sizes=\"(max-width: 630px) 100vw, 630px\"\n        style=\"width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;\"\n        loading=\"lazy\"\n        decoding=\"async\"\n      />\n  </a>\n    </span></p>\n<p>사실 목표값을 찾는 방법은 여럿이 될 수 있다. 열의 값으로 이루어진 배열을 일일이 확인하여 조건에 맞는 값들만 센 후 계산할 수도 있다. 하지만 pandas의 query를 이용하면 단 한 줄의 코드로 원하는 값을 얻을 수 있다. pandas API에 지정된 형태로 정확히 query를 입력하면 된다.</p>\n<p><span\n      class=\"gatsby-resp-image-wrapper\"\n      style=\"position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 590px; \"\n    >\n      <a\n    class=\"gatsby-resp-image-link\"\n    href=\"/static/cb99dd5f0f32c17dde61201d743799a6/fcda8/filter-data.png\"\n    style=\"display: block\"\n    target=\"_blank\"\n    rel=\"noopener\"\n  >\n    <span\n    class=\"gatsby-resp-image-background-image\"\n    style=\"padding-bottom: 27.848101265822784%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAGCAYAAADDl76dAAAACXBIWXMAAAsTAAALEwEAmpwYAAABBUlEQVR42n2QSW4DMQwE/RR7Fu37aNbA+f+vKpBiG8glhwZFipSKfTu+nuzXk1wqzge2Y+e8MiVbavZoLUnesiRHSY7gDVYrcjIIMTGOI9M09th0M05ivUIbwTSPKCOwTiL13M9Czn3QWIFQ06emtGAWE8MwMDwGhuH1YMwLSz1Z1oPj+sZ5j0+O88yce6XWle14UteTdbuIacVYQ60LueyE6Fm3QvSOWXRCRZP1Ghc02kqEmnmTN7172n3LpRadsOXy1dvmGvGteRGsxiiJ0wqtRKcIoZDyRso72/6Fc5b7/f674kuPx9/YdPNR9R+aN81HYyVSSUK2uGg7RSyOWMzH+P/0A2Iws3FDNG6NAAAAAElFTkSuQmCC'); background-size: cover; display: block;\"\n  ></span>\n  <img\n        class=\"gatsby-resp-image-image\"\n        alt=\"filter-data\"\n        title=\"\"\n        src=\"/static/cb99dd5f0f32c17dde61201d743799a6/fcda8/filter-data.png\"\n        srcset=\"/static/cb99dd5f0f32c17dde61201d743799a6/c26ae/filter-data.png 158w,\n/static/cb99dd5f0f32c17dde61201d743799a6/6bdcf/filter-data.png 315w,\n/static/cb99dd5f0f32c17dde61201d743799a6/fcda8/filter-data.png 590w\"\n        sizes=\"(max-width: 590px) 100vw, 590px\"\n        style=\"width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;\"\n        loading=\"lazy\"\n        decoding=\"async\"\n      />\n  </a>\n    </span></p>\n<p>query <strong>`MFD` > 9.0 and `MFD` &#x3C;= 9.4</strong> 를 입력하고 로그를 출력하면 조건에 맞는 값들만 출력될 것이다. MFD 열의 값 전체 개수와 9.0와 9.4사이에 존재하는 값의 개수를 알게 되었고 계산하게 되면 답은 58.17이란 걸 알 수 있다.</p>\n<h2>결론</h2>\n<p>pandas의 아주 작은 일부만 살펴보앗다. pandas가 엑셀 혹은 기타 데이터를 다루는 예는 무궁무진할 것이다. 독자들이 다른 많은 예제들을 접하면서 pandas를 유용하게 사용하셨으면 좋겠다.</p>\n<p><em><strong>읽어 주셔서 감사합니다. To be continued!</strong></em></p>\n<p><em>이 글은 <a href=\"https://medium.com/@shkim04/how-to-use-pandas-for-excel-on-python-45ffb15af57e\">Medium</a>에도 업로드 되었습니다.</em>\r\n<em>놀러 오세요!</em></p>","frontmatter":{"title":"Python에서 pandas로 엑셀 다루기","date":"2023년 01월 30일","description":"","tag":["Python"]},"fields":{"locale":"ko"}},"previous":{"fields":{"slug":"/2023-01-19/python-가상환경-설정"},"frontmatter":{"title":"윈도우에 Python 가상 환경 설치하기"}},"next":{"fields":{"slug":"/2023-02-05/nodejs-aws-sqs-사용하기"},"frontmatter":{"title":"Node.js 어플리케이션에서 AWS SQS 사용하기"}}},"pageContext":{"locale":"ko","isDefaultLang":true,"slug":"/2023-01-30/python-pandas-엑셀-사용하기","titleByLang":{"ko":"python-pandas-엑셀-사용하기","en":"pandas-for-excel-python"},"dateFormat":"YYYY년 MM월 DD일","id":"ec2539c3-e069-5c78-8b26-97037ee075cd","previousPostId":"ddd50cac-257e-5b75-a65f-342b4583f255","nextPostId":"c2d7da30-da2c-5563-8634-e108baa88ade"}},"staticQueryHashes":[],"slicesMap":{}}