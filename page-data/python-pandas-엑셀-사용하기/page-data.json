{"componentChunkName":"component---src-templates-blog-post-js","path":"/python-pandas-엑셀-사용하기/","result":{"data":{"site":{"siteMetadata":{"title":"Seunghyun's Blog"}},"markdownRemark":{"id":"ec2539c3-e069-5c78-8b26-97037ee075cd","excerpt":"Pandas의 공식 웹페이지 따르면 pandas is a fast, powerful, flexible and easy to use open source data analysis and manipulation tool, built on top of the Python programming…","html":"<p>Pandas의 공식 <a href=\"https://pandas.pydata.org/\">웹페이지</a> 따르면</p>\n<blockquote>\n<p>pandas is a fast, powerful, flexible and easy to use open source data analysis and manipulation tool, built on top of the Python programming language.</p>\n</blockquote>\n<p>특히, <strong>pandas</strong>는 엑셀 파일에 저장된 데이터를 분석하고 가공할 때 아주 용이하다. 실제 데이터 모델을 가지고 pandas를 엑셀에 활용하는 방법을 알아보자.</p>\n<h2>필수</h2>\n<ul>\n<li>가상 환경 설치 — <em><a href=\"https://shkim04.github.io/python-%EA%B0%80%EC%83%81%ED%99%98%EA%B2%BD-%EC%84%A4%EC%A0%95\">이전 글</a>에 가상 환경 설치에 대해 글을 적었으니 읽어보길 바란다</em></li>\n</ul>\n<h2>pandas 설치</h2>\n<div class=\"gatsby-highlight\" data-language=\"text\"><pre class=\"language-text\"><code class=\"language-text\">pip install pandas\r\npip list</code></pre></div>\n<p>설치가 완료가 되면 패키지 목록에 있는지 확인하여 설치가 잘 되었는지 확인해보자. 목록은 다음과 같이 생겼다:</p>\n<p><span\n      class=\"gatsby-resp-image-wrapper\"\n      style=\"position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 313px; \"\n    >\n      <a\n    class=\"gatsby-resp-image-link\"\n    href=\"/static/9af7fa5999d8699318e46d5d73d1002e/80977/pip-list.png\"\n    style=\"display: block\"\n    target=\"_blank\"\n    rel=\"noopener\"\n  >\n    <span\n    class=\"gatsby-resp-image-background-image\"\n    style=\"padding-bottom: 86.70886075949367%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAARCAYAAADdRIy+AAAACXBIWXMAAAsTAAALEwEAmpwYAAACoUlEQVR42mVT2XaiUBD0J2bOxAVlkcU5MbIIKMhy2S6KyTnzmvn/36g53U4SMQ/NZWmqu7qqJ7puwHV3eH5+xnb7As/zEfg+fN/DdruFYRjQdf0zNs4Gjm3z6brut++TtWnieh0Q+B4qUePt+gddXaOXPd6ur3BsC6qm8Y+qquF4PHIc4gNk20LXtTGgaVlIjkdc+gHDZYC7e8F8PoeqqtC0cTI9R/sQQeCjkx3cncdMKPerw/UaSZKgl2dchysOcQTHcfB7s4H2UJ06jaKIOyzyHGmSIopCrFarT+oTw1ijbVu8vQ6QUmIYevRSIkvTUeWPDuMohhAVDocYw+WCqhJQFOUL0DRN1E2DrmvRdz1ehys2jj0CugfcBwHi6IAoDBHFETRtXHRiWRak7NA0NYq8RCUENo7DH6nqfaiaypTjOEYY0hnBNNcPgLbN3Z3PPRRlgR8/f2K5XPL9Yr7AYkGhQFVX/L4UAkWRIQxDHGJSPB7PkABLUaJrG/SygxAl06mrFl3ToK4rlEWGIivguR4rnKYpO4MEMQz9O+W2a1EWOYQQEGWJ3W6Hum7R1DWapkGRZzilJ3iuy5SLomDAOIpgmeYY0LZtVpdop8kRT7+emOZ0OsVsNuV7okq0FoqCLMvx/v4XUrbw/dtWPfjQRCUqpkzeIhuQv8qi4G24Df0mCqlcVxXyLEeaJjxH33PHgJRcliWrLPsesmuZOj3nWQbLMj83hs48z5lumiSs9n6/Z8CRsfO84J9XqyVms9l/lRU+79ePNoVEIS+ee4ksy5gV5d0BGhCluG3H6QT3ZccgH957NDblkgcv5zOrHATBmDKpTDOkhMvlwtXvfTUG1Hk8NDvKP7J1orEP6aIsl2xeovm4v49BOQQwny/4pLi3zT/31A+Z8gWGpgAAAABJRU5ErkJggg=='); background-size: cover; display: block;\"\n  ></span>\n  <img\n        class=\"gatsby-resp-image-image\"\n        alt=\"pip-list\"\n        title=\"\"\n        src=\"/static/9af7fa5999d8699318e46d5d73d1002e/80977/pip-list.png\"\n        srcset=\"/static/9af7fa5999d8699318e46d5d73d1002e/c26ae/pip-list.png 158w,\n/static/9af7fa5999d8699318e46d5d73d1002e/80977/pip-list.png 313w\"\n        sizes=\"(max-width: 313px) 100vw, 313px\"\n        style=\"width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;\"\n        loading=\"lazy\"\n        decoding=\"async\"\n      />\n  </a>\n    </span></p>\n<p>다른 패키지도 설치된 것을 확인할 수 있는데 이들은 pandas를 설치하면 같이 설치되는 일종의 묶음 패키지이다. 이 패키지들이 없으면 pandas가 정상적으로 동작하지 않을 수 있다.</p>\n<h2>엑셀 데이터 분석</h2>\n<p>실제 데이터 모델과 이 글에 적혀 있는 코드가 개인 <a href=\"https://github.com/shkim04/python_practice\"><strong>레파지토리</strong></a> 있으니 따로 연습할 데이터가 없는 독자들은 다운로드 받아도 된다. 샘플 데이터는 다음과 생겼다:</p>\n<p><span\n      class=\"gatsby-resp-image-wrapper\"\n      style=\"position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 630px; \"\n    >\n      <a\n    class=\"gatsby-resp-image-link\"\n    href=\"/static/074ef4268e7766e1389edefaed597334/c1b63/excel-data.png\"\n    style=\"display: block\"\n    target=\"_blank\"\n    rel=\"noopener\"\n  >\n    <span\n    class=\"gatsby-resp-image-background-image\"\n    style=\"padding-bottom: 36.075949367088604%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAHCAYAAAAIy204AAAACXBIWXMAAAsTAAALEwEAmpwYAAABSElEQVR42lVRXW+DMAzk//+wSuvToO0gg1EKBCifCZRCgOomu2LSHiznLvbZuVhaa6zrwmGM4ZimCcuy/MW6rv/wm6NsoJWCUgpt22GeJ1h93+P12lhoLybBbdv+hPYBhHdunmcYs6BpGrRtC5lKjOMTVlZoDOOKotRo1QTVGzTdiH5YoYcFnZqQFx1nwro36PSMsurRdk90eoLSM9dU9QAryzKkaYo4ThBFN0gpEccx453fQ8oMeV5g73mfc87Xa8Q1Vny7IQxDjiAIEEURLpcLDocDY9/3+e54/IAQAp7nQXwLuN4XbPsTwY+P08lBGAawbRvW/X7H4/FAXdegDyJPaUsSJW+II9Nd10VRFEhTiTzPITPJg+qm4lzVJS9gUTMZS88oy5KFaUvHcbiROBp6Pp+RJAnfkSXXKOSNs0zC8wRSmUAID7+mUgs0QV8FUwAAAABJRU5ErkJggg=='); background-size: cover; display: block;\"\n  ></span>\n  <img\n        class=\"gatsby-resp-image-image\"\n        alt=\"excel-data\"\n        title=\"\"\n        src=\"/static/074ef4268e7766e1389edefaed597334/f058b/excel-data.png\"\n        srcset=\"/static/074ef4268e7766e1389edefaed597334/c26ae/excel-data.png 158w,\n/static/074ef4268e7766e1389edefaed597334/6bdcf/excel-data.png 315w,\n/static/074ef4268e7766e1389edefaed597334/f058b/excel-data.png 630w,\n/static/074ef4268e7766e1389edefaed597334/40601/excel-data.png 945w,\n/static/074ef4268e7766e1389edefaed597334/c1b63/excel-data.png 1200w\"\n        sizes=\"(max-width: 630px) 100vw, 630px\"\n        style=\"width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;\"\n        loading=\"lazy\"\n        decoding=\"async\"\n      />\n  </a>\n    </span></p>\n<p>Python 스크립트에 이 엑셀 파일을 읽어보자. 먼저 시작하기 전에 이전 글에서 다룬 가상 환경을 꼭 설치하고 활성화하길 바란다 - <em>Python에 입문한 독자들도 미리 익숙해질 수 있게 설치를 권장한다</em>.</p>\n<p>가상 환경을 활성화시켰다면 <strong>main.py</strong>라는 이름의 파일을 생성한다. pandas를 import하고 아래와 같이 엑셀 파일을 읽는 코드를 입력한다.</p>\n<div class=\"gatsby-highlight\" data-language=\"python\"><pre class=\"language-python\"><code class=\"language-python\"><span class=\"token keyword\">import</span> pandas <span class=\"token keyword\">as</span> pd\r\n\r\nexcel_data_df <span class=\"token operator\">=</span> pd<span class=\"token punctuation\">.</span>read_excel<span class=\"token punctuation\">(</span><span class=\"token string\">'sample_data.xlsx'</span><span class=\"token punctuation\">,</span> sheet_name<span class=\"token operator\">=</span><span class=\"token string\">'data1'</span><span class=\"token punctuation\">,</span> skiprows<span class=\"token operator\">=</span><span class=\"token number\">7</span><span class=\"token punctuation\">)</span>\r\n<span class=\"token keyword\">print</span><span class=\"token punctuation\">(</span>excel_data_df<span class=\"token punctuation\">)</span></code></pre></div>\n<p><strong>read_excel</strong> 메소드는 여러 인자를 받는다. 위의 코드에서는 엑셀 파일의 경로, 시트 이름, 건너 뛸 행의 개수가 되겠다. 더 많은 인자들을 해당 메소드에 입력할 수 있는데 필요에 따라 pandas <a href=\"https://pandas.pydata.org/docs/reference/api/pandas.read_excel.html\">공식 문서</a>에서 확인 바란다. 터미널을 열어 <code class=\"language-text\">python main.py</code>을 입력하여 실행하면 다음과 같이 출력된다:</p>\n<p><span\n      class=\"gatsby-resp-image-wrapper\"\n      style=\"position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 630px; \"\n    >\n      <a\n    class=\"gatsby-resp-image-link\"\n    href=\"/static/c76f1c48da613f1f6f8c9d0d66d6c5f5/38a65/read-log.png\"\n    style=\"display: block\"\n    target=\"_blank\"\n    rel=\"noopener\"\n  >\n    <span\n    class=\"gatsby-resp-image-background-image\"\n    style=\"padding-bottom: 22.151898734177216%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAECAYAAACOXx+WAAAACXBIWXMAAAsTAAALEwEAmpwYAAAAqElEQVR42jVQba7DMAjrVbqqGhASAn27/9H8ZKb9QOYj2CbHWgsRG5mFpwpVhYhA7kRmQlUhIo33fUNFYapdm1rjGANm1vXBREQhb+lFkp/niTkncm8sn4gWDagI1lzYEYgV2LE7KOLuX8JhAwwWRLp8va52+Pn79CKJK6vdkIA55089nZuN7tPp8Tvp55DOruuCD8f02Y+ozj7nFJ3ucJ/gd3HGPpFc/0QWePkR0PU+AAAAAElFTkSuQmCC'); background-size: cover; display: block;\"\n  ></span>\n  <img\n        class=\"gatsby-resp-image-image\"\n        alt=\"read-log\"\n        title=\"\"\n        src=\"/static/c76f1c48da613f1f6f8c9d0d66d6c5f5/f058b/read-log.png\"\n        srcset=\"/static/c76f1c48da613f1f6f8c9d0d66d6c5f5/c26ae/read-log.png 158w,\n/static/c76f1c48da613f1f6f8c9d0d66d6c5f5/6bdcf/read-log.png 315w,\n/static/c76f1c48da613f1f6f8c9d0d66d6c5f5/f058b/read-log.png 630w,\n/static/c76f1c48da613f1f6f8c9d0d66d6c5f5/40601/read-log.png 945w,\n/static/c76f1c48da613f1f6f8c9d0d66d6c5f5/38a65/read-log.png 1075w\"\n        sizes=\"(max-width: 630px) 100vw, 630px\"\n        style=\"width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;\"\n        loading=\"lazy\"\n        decoding=\"async\"\n      />\n  </a>\n    </span></p>\n<h2>연습</h2>\n<p><strong>MFD</strong> 열에 있는 값들 중 9.0과 9.4 사이에 존재하는 값의 수 대 전체 값의 개수의 비를 계산해보자.</p>\n<p><span\n      class=\"gatsby-resp-image-wrapper\"\n      style=\"position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 475px; \"\n    >\n      <a\n    class=\"gatsby-resp-image-link\"\n    href=\"/static/099c9cc3831a2a98ff890b8322abd4b4/466da/mfd.png\"\n    style=\"display: block\"\n    target=\"_blank\"\n    rel=\"noopener\"\n  >\n    <span\n    class=\"gatsby-resp-image-background-image\"\n    style=\"padding-bottom: 32.911392405063296%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAHCAYAAAAIy204AAAACXBIWXMAAAsTAAALEwEAmpwYAAABd0lEQVR42nWOy27TQBRA/f+rwhcALaK8KiS6KFk1caQQShK7TezxA4/jJPb4EY/dsk0OyixQhcSVzuLMXB1d63g88nxO/vztXz/N4XD477+VJBIpJb7nk6YpSZIYD8OQKIr+ehzHCCHMzsZxkfM50nHYuS4yihBBQCACrKE9ZDyyefPqNZPJd0b2kNF4xJerK66/XmOPR4bBzQ2fPn5mOp1iX1zw4ewFl2cvsc/fMrm95dtgwPt3l1iqLtD7Fnfu0PePlLUy/IpiZCKpakXVKIrtFm/p0/U9m13KLk2JRUjbNPR9z++nJ6IwwiqqnLbZczf9gdYdZV2gqgKx9IjD2PiJTZqy+LlAdx3rPCXf5YRBRKs1XdehtcZbeVina/Z1w+xuZoJVXRoCX5hg1ZTUTck2y1g9eCa4KzZssw3CC2jb1gQ7rbl37rGSdYzKCxMsy4o0S5BZgr/y8FfCuCGRPLhLVKkQ8YpsvSYKY/I8RylFVZY4swV/AL+F+dgYKjdDAAAAAElFTkSuQmCC'); background-size: cover; display: block;\"\n  ></span>\n  <img\n        class=\"gatsby-resp-image-image\"\n        alt=\"mfd\"\n        title=\"\"\n        src=\"/static/099c9cc3831a2a98ff890b8322abd4b4/466da/mfd.png\"\n        srcset=\"/static/099c9cc3831a2a98ff890b8322abd4b4/c26ae/mfd.png 158w,\n/static/099c9cc3831a2a98ff890b8322abd4b4/6bdcf/mfd.png 315w,\n/static/099c9cc3831a2a98ff890b8322abd4b4/466da/mfd.png 475w\"\n        sizes=\"(max-width: 475px) 100vw, 475px\"\n        style=\"width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;\"\n        loading=\"lazy\"\n        decoding=\"async\"\n      />\n  </a>\n    </span></p>\n<p>해당 열은 data frame에서 해당 열의 헤더의 이름, 즉 MFD를 입력하면 읽을 수 있다. 로그를 출력해보면 해당 열만 출력될 것이다.</p>\n<p><span\n      class=\"gatsby-resp-image-wrapper\"\n      style=\"position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 630px; \"\n    >\n      <a\n    class=\"gatsby-resp-image-link\"\n    href=\"/static/24a3c2ffc071ecf1d18ae6f693a22f7b/0f2bc/read-data.png\"\n    style=\"display: block\"\n    target=\"_blank\"\n    rel=\"noopener\"\n  >\n    <span\n    class=\"gatsby-resp-image-background-image\"\n    style=\"padding-bottom: 8.860759493670885%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAACCAYAAABYBvyLAAAACXBIWXMAAAsTAAALEwEAmpwYAAAAdklEQVR42kXJ0RKCIBBA0X7F3QpxCREUwdH6/6+6vTTT45lz6+eHtXfa2TiOzvW+qFuhbzu9NmpKlBhJaWXJjZQys43YZOTSSUvBLLDknfiK3OY5UttOCIZzhp8CznncaIw+8Lg/8c6hKogMiAiiiqr+PPxPhS/DEzzvU0mmowAAAABJRU5ErkJggg=='); background-size: cover; display: block;\"\n  ></span>\n  <img\n        class=\"gatsby-resp-image-image\"\n        alt=\"read-data\"\n        title=\"\"\n        src=\"/static/24a3c2ffc071ecf1d18ae6f693a22f7b/f058b/read-data.png\"\n        srcset=\"/static/24a3c2ffc071ecf1d18ae6f693a22f7b/c26ae/read-data.png 158w,\n/static/24a3c2ffc071ecf1d18ae6f693a22f7b/6bdcf/read-data.png 315w,\n/static/24a3c2ffc071ecf1d18ae6f693a22f7b/f058b/read-data.png 630w,\n/static/24a3c2ffc071ecf1d18ae6f693a22f7b/0f2bc/read-data.png 742w\"\n        sizes=\"(max-width: 630px) 100vw, 630px\"\n        style=\"width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;\"\n        loading=\"lazy\"\n        decoding=\"async\"\n      />\n  </a>\n    </span></p>\n<p>사실 목표값을 찾는 방법은 여럿이 될 수 있다. 열의 값으로 이루어진 배열을 일일이 확인하여 조건에 맞는 값들만 센 후 계산할 수도 있다. 하지만 pandas의 query를 이용하면 단 한 줄의 코드로 원하는 값을 얻을 수 있다. pandas API에 지정된 형태로 정확히 query를 입력하면 된다.</p>\n<p><span\n      class=\"gatsby-resp-image-wrapper\"\n      style=\"position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 590px; \"\n    >\n      <a\n    class=\"gatsby-resp-image-link\"\n    href=\"/static/cb99dd5f0f32c17dde61201d743799a6/fcda8/filter-data.png\"\n    style=\"display: block\"\n    target=\"_blank\"\n    rel=\"noopener\"\n  >\n    <span\n    class=\"gatsby-resp-image-background-image\"\n    style=\"padding-bottom: 27.848101265822784%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAGCAYAAADDl76dAAAACXBIWXMAAAsTAAALEwEAmpwYAAABE0lEQVR42n2QSW7EMAwE/ZSJrZXaLFlexoMk/39VBfYEOebQoFoSwWoOx+uL4/ykLp2UC/uxc74qrQV6y4h31BxZamKZEyULQRxtFqzVTNOE0gql1H0eJDlCcvhg0XrCi7299QYnBmM1xmgkWIxTf3fOG7RRjOPIOE5MlybFMNeFvj7p25Pn+U3MiVQjz7NxHiu9b+zHF307WfcXc90IIbD2Tm0HZU6se2POCWMUg0RPiJ6YhJgFiQ7rNCFZYn7Tv+Xv96tedM5bYvFYZwjRvRNYzdCqkKNHrg/iEGeY60ouy01T2862v4gp8Hg8/iLe9WP89b+xrx2m4pBo8WLu/V2E1/RSI6mEm6K0RGmBSb2b/tMPAoC0CaGhhNQAAAAASUVORK5CYII='); background-size: cover; display: block;\"\n  ></span>\n  <img\n        class=\"gatsby-resp-image-image\"\n        alt=\"filter-data\"\n        title=\"\"\n        src=\"/static/cb99dd5f0f32c17dde61201d743799a6/fcda8/filter-data.png\"\n        srcset=\"/static/cb99dd5f0f32c17dde61201d743799a6/c26ae/filter-data.png 158w,\n/static/cb99dd5f0f32c17dde61201d743799a6/6bdcf/filter-data.png 315w,\n/static/cb99dd5f0f32c17dde61201d743799a6/fcda8/filter-data.png 590w\"\n        sizes=\"(max-width: 590px) 100vw, 590px\"\n        style=\"width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;\"\n        loading=\"lazy\"\n        decoding=\"async\"\n      />\n  </a>\n    </span></p>\n<p>query <strong>`MFD` > 9.0 and `MFD` &#x3C;= 9.4</strong> 를 입력하고 로그를 출력하면 조건에 맞는 값들만 출력될 것이다. MFD 열의 값 전체 개수와 9.0와 9.4사이에 존재하는 값의 개수를 알게 되었고 계산하게 되면 답은 58.17이란 걸 알 수 있다.</p>\n<h2>결론</h2>\n<p>pandas의 아주 작은 일부만 살펴보앗다. pandas가 엑셀 혹은 기타 데이터를 다루는 예는 무궁무진할 것이다. 독자들이 다른 많은 예제들을 접하면서 pandas를 유용하게 사용하셨으면 좋겠다.</p>\n<p><em><strong>읽어 주셔서 감사합니다. To be continued!</strong></em></p>\n<p><em>이 글은 <a href=\"https://medium.com/@shkim04/how-to-use-pandas-for-excel-on-python-45ffb15af57e\">Medium</a>에도 업로드 되었습니다.</em>\r\n<em>놀러 오세요!</em></p>","frontmatter":{"title":"Python에서 pandas로 엑셀 다루기","date":"2023년 01월 30일","description":"","tag":["Python"]},"fields":{"locale":"ko"}},"previous":{"fields":{"slug":"/python-가상환경-설정"},"frontmatter":{"title":"윈도우에 Python 가상 환경 설치하기"}},"next":{"fields":{"slug":"/nodejs-aws-sqs-사용하기"},"frontmatter":{"title":"Node.js 어플리케이션에서 AWS SQS 사용하기"}}},"pageContext":{"locale":"ko","isDefaultLang":true,"slug":"/python-pandas-엑셀-사용하기","titleByLang":{"ko":"python-pandas-엑셀-사용하기","en":"pandas-for-excel-python"},"dateFormat":"YYYY년 MM월 DD일","id":"ec2539c3-e069-5c78-8b26-97037ee075cd","previousPostId":"ddd50cac-257e-5b75-a65f-342b4583f255","nextPostId":"c2d7da30-da2c-5563-8634-e108baa88ade"}},"staticQueryHashes":[],"slicesMap":{}}