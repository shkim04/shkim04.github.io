{"componentChunkName":"component---src-templates-blog-post-js","path":"/python-pandas-엑셀-사용하기/","result":{"data":{"site":{"siteMetadata":{"title":"Seunghyun's Blog"}},"markdownRemark":{"id":"7e2506ed-11d6-5e9d-bc36-084022597c68","excerpt":"Pandas의 공식 웹페이지 따르면 pandas is a fast, powerful, flexible and easy to use open source data analysis and manipulation tool, built on top of the Python programming…","html":"<p>Pandas의 공식 <a href=\"https://pandas.pydata.org/\">웹페이지</a> 따르면</p>\n<blockquote>\n<p>pandas is a fast, powerful, flexible and easy to use open source data analysis and manipulation tool, built on top of the Python programming language.</p>\n</blockquote>\n<p>특히, <strong>pandas</strong>는 엑셀 파일에 저장된 데이터를 분석하고 가공할 때 아주 용이하다. 실제 데이터 모델을 가지고 pandas를 엑셀에 활용하는 방법을 알아보자.</p>\n<h2>필수</h2>\n<ul>\n<li>가상 환경 설치 — <em><a href=\"https://shkim04.github.io/python-%EA%B0%80%EC%83%81%ED%99%98%EA%B2%BD-%EC%84%A4%EC%A0%95\">이전 글</a>에 가상 환경 설치에 대해 글을 적었으니 읽어보길 바란다</em></li>\n</ul>\n<h2>pandas 설치</h2>\n<div class=\"gatsby-highlight\" data-language=\"text\"><pre class=\"language-text\"><code class=\"language-text\">pip install pandas\npip list</code></pre></div>\n<p>설치가 완료가 되면 패키지 목록에 있는지 확인하여 설치가 잘 되었는지 확인해보자. 목록은 다음과 같이 생겼다:</p>\n<p><span\n      class=\"gatsby-resp-image-wrapper\"\n      style=\"position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 313px; \"\n    >\n      <a\n    class=\"gatsby-resp-image-link\"\n    href=\"/static/9af7fa5999d8699318e46d5d73d1002e/80977/pip-list.png\"\n    style=\"display: block\"\n    target=\"_blank\"\n    rel=\"noopener\"\n  >\n    <span\n    class=\"gatsby-resp-image-background-image\"\n    style=\"padding-bottom: 86.70886075949367%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAARCAYAAADdRIy+AAAACXBIWXMAAAsTAAALEwEAmpwYAAACnElEQVR42m1U2XLiQAzkL5KQgC/wQRUsYOMDG3s8vo3ZVO1r/v87ektaIDjsg8rHaFrq6dZMDGOB7XaL9XqNzWaD/c6F67pw93ts1hssFgsYhnGPlbOCY9twnBW2293T+mRpmrgMZ3juHoUs8Xn5g6Ys0bUdPi8XOLYFTdd5o6bpOB6PHFEYoW1qGIY+BjQtC/HxiHM3YDgP2G1/4ePjA5qmQdfHyfTtH3x4roumabDb7uHud5z73eFyiTiO0bU9LsMFURTAth2sVs5Tdeo0CALuUIgMcZwgCHyoqnqnPlkslqibGp+/B7Rth2Ho0bUt0iQZVb4BhmEImReIwhDD+YxCSszn829A0zRRVhWapkbX9Pg9XLBynBHQI2XP8xCGEXzf5251fVx0YlkW2rZBVZYQmYDMJatIi1T1MfQr5TAI+SzDMIBpLn8A2jaaukbfdVAVBS8vL1AUhWnMZjMOeif69F/kOYRIEfg+ovCIYxSOz5AAc5mjqSvuNM9z+P4BpaxRVSXKQkJkKbJThv1ux5ST5MTOINAnHxLluq6RiwxSSkgh2OilrFAWBcqyQpaekMQJA/qBDyEEA4aBD8s0x4A2UW4bFiWOI7y+vrIP397eMJ1Or5QVKKqC2XyONE3x9fWFtq15osiTP3xoQsoCTU2iZGyDJI6RC4EoiK6H/i1KURTI0hRxErPS1PUIkJLzXPJ5tV3H40TUq4qoZrAs8z4x9MyyjOlSUVL54HkMuLgBkrHJLlSVVJ6+v7OaRI+ehj42NgEcvAP6ruU9xIryHiZlwcp2bYP0dGJB9Otl8FNB+v/PBT7OfccCudcORyoTxXPf8yhRB4++GgMad8C+73mmyegjH9IFcDPyzcD/G7tbUK6qaqy+pqlP+X8BAiwPStDIvwoAAAAASUVORK5CYII='); background-size: cover; display: block;\"\n  ></span>\n  <img\n        class=\"gatsby-resp-image-image\"\n        alt=\"pip-list\"\n        title=\"\"\n        src=\"/static/9af7fa5999d8699318e46d5d73d1002e/80977/pip-list.png\"\n        srcset=\"/static/9af7fa5999d8699318e46d5d73d1002e/c26ae/pip-list.png 158w,\n/static/9af7fa5999d8699318e46d5d73d1002e/80977/pip-list.png 313w\"\n        sizes=\"(max-width: 313px) 100vw, 313px\"\n        style=\"width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;\"\n        loading=\"lazy\"\n        decoding=\"async\"\n      />\n  </a>\n    </span></p>\n<p>다른 패키지도 설치된 것을 확인할 수 있는데 이들은 pandas를 설치하면 같이 설치되는 일종의 묶음 패키지이다. 이 패키지들이 없으면 pandas가 정상적으로 동작하지 않을 수 있다.</p>\n<h2>엑셀 데이터 분석</h2>\n<p>실제 데이터 모델과 이 글에 적혀 있는 코드가 개인 <a href=\"https://github.com/shkim04/python_practice\"><strong>레파지토리</strong></a> 있으니 따로 연습할 데이터가 없는 독자들은 다운로드 받아도 된다. 샘플 데이터는 다음과 생겼다:</p>\n<p><span\n      class=\"gatsby-resp-image-wrapper\"\n      style=\"position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 630px; \"\n    >\n      <a\n    class=\"gatsby-resp-image-link\"\n    href=\"/static/074ef4268e7766e1389edefaed597334/c1b63/excel-data.png\"\n    style=\"display: block\"\n    target=\"_blank\"\n    rel=\"noopener\"\n  >\n    <span\n    class=\"gatsby-resp-image-background-image\"\n    style=\"padding-bottom: 36.075949367088604%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAHCAYAAAAIy204AAAACXBIWXMAAAsTAAALEwEAmpwYAAABTElEQVR42lVR2Y6DMBDj/3+sUt9KWwErrgJJgAI5KA0BVl5lpFbaB2tiz8hzJNBaY9s2gnOOYK39ah77vv/jpPnoHLRSUEphmiRWaxGY2eA4frGu7lv8thb7fpCRcxs18NHzj/m6rtR8HEdM0wTGOJZlQcBbjXk50PYak7JQxmGUb5h5g54dpLIQraSc9ppxkHpF/zSY5BtSWyi9Us1zmBF456ZpUFU1yvIBxhiqqiL+0T9gnEOIFpwLygkh6M2FQFGUVBM8HhWKIkee50jTFGVZ4n6/43Q6Effw+fP5jCRJEMcxkp8EURzhEl6QZSmu1yuyPEMYXhD0XU+7+1v4D3q9XuCck6mUEsYYOnoURei6DpxxtG0LxhkNMY4DxWF4UvPAr+jNvEnf9xiGgaYMw5BW8po3ut1uqOuacv4kRZnTxJwzxHGChtVIkhh/pEcLWHklWUUAAAAASUVORK5CYII='); background-size: cover; display: block;\"\n  ></span>\n  <img\n        class=\"gatsby-resp-image-image\"\n        alt=\"excel-data\"\n        title=\"\"\n        src=\"/static/074ef4268e7766e1389edefaed597334/f058b/excel-data.png\"\n        srcset=\"/static/074ef4268e7766e1389edefaed597334/c26ae/excel-data.png 158w,\n/static/074ef4268e7766e1389edefaed597334/6bdcf/excel-data.png 315w,\n/static/074ef4268e7766e1389edefaed597334/f058b/excel-data.png 630w,\n/static/074ef4268e7766e1389edefaed597334/40601/excel-data.png 945w,\n/static/074ef4268e7766e1389edefaed597334/c1b63/excel-data.png 1200w\"\n        sizes=\"(max-width: 630px) 100vw, 630px\"\n        style=\"width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;\"\n        loading=\"lazy\"\n        decoding=\"async\"\n      />\n  </a>\n    </span></p>\n<p>Python 스크립트에 이 엑셀 파일을 읽어보자. 먼저 시작하기 전에 이전 글에서 다룬 가상 환경을 꼭 설치하고 활성화하길 바란다 - <em>Python에 입문한 독자들도 미리 익숙해질 수 있게 설치를 권장한다</em>.</p>\n<p>가상 환경을 활성화시켰다면 <strong>main.py</strong>라는 이름의 파일을 생성한다. pandas를 import하고 아래와 같이 엑셀 파일을 읽는 코드를 입력한다.</p>\n<div class=\"gatsby-highlight\" data-language=\"python\"><pre class=\"language-python\"><code class=\"language-python\"><span class=\"token keyword\">import</span> pandas <span class=\"token keyword\">as</span> pd\n\nexcel_data_df <span class=\"token operator\">=</span> pd<span class=\"token punctuation\">.</span>read_excel<span class=\"token punctuation\">(</span><span class=\"token string\">'sample_data.xlsx'</span><span class=\"token punctuation\">,</span> sheet_name<span class=\"token operator\">=</span><span class=\"token string\">'data1'</span><span class=\"token punctuation\">,</span> skiprows<span class=\"token operator\">=</span><span class=\"token number\">7</span><span class=\"token punctuation\">)</span>\n<span class=\"token keyword\">print</span><span class=\"token punctuation\">(</span>excel_data_df<span class=\"token punctuation\">)</span></code></pre></div>\n<p><strong>read_excel</strong> 메소드는 여러 인자를 받는다. 위의 코드에서는 엑셀 파일의 경로, 시트 이름, 건너 뛸 행의 개수가 되겠다. 더 많은 인자들을 해당 메소드에 입력할 수 있는데 필요에 따라 pandas <a href=\"https://pandas.pydata.org/docs/reference/api/pandas.read_excel.html\">공식 문서</a>에서 확인 바란다. 터미널을 열어 <code class=\"language-text\">python main.py</code>을 입력하여 실행하면 다음과 같이 출력된다:</p>\n<p><span\n      class=\"gatsby-resp-image-wrapper\"\n      style=\"position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 630px; \"\n    >\n      <a\n    class=\"gatsby-resp-image-link\"\n    href=\"/static/c76f1c48da613f1f6f8c9d0d66d6c5f5/38a65/read-log.png\"\n    style=\"display: block\"\n    target=\"_blank\"\n    rel=\"noopener\"\n  >\n    <span\n    class=\"gatsby-resp-image-background-image\"\n    style=\"padding-bottom: 22.151898734177216%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAECAYAAACOXx+WAAAACXBIWXMAAAsTAAALEwEAmpwYAAAAo0lEQVR42jWOaw7DMAiDe5U2qgrkAUnX+x/Nk+n2AwEGzLeNMeDumHPhXgtrrrePmaGiEJHM53lCVWGq2Zta9tVq1tQ3s/dArgtyCdwD+76j946IQG8d/nuqIhh9INzhwxEeGTRvraXpRvf/B2ZSHkdJuufz5OGMSHLS0IA15/e6szarqddasXGJZEkpkmSllPxIOi6xJhnnfEr9JfecUWem1xc26HjyF76VLwAAAABJRU5ErkJggg=='); background-size: cover; display: block;\"\n  ></span>\n  <img\n        class=\"gatsby-resp-image-image\"\n        alt=\"read-log\"\n        title=\"\"\n        src=\"/static/c76f1c48da613f1f6f8c9d0d66d6c5f5/f058b/read-log.png\"\n        srcset=\"/static/c76f1c48da613f1f6f8c9d0d66d6c5f5/c26ae/read-log.png 158w,\n/static/c76f1c48da613f1f6f8c9d0d66d6c5f5/6bdcf/read-log.png 315w,\n/static/c76f1c48da613f1f6f8c9d0d66d6c5f5/f058b/read-log.png 630w,\n/static/c76f1c48da613f1f6f8c9d0d66d6c5f5/40601/read-log.png 945w,\n/static/c76f1c48da613f1f6f8c9d0d66d6c5f5/38a65/read-log.png 1075w\"\n        sizes=\"(max-width: 630px) 100vw, 630px\"\n        style=\"width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;\"\n        loading=\"lazy\"\n        decoding=\"async\"\n      />\n  </a>\n    </span></p>\n<h2>연습</h2>\n<p><strong>MFD</strong> 열에 있는 값들 중 9.0과 9.4 사이에 존재하는 값의 수 대 전체 값의 개수의 비를 계산해보자.</p>\n<p><span\n      class=\"gatsby-resp-image-wrapper\"\n      style=\"position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 475px; \"\n    >\n      <a\n    class=\"gatsby-resp-image-link\"\n    href=\"/static/099c9cc3831a2a98ff890b8322abd4b4/466da/mfd.png\"\n    style=\"display: block\"\n    target=\"_blank\"\n    rel=\"noopener\"\n  >\n    <span\n    class=\"gatsby-resp-image-background-image\"\n    style=\"padding-bottom: 32.911392405063296%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAHCAYAAAAIy204AAAACXBIWXMAAAsTAAALEwEAmpwYAAABdElEQVR42nWPS2+bUBCF+f+rRv0DVZqoz0SVkk3qjWMiuZbtgO3yxlxMzIULGEi6tr+KW6mKKnWks/jOjGbOGKfTidc18GvvXx7qeDz+t28kiUAIged6pGlKkiSaozAkiqK/HMcxvu/rmafVCvFoIWybfLVGRBF+GBD4Aca9OebBNDl/d850+oOJea/17fqa25tbJg8TrdHdHVdfr5jNZpgXl3x5c8bHs7eY7y+Yjsd8H434/OETRlFJ2uaA/WjR98+oqqCsCrZhhNgKzaoukE973I1L1/dke0E+pPYCmrqm73t+vbwQhRGGVDmHumE+m9O2HWUlKZTEd1ziMGY4OHhZmmItLD2zywUyl4RBRNt1dIPaDtdxMVRd6oXL+ZKu66lqhaoVgefrhVWjqBvFfpfhrP8kzItMs+f6tIeDTth3HWt7jZHsYkpZsJgvUGVFmiWILMH96eI5vmatbcLG3lCqEj92yNKdflFKSVmWVEphLy1+A38B+YIrxsMVAAAAAElFTkSuQmCC'); background-size: cover; display: block;\"\n  ></span>\n  <img\n        class=\"gatsby-resp-image-image\"\n        alt=\"mfd\"\n        title=\"\"\n        src=\"/static/099c9cc3831a2a98ff890b8322abd4b4/466da/mfd.png\"\n        srcset=\"/static/099c9cc3831a2a98ff890b8322abd4b4/c26ae/mfd.png 158w,\n/static/099c9cc3831a2a98ff890b8322abd4b4/6bdcf/mfd.png 315w,\n/static/099c9cc3831a2a98ff890b8322abd4b4/466da/mfd.png 475w\"\n        sizes=\"(max-width: 475px) 100vw, 475px\"\n        style=\"width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;\"\n        loading=\"lazy\"\n        decoding=\"async\"\n      />\n  </a>\n    </span></p>\n<p>해당 열은 data frame에서 해당 열의 헤더의 이름, 즉 MFD를 입력하면 읽을 수 있다. 로그를 출력해보면 해당 열만 출력될 것이다.</p>\n<p><span\n      class=\"gatsby-resp-image-wrapper\"\n      style=\"position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 630px; \"\n    >\n      <a\n    class=\"gatsby-resp-image-link\"\n    href=\"/static/24a3c2ffc071ecf1d18ae6f693a22f7b/0f2bc/read-data.png\"\n    style=\"display: block\"\n    target=\"_blank\"\n    rel=\"noopener\"\n  >\n    <span\n    class=\"gatsby-resp-image-background-image\"\n    style=\"padding-bottom: 8.860759493670885%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAACCAYAAABYBvyLAAAACXBIWXMAAAsTAAALEwEAmpwYAAAAdklEQVR42lXJSRaCMBBAQa5CRw0ZIAMS0jzQ+5/qs3Dlsl4Nen7ZVOln5ziU63PRthXddrQpLSfWZSHnN6Xu5FxJYSJ4T62dXFZCiJSyM88LQ0ozrTdC9FjrcS5ircNOgclFno8XzlqMEURGRAQxBmPMz+P4dze/rTziJi709AAAAABJRU5ErkJggg=='); background-size: cover; display: block;\"\n  ></span>\n  <img\n        class=\"gatsby-resp-image-image\"\n        alt=\"read-data\"\n        title=\"\"\n        src=\"/static/24a3c2ffc071ecf1d18ae6f693a22f7b/f058b/read-data.png\"\n        srcset=\"/static/24a3c2ffc071ecf1d18ae6f693a22f7b/c26ae/read-data.png 158w,\n/static/24a3c2ffc071ecf1d18ae6f693a22f7b/6bdcf/read-data.png 315w,\n/static/24a3c2ffc071ecf1d18ae6f693a22f7b/f058b/read-data.png 630w,\n/static/24a3c2ffc071ecf1d18ae6f693a22f7b/0f2bc/read-data.png 742w\"\n        sizes=\"(max-width: 630px) 100vw, 630px\"\n        style=\"width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;\"\n        loading=\"lazy\"\n        decoding=\"async\"\n      />\n  </a>\n    </span></p>\n<p>사실 목표값을 찾는 방법은 여럿이 될 수 있다. 열의 값으로 이루어진 배열을 일일이 확인하여 조건에 맞는 값들만 센 후 계산할 수도 있다. 하지만 pandas의 query를 이용하면 단 한 줄의 코드로 원하는 값을 얻을 수 있다. pandas API에 지정된 형태로 정확히 query를 입력하면 된다.</p>\n<p><span\n      class=\"gatsby-resp-image-wrapper\"\n      style=\"position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 590px; \"\n    >\n      <a\n    class=\"gatsby-resp-image-link\"\n    href=\"/static/cb99dd5f0f32c17dde61201d743799a6/fcda8/filter-data.png\"\n    style=\"display: block\"\n    target=\"_blank\"\n    rel=\"noopener\"\n  >\n    <span\n    class=\"gatsby-resp-image-background-image\"\n    style=\"padding-bottom: 27.848101265822784%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAGCAYAAADDl76dAAAACXBIWXMAAAsTAAALEwEAmpwYAAABCElEQVR42n2QSW7DMBAE9RRDorjv2m3E+f+rKiAVGDnlUBiSDc50z3C+3pzPL8qy4kPkOA+er0KtjrUEjFGU6Fiy76RgcdZQs0XKmWmaEEJ02nmwQeGCxjjJPE8Ye9+VkWgrkWruH61TKC0+b9pIpBSM48g4Tr3ZJARDLgvLdrHuF9fzGx8DIXuuq3IdK+u6sZ/vrm/Hk1w2nHNs60qpJylHtqOSY+gDBusNDR8MPlqs1yg947zCR93dOt/qrbfa3DV8Migtu94SNOdDLZbYmhqFtxqrJbnsxLT0WurBfrzwwfF4PD4Rb8Y/3LGHkEx31XbY9+c12ihS8YTkaHqqgVQdQvzu6h9+AN8zs/erz1JXAAAAAElFTkSuQmCC'); background-size: cover; display: block;\"\n  ></span>\n  <img\n        class=\"gatsby-resp-image-image\"\n        alt=\"filter-data\"\n        title=\"\"\n        src=\"/static/cb99dd5f0f32c17dde61201d743799a6/fcda8/filter-data.png\"\n        srcset=\"/static/cb99dd5f0f32c17dde61201d743799a6/c26ae/filter-data.png 158w,\n/static/cb99dd5f0f32c17dde61201d743799a6/6bdcf/filter-data.png 315w,\n/static/cb99dd5f0f32c17dde61201d743799a6/fcda8/filter-data.png 590w\"\n        sizes=\"(max-width: 590px) 100vw, 590px\"\n        style=\"width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;\"\n        loading=\"lazy\"\n        decoding=\"async\"\n      />\n  </a>\n    </span></p>\n<p>query <strong>`MFD` > 9.0 and `MFD` &#x3C;= 9.4</strong> 를 입력하고 로그를 출력하면 조건에 맞는 값들만 출력될 것이다. MFD 열의 값 전체 개수와 9.0와 9.4사이에 존재하는 값의 개수를 알게 되었고 계산하게 되면 답은 58.17이란 걸 알 수 있다.</p>\n<h2>결론</h2>\n<p>pandas의 아주 작은 일부만 살펴보앗다. pandas가 엑셀 혹은 기타 데이터를 다루는 예는 무궁무진할 것이다. 독자들이 다른 많은 예제들을 접하면서 pandas를 유용하게 사용하셨으면 좋겠다.</p>\n<p><em><strong>읽어 주셔서 감사합니다. To be continued!</strong></em></p>\n<p><em>이 글은 <a href=\"https://medium.com/@shkim04/how-to-use-pandas-for-excel-on-python-45ffb15af57e\">Medium</a>에도 업로드 되었습니다.</em>\n<em>놀러 오세요!</em></p>","frontmatter":{"title":"Python에서 pandas로 엑셀 다루기","date":"2023년 01월 30일","description":"","tag":["Python"]},"fields":{"locale":"ko"}},"previous":{"fields":{"slug":"/python-가상환경-설정"},"frontmatter":{"title":"윈도우에 Python 가상 환경 설치하기"}},"next":{"fields":{"slug":"/nodejs-aws-sqs-사용하기"},"frontmatter":{"title":"Node.js 어플리케이션에서 AWS SQS 사용하기"}}},"pageContext":{"locale":"ko","isDefaultLang":true,"slug":"/python-pandas-엑셀-사용하기","titleByLang":{"ko":"python-pandas-엑셀-사용하기","en":"pandas-for-excel-python"},"dateFormat":"YYYY년 MM월 DD일","id":"7e2506ed-11d6-5e9d-bc36-084022597c68","previousPostId":"945a7103-9290-5475-bc9c-db50bc3a6841","nextPostId":"cf7f4615-3f05-590c-a145-1e742cd08f9f"}},"staticQueryHashes":[],"slicesMap":{}}