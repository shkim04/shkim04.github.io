{"componentChunkName":"component---src-templates-blog-post-js","path":"/nextjs-어플리케이션에-집계-데이터-보여주기/","result":{"data":{"site":{"siteMetadata":{"title":"Seunghyun's Blog"}},"markdownRemark":{"id":"71783b5f-36f1-55ff-9914-8cae61903a9c","excerpt":"백엔드에서 필자가 원하는 수를 집계하는 메소드를 추가했기 때문에 이제 Nextjs 어플리케이션에 이 숫자들을 가져와서 보여줄 차례입니다. 이전 글을 읽지 않고 이 글을 읽으신 분들은 여기에서 백엔드의 전체 코드를 확인하실 수 있습니다. Toilets 라우트 toilets…","html":"<p>백엔드에서 필자가 원하는 수를 집계하는 메소드를 추가했기 때문에 이제 Nextjs 어플리케이션에 이 숫자들을 가져와서 보여줄 차례입니다.</p>\n<blockquote>\n<p>이전 글을 읽지 않고 이 글을 읽으신 분들은 <a href=\"https://github.com/shkim04/find-your-wc\">여기</a>에서 백엔드의 전체 코드를 확인하실 수 있습니다.</p>\n</blockquote>\n<h2>Toilets 라우트</h2>\n<p><strong>toilets</strong> 페이지를 보여주는 컴포넌트에 직접 server action을 사용할 것입니다. 여기 아래와 같이 코드가 있습니다.</p>\n<div class=\"gatsby-highlight\" data-language=\"js\"><pre class=\"language-js\"><code class=\"language-js\"><span class=\"token keyword\">interface</span> <span class=\"token class-name\">ResponseData</span> <span class=\"token punctuation\">{</span>\n  <span class=\"token literal-property property\">aggregate</span><span class=\"token operator\">:</span> AggregateData<span class=\"token punctuation\">;</span>\n<span class=\"token punctuation\">}</span>\n\n<span class=\"token keyword\">interface</span> <span class=\"token class-name\">AggregateData</span> <span class=\"token punctuation\">{</span>\n  <span class=\"token literal-property property\">numOfToilets</span><span class=\"token operator\">:</span> number<span class=\"token punctuation\">;</span>\n  <span class=\"token literal-property property\">numOfReviews</span><span class=\"token operator\">:</span> number<span class=\"token punctuation\">;</span>\n  <span class=\"token literal-property property\">numOfCountries</span><span class=\"token operator\">:</span> number<span class=\"token punctuation\">;</span>\n  <span class=\"token literal-property property\">numOfCities</span><span class=\"token operator\">:</span> number<span class=\"token punctuation\">;</span>\n  <span class=\"token literal-property property\">numOfStreets</span><span class=\"token operator\">:</span> number<span class=\"token punctuation\">;</span>\n<span class=\"token punctuation\">}</span>\n\n<span class=\"token keyword\">async</span> <span class=\"token keyword\">function</span> <span class=\"token function\">getAggregatedData</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n  <span class=\"token keyword\">try</span> <span class=\"token punctuation\">{</span>\n    <span class=\"token keyword\">const</span> response <span class=\"token operator\">=</span> <span class=\"token keyword\">await</span> <span class=\"token function\">fetch</span><span class=\"token punctuation\">(</span><span class=\"token template-string\"><span class=\"token template-punctuation string\">`</span><span class=\"token interpolation\"><span class=\"token interpolation-punctuation punctuation\">${</span>process<span class=\"token punctuation\">.</span>env<span class=\"token punctuation\">.</span><span class=\"token constant\">API_URL</span><span class=\"token interpolation-punctuation punctuation\">}</span></span><span class=\"token string\">/graphql</span><span class=\"token template-punctuation string\">`</span></span><span class=\"token punctuation\">,</span> <span class=\"token punctuation\">{</span>\n      <span class=\"token literal-property property\">method</span><span class=\"token operator\">:</span> <span class=\"token string\">'POST'</span><span class=\"token punctuation\">,</span>\n      <span class=\"token literal-property property\">headers</span><span class=\"token operator\">:</span> <span class=\"token punctuation\">{</span> <span class=\"token string-property property\">'Content-Type'</span><span class=\"token operator\">:</span> <span class=\"token string\">'application/json'</span> <span class=\"token punctuation\">}</span><span class=\"token punctuation\">,</span>\n      <span class=\"token literal-property property\">body</span><span class=\"token operator\">:</span> <span class=\"token constant\">JSON</span><span class=\"token punctuation\">.</span><span class=\"token function\">stringify</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">{</span>\n        <span class=\"token literal-property property\">query</span><span class=\"token operator\">:</span> <span class=\"token template-string\"><span class=\"token template-punctuation string\">`</span><span class=\"token string\">{ aggregate {\n          numOfToilets\n          numOfReviews\n          numOfCountries\n          numOfCities\n          numOfStreets\n        }}</span><span class=\"token template-punctuation string\">`</span></span><span class=\"token punctuation\">,</span>\n      <span class=\"token punctuation\">}</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">,</span>\n    <span class=\"token punctuation\">}</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n    <span class=\"token keyword\">const</span> jsonData <span class=\"token operator\">=</span> <span class=\"token keyword\">await</span> response<span class=\"token punctuation\">.</span><span class=\"token function\">json</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n    <span class=\"token keyword\">return</span> jsonData<span class=\"token punctuation\">.</span>data<span class=\"token punctuation\">;</span>\n  <span class=\"token punctuation\">}</span> <span class=\"token keyword\">catch</span> <span class=\"token punctuation\">(</span>err<span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n    console<span class=\"token punctuation\">.</span><span class=\"token function\">log</span><span class=\"token punctuation\">(</span>err<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n  <span class=\"token punctuation\">}</span>\n<span class=\"token punctuation\">}</span>\n\n<span class=\"token keyword\">export</span> <span class=\"token keyword\">default</span> <span class=\"token keyword\">async</span> <span class=\"token keyword\">function</span> <span class=\"token function\">Toilets</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n  <span class=\"token keyword\">const</span> <span class=\"token literal-property property\">data</span><span class=\"token operator\">:</span> ResponseData <span class=\"token operator\">=</span> <span class=\"token keyword\">await</span> <span class=\"token function\">getAggregatedData</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n  <span class=\"token keyword\">return</span> <span class=\"token punctuation\">(</span>\n    <span class=\"token operator\">&lt;</span>main className<span class=\"token operator\">=</span><span class=\"token string\">'flex min-h-screen flex-col items-center p-24'</span><span class=\"token operator\">></span>\n      <span class=\"token operator\">&lt;</span>div className<span class=\"token operator\">=</span><span class=\"token string\">'z-10 max-w-5xl w-full items-center text-sm lg:flex mb-10'</span><span class=\"token operator\">></span>\n        <span class=\"token operator\">&lt;</span>p className<span class=\"token operator\">=</span><span class=\"token string\">'w-full justify-center border-b border-gray-300 bg-gradient-to-b from-zinc-200 pb-6 pt-8 backdrop-blur-2xl dark:border-neutral-800 dark:bg-zinc-800/30 dark:from-inherit lg:static lg:w-auto  lg:rounded-xl lg:border lg:bg-gray-200 lg:p-4 lg:dark:bg-zinc-800/30'</span><span class=\"token operator\">></span>\n          Contributed aggregation\n        <span class=\"token operator\">&lt;</span><span class=\"token operator\">/</span>p<span class=\"token operator\">></span>\n      <span class=\"token operator\">&lt;</span><span class=\"token operator\">/</span>div<span class=\"token operator\">></span>\n      <span class=\"token operator\">&lt;</span>div className<span class=\"token operator\">=</span><span class=\"token string\">'z-10 max-w-5xl w-full items-center text-sm lg:flex mb-5'</span><span class=\"token operator\">></span>\n        <span class=\"token operator\">&lt;</span>p className<span class=\"token operator\">=</span><span class=\"token string\">'w-full mr-1 justify-center border-b border-gray-300 bg-gradient-to-b from-zinc-200 pb-6 pt-8 backdrop-blur-2xl dark:border-neutral-800 dark:bg-zinc-800/30 dark:from-inherit lg:static lg:w-auto  lg:rounded-xl lg:border lg:bg-gray-200 lg:p-4 lg:dark:bg-zinc-800/30'</span><span class=\"token operator\">></span>\n          <span class=\"token literal-property property\">Toilets</span><span class=\"token operator\">:</span> <span class=\"token punctuation\">{</span>data<span class=\"token punctuation\">.</span>aggregate<span class=\"token punctuation\">.</span>numOfToilets<span class=\"token punctuation\">}</span>\n        <span class=\"token operator\">&lt;</span><span class=\"token operator\">/</span>p<span class=\"token operator\">></span>\n        <span class=\"token operator\">&lt;</span>p className<span class=\"token operator\">=</span><span class=\"token string\">'w-full mr-1 justify-center border-b border-gray-300 bg-gradient-to-b from-zinc-200 pb-6 pt-8 backdrop-blur-2xl dark:border-neutral-800 dark:bg-zinc-800/30 dark:from-inherit lg:static lg:w-auto  lg:rounded-xl lg:border lg:bg-gray-200 lg:p-4 lg:dark:bg-zinc-800/30'</span><span class=\"token operator\">></span>\n          <span class=\"token literal-property property\">Reviews</span><span class=\"token operator\">:</span> <span class=\"token punctuation\">{</span>data<span class=\"token punctuation\">.</span>aggregate<span class=\"token punctuation\">.</span>numOfReviews<span class=\"token punctuation\">}</span>\n        <span class=\"token operator\">&lt;</span><span class=\"token operator\">/</span>p<span class=\"token operator\">></span>\n      <span class=\"token operator\">&lt;</span><span class=\"token operator\">/</span>div<span class=\"token operator\">></span>\n      <span class=\"token operator\">&lt;</span>div className<span class=\"token operator\">=</span><span class=\"token string\">'z-10 max-w-5xl w-full items-center text-sm lg:flex'</span><span class=\"token operator\">></span>\n        <span class=\"token operator\">&lt;</span>p className<span class=\"token operator\">=</span><span class=\"token string\">'w-full mr-1 justify-center border-b border-gray-300 bg-gradient-to-b from-zinc-200 pb-6 pt-8 backdrop-blur-2xl dark:border-neutral-800 dark:bg-zinc-800/30 dark:from-inherit lg:static lg:w-auto  lg:rounded-xl lg:border lg:bg-gray-200 lg:p-4 lg:dark:bg-zinc-800/30'</span><span class=\"token operator\">></span>\n          <span class=\"token literal-property property\">Countries</span><span class=\"token operator\">:</span> <span class=\"token punctuation\">{</span>data<span class=\"token punctuation\">.</span>aggregate<span class=\"token punctuation\">.</span>numOfCountries<span class=\"token punctuation\">}</span>\n        <span class=\"token operator\">&lt;</span><span class=\"token operator\">/</span>p<span class=\"token operator\">></span>\n        <span class=\"token operator\">&lt;</span>p className<span class=\"token operator\">=</span><span class=\"token string\">'w-full mr-1 justify-center border-b border-gray-300 bg-gradient-to-b from-zinc-200 pb-6 pt-8 backdrop-blur-2xl dark:border-neutral-800 dark:bg-zinc-800/30 dark:from-inherit lg:static lg:w-auto  lg:rounded-xl lg:border lg:bg-gray-200 lg:p-4 lg:dark:bg-zinc-800/30'</span><span class=\"token operator\">></span>\n          <span class=\"token literal-property property\">Cities</span><span class=\"token operator\">:</span> <span class=\"token punctuation\">{</span>data<span class=\"token punctuation\">.</span>aggregate<span class=\"token punctuation\">.</span>numOfCities<span class=\"token punctuation\">}</span>\n        <span class=\"token operator\">&lt;</span><span class=\"token operator\">/</span>p<span class=\"token operator\">></span>\n        <span class=\"token operator\">&lt;</span>p className<span class=\"token operator\">=</span><span class=\"token string\">'w-full mr-1 justify-center border-b border-gray-300 bg-gradient-to-b from-zinc-200 pb-6 pt-8 backdrop-blur-2xl dark:border-neutral-800 dark:bg-zinc-800/30 dark:from-inherit lg:static lg:w-auto  lg:rounded-xl lg:border lg:bg-gray-200 lg:p-4 lg:dark:bg-zinc-800/30'</span><span class=\"token operator\">></span>\n          <span class=\"token literal-property property\">Streets</span><span class=\"token operator\">:</span> <span class=\"token punctuation\">{</span>data<span class=\"token punctuation\">.</span>aggregate<span class=\"token punctuation\">.</span>numOfStreets<span class=\"token punctuation\">}</span>\n        <span class=\"token operator\">&lt;</span><span class=\"token operator\">/</span>p<span class=\"token operator\">></span>\n      <span class=\"token operator\">&lt;</span><span class=\"token operator\">/</span>div<span class=\"token operator\">></span>\n    <span class=\"token operator\">&lt;</span><span class=\"token operator\">/</span>main<span class=\"token operator\">></span>\n  <span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n<span class=\"token punctuation\">}</span></code></pre></div>\n<blockquote>\n<p><strong>getAggregatedData</strong> 함수에 쿼리가 만들어질 때 입력 객체가 없다는 것에 주의를 기울일 필요가 있습니다. 이것이 입력 객체가 없을 때 graphql 쿼리를 만드는 방법입니다.</p>\n</blockquote>\n<h2>테스트</h2>\n<p><code class=\"language-text\">http://localhost:3000/toilets</code>를 주소창에 입력하여 기대한 바와 같이 동작이 되는지 확인합니다.</p>\n<p><span\n      class=\"gatsby-resp-image-wrapper\"\n      style=\"position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 630px; \"\n    >\n      <a\n    class=\"gatsby-resp-image-link\"\n    href=\"/static/78762da735955301dfc16a21a0dde8da/5a190/toilets-aggregate.png\"\n    style=\"display: block\"\n    target=\"_blank\"\n    rel=\"noopener\"\n  >\n    <span\n    class=\"gatsby-resp-image-background-image\"\n    style=\"padding-bottom: 78.48101265822784%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAQCAYAAAAWGF8bAAAACXBIWXMAABYlAAAWJQFJUiTwAAAB/ElEQVR42o3T2XKyMBgG4Nz/nf06WjfqBgSysQviwmJn3n8StabUgx48E798C5OAhE7H2O9cLJcr1PUJZVnhem1wu32h72/ouh7n8wVJUuBwqHE8XlCWZ1TVeyR1KZSKIYRCXevNGpfLFW3bmWFa07SoqpMZWJYn1PUVx+PVDD8ez4/1jpyuLbruhrbtUZa1aSzyCpFK0XdfaJre5C/nBlImhusGWK/3YDyCELGhH2QG+iEHZQ9c3LG7gL/4jEPXans/MLyAfXvmyOfexV+t3ScPG9cz68s9R3Y0wNCWUmz9NyjFu3obcYMQQ5RzBEJaFEIpzf67ehsxd/PgMY6AS+z2PlbOGitnA+dzg8XSwXyxwt4LTN5nDHafjXy/CH3xXCAUCjuXmmFLY4v5wsFs7sD1QpP3ufUCB4g+yhCPYog4gUxsKXgU4V29jXAVYYjpOxPKrJo+pomlApe/621ExjGeRBxBxSkcZ4PRaAJKORhXGI2nmEzm2O0ohHrVv0NUkmJIRsmjMTUPECox9L7OR2mGOMug0uxXL4mzHDZdzPSnwgRCJiD1/1zFJtbH1UP1fhBycBEhSn/2k7QoYEuyHI6zxWj8gY/ZCgGT8ANu4s3Wg5AJZrMl/o2mcD2GJP/ZT/JDCVtWHJAV+ndl1lQ35AcT61XHz7yOdb3d/x9BwZgAbFY14AAAAABJRU5ErkJggg=='); background-size: cover; display: block;\"\n  ></span>\n  <img\n        class=\"gatsby-resp-image-image\"\n        alt=\"toilets-aggregate\"\n        title=\"\"\n        src=\"/static/78762da735955301dfc16a21a0dde8da/f058b/toilets-aggregate.png\"\n        srcset=\"/static/78762da735955301dfc16a21a0dde8da/c26ae/toilets-aggregate.png 158w,\n/static/78762da735955301dfc16a21a0dde8da/6bdcf/toilets-aggregate.png 315w,\n/static/78762da735955301dfc16a21a0dde8da/f058b/toilets-aggregate.png 630w,\n/static/78762da735955301dfc16a21a0dde8da/5a190/toilets-aggregate.png 800w\"\n        sizes=\"(max-width: 630px) 100vw, 630px\"\n        style=\"width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;\"\n        loading=\"lazy\"\n        decoding=\"async\"\n      />\n  </a>\n    </span></p>\n<p>필요한 숫자들이 확인이 됐습니다!</p>\n<p><em><strong>읽어 주셔서 감사합니다. To be continued!</strong></em></p>","frontmatter":{"title":"#14 Nestjs 어플리케이션에 집계 데이터 보여주기","date":"2023년 10월 25일","description":"","tag":["Project","React"]},"fields":{"locale":"ko"}},"previous":{"fields":{"slug":"/nestjs-prisma를-이용한-집계-추가하기"},"frontmatter":{"title":"#13 Nestjs Prisma를 이용한 집계 추가하기"}},"next":{"fields":{"slug":"/pnpm으로-dockerfile에서-multi-stage-빌드하기"},"frontmatter":{"title":"#15 pnpm으로 Dockefile에서 multi-stage 빌드하기"}}},"pageContext":{"locale":"ko","isDefaultLang":true,"slug":"/nextjs-어플리케이션에-집계-데이터-보여주기","titleByLang":{"ko":"nextjs-어플리케이션에-집계-데이터-보여주기","en":"display-aggregated-data-in-nextjs"},"dateFormat":"YYYY년 MM월 DD일","id":"71783b5f-36f1-55ff-9914-8cae61903a9c","previousPostId":"a4de116b-915c-58f4-bea7-88d5eb352b44","nextPostId":"447d0f67-6a6a-5703-8010-35d6ab451d2b"}},"staticQueryHashes":[],"slicesMap":{}}